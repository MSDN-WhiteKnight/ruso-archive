<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#1042;&#1086;&#1087;&#1088;&#1086;&#1089; &#1086; &#1089;&#1086;&#1074;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080; &#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082; | RuSO Archive </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#1042;&#1086;&#1087;&#1088;&#1086;&#1089; &#1086; &#1089;&#1086;&#1074;&#1084;&#1077;&#1089;&#1090;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080; &#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082; | RuSO Archive ">
    <meta name="generator" content="docfx 2.40.12.0">
    
    <link rel="shortcut icon" href="../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<p><i><a href="https://github.com/MSDN-WhiteKnight/ruso-archive/">RuSO Archive</a></i></p>
<h1>Вопрос о совместимости библиотек</h1>
<p><a href="https://ru.stackoverflow.com/questions/935440/%d0%92%d0%be%d0%bf%d1%80%d0%be%d1%81-%d0%be-%d1%81%d0%be%d0%b2%d0%bc%d0%b5%d1%81%d1%82%d0%b8%d0%bc%d0%be%d1%81%d1%82%d0%b8-%d0%b1%d0%b8%d0%b1%d0%bb%d0%b8%d0%be%d1%82%d0%b5%d0%ba">Source</a> - by <a href="https://ru.stackoverflow.com/users/283364/pucher">pucher</a></p>
<blockquote>
<p>Нужно написать программу, использующую существующие библиотеки. Есть файлы *.dll, *.lib и *.h соответственно. В документации к библиотеке написано, она была создана с помощью компилятора Visual C++ 2008. Не знаю, имеет ли значение, вроде как библиотека используют в т.ч. MFC.</p>
<p>Вопросы:</p>
<ol>
<li>Что бы эти библиотеки можно было использовать, на компьютере должен быть установлен Redistributable Package Visual C++ 2008? Или можно более новую версию, без старой?</li>
<li>Правильно ли я полагаю, что библиотеки были созданы в visual studio 2008, т.к. в документации указан компилятор Visual C++ 2008?</li>
<li>Для написания программы, использующей данные библиотеки, обязательно ли нужно тогда использовать, соответственно, vs2008? Или можно, скажем студию 2010 или 2017? Нужны ли тогда дополнительные "телодвижения"? Если "инструкция" большая, где об этом почитать?</li>
<li>Как узнать версию компилятора, в которой была создана библиотека, например, не имея документации к ней?</li>
</ol>
<p>Спасибо</p>
</blockquote>
<h2>Answer 935450</h2>
<p><a href="https://ru.stackoverflow.com/a/935450/">Source</a> - by <a href="https://ru.stackoverflow.com/users/287068/freim">freim</a></p>
<blockquote>
<p>Все зависит от того, как библиотека была построена. Если .dll была собрана со статической линковкой и экспортирует функции как <code>extern "C"</code>, то Redistributable Package для нее не требуется, и скорее всего (не проверял, так что неточно) ее можно будет использовать с более новыми версиями студии.</p>
<p>Если библиотека была собрана с динамической линковкой, то использовать ее получится только в VS 2008, и для работы ее потребуется либо установленная VS 2008, либо Redistributable Package, причем именно 2008.</p>
<p>Компиляторы разных студий по объектному формату несовместимы, причем несовместимым может быть даже тот же самый компилятор после апдейта. Сам влетел в такую ситуацию пару месяцев назад после обновления VS 2017. Пришлось перекомпилировать много чего, включая чужие библиотеки, это было непросто. Теперь от апдейтов как от чумы, хотя VS 2017 кривой до изумления.</p>
<blockquote>
  <p>Правильно ли я полагаю, что библиотеки были созданы в visual studio
  2008, т.к. в документации указан компилятор Visual C++ 2008?</p>
</blockquote>
<p>Необязательно в студии, компилятор и прочее можно пускать и из командной строки. Но в целом да, так и есть.</p>
<blockquote>
  <p>Как узнать версию компилятора, в которой была создана библиотека,
  например, не имея документации к ней?</p>
</blockquote>
<p>Версия там есть, потому что компилятор ее проверяет, но где она лежит надо серьезно копать. Проще попробовать собрать с ней что-нибудь и посмотреть что напишет в сообщении об ошибке. Или не напишет.</p>
<p>Как-то так. Точно вам разве что в саппорте MS скажут. В целом быстрее будет разобраться экспериментируя.</p>
</blockquote>
<h2>Answer 935494</h2>
<p><a href="https://ru.stackoverflow.com/a/935494/">Source</a> - by <a href="https://ru.stackoverflow.com/users/321467/mgneo">MGNeo</a></p>
<blockquote>
<p>1) Это зависит от того, имеются ли в библиотеке специфические вызовы и ресурсы. Сказать однозначно, нужен пакет или нет, невозможно. Нужно запустить и посмотреть.</p>
<p>2) Теоретически, библиотеки могут быть собраны в любом окружении, даже на другой операционной системе. Но обычно, если говорят, что проект/библиотека собираются в <code>VS C++ 2008</code>, то так оно и есть.</p>
<p>3) Степень телодвижений для использования библиотеки зависит от того, как именно эта библиотека реализована. Тут нет общего правила. Хорошим тоном считается сокрытие всей библиотечной магии под сишными интерфейсом. Такой подход позволяет выставить наружу простой интерфейс, который может быть использован различными компиляторами и даже другим языковым окружением. Обычно, при использовании сишного интерфейса значение имеет только разрядность используемого вами компилятора - она должна совпадать с разрядностью компилятора, которым библиотека была собрана. </p>
<p>Однако, в мире <code>C++</code> очень часто бывает так, что в интерфейс библиотеки <em>просачиваются</em> тонкости реализации используемого компилятора. В этом случае библиотеку очень тяжело заставить работать, потому что исключения, шаблоны, искажения имен и вот это все - определяется реализацией и может меняться даже при смене настроек компиляции в одном и том же компиляторе.</p>
<p>4) Версия используемого компилятора вам мало чем поможет.</p>
<p>Стандарт C++17 занимает 1700 страниц. Больше половины этого - поведение, определяемое реализацией, то есть - разработчиками компиляторов.</p>
<p>Поэтому, если библиотеку не удается подключить к вашему компилятору, при условии, что компилятор имеет подходящую разрядность, то лучше найти другую библиотеку, которая предоставит классический <code>C</code>-интерфейс.</p>
</blockquote>
<h2>Answer 935525</h2>
<p><a href="https://ru.stackoverflow.com/a/935525/">Source</a> - by <a href="https://ru.stackoverflow.com/users/240512/msdn-whiteknight">MSDN.WhiteKnight</a></p>
<blockquote>
<blockquote>
  <p>Как узнать версию компилятора, в которой была создана библиотека, например, не имея документации к ней?</p>
</blockquote>
<p>Например, выполнить в командной строке Visual Studio команду <code>dumpbin "путь к dll" /imports</code>, найти в ее выводе импорты вида "MSVCR..." или "vcruntime..." и воспользоваться следующей таблицей для определения версии:</p>
<pre class="lang-none prettyprint-override"><code>Visual Studio 2002          MSVCR70.DLL 
Visual Studio 2003          MSVCR71.DLL 
Visual Studio 2005          MSVCR80.DLL 
Visual Studio 2008          MSVCR90.DLL 
Visual Studio 2010          MSVCR100.DLL
Visual Studio 2012          MSVCR110.DLL    
Visual Studio 2013          MSVCR120.DLL    
Visual Studio 2015, 2017    vcruntime140.dll
</code></pre>
<p>Источник: <a href="http://matthew-brett.github.io/pydagogue/python_msvc.html" rel="nofollow noreferrer">http://matthew-brett.github.io/pydagogue/python_msvc.html</a></p>
<p>Вместо командной строки можно использовать и графические утилиты, например, Dependency Walker.</p>
<p>Способ не сработает, если библиотека статически связана с CRT, или не использует CRT вовсе.</p>
</blockquote>
<hr>
<p><i>Content is retrieved from StackExchange API. </i></p>
<p><i>Auto-generated by ruso-archive tools. </i></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>RuSO Archive (published from sources in <a href="https://github.com/MSDN-WhiteKnight/ruso-archive">GitHub repository</a>). Content licensed under <a href="https://github.com/MSDN-WhiteKnight/ruso-archive/blob/master/LICENSE">CC-BY-SA 4.0</a>.<br>Generated by <strong>DocFX</strong></span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
