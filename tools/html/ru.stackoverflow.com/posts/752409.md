---
title: "Как открыть карту сети в windows или построить её самому?"
---
<p><i><a href="https://github.com/MSDN-WhiteKnight/ruso-archive/">RuSO Archive</a></i></p>
<h1>Как открыть карту сети в windows или построить её самому?</h1>
<p><a href="https://ru.stackoverflow.com/questions/752409/%d0%9a%d0%b0%d0%ba-%d0%be%d1%82%d0%ba%d1%80%d1%8b%d1%82%d1%8c-%d0%ba%d0%b0%d1%80%d1%82%d1%83-%d1%81%d0%b5%d1%82%d0%b8-%d0%b2-windows-%d0%b8%d0%bb%d0%b8-%d0%bf%d0%be%d1%81%d1%82%d1%80%d0%be%d0%b8%d1%82%d1%8c-%d0%b5%d1%91-%d1%81%d0%b0%d0%bc%d0%be%d0%bc%d1%83">Source</a> - by <a href="https://ru.stackoverflow.com/users/260772/%d0%9c%d0%b8%d1%88%d0%b0%d0%ba%d0%be%d0%b2-%d0%9c%d0%b0%d0%ba%d1%81%d0%b8%d0%bc">Мишаков Максим</a></p>
<blockquote>
<p>Я нашёл как открыть центр управления сетями и общим доступом: <code>control.exe /name Microsoft.NetworkAndSharingCenter</code>. </p>

<p>Чтобы открыть карту можно нажать "Просмотр полной карты".
<a href="https://i.stack.imgur.com/eaDq4.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/eaDq4.png" alt="введите сюда описание изображения"></a>
Мне надо открыть именно карту сети, можно ли это сделать с помощью С++ или cmd?
Мне в программе необходимо показывать карту сети, как вариант я думал открыть встроенную, но если с этим не выйдет, то где я могу взять в таком случае данных, по которым смогу сам построить карту сети?</p>

</blockquote>
<h2>Answer 752867</h2>
<p><a href="https://ru.stackoverflow.com/a/752867/">Source</a> - by <a href="https://ru.stackoverflow.com/users/240512/msdn-whiteknight">MSDN.WhiteKnight</a></p>
<blockquote>
<blockquote>
  <p>Мне надо открыть именно карту сети, можно ли это сделать с помощью С++ или cmd?</p>
</blockquote>

<p>Для программного вызова карты сети можно использовать вызов explorer.exe с передачей в командной строке пути к элементу панели управления (Shell namespace path):</p>

<pre><code>system("%systemroot%\\explorer.exe \"::{26EE0668-A00A-44D7-9371-BEB064C98683}\\0\\::{E7DE9B1A-7533-4556-9484-B26FB486475E}\"");
</code></pre>

<p>где: </p>

<p><strong>%systemroot%\explorer.exe</strong> - полный путь к explorer (короткий путь не пашет!)<br>
<strong>{26EE0668-A00A-44D7-9371-BEB064C98683}</strong> - CLSID Панели Управления<br>
<strong>{E7DE9B1A-7533-4556-9484-B26FB486475E}</strong> - CLSID Карты сети </p>

<p>По крайней мере, так работает в Windows 7. Если CLSID в других ОС отличается, его можно узнать поиском "NetworkMap" в реестре. Или открыв NetworkMap, выбрав в контекстном меню адресной строки элемент "Копировать адрес", и вставив его сюда же в адресную строку.</p>

<blockquote>
  <p>где я могу взять в таком случае данных, по которым смогу сам построить
  карту сети?</p>
</blockquote>

<p>Для получения списка устройств в текущем сегменте сети используется протокол SSDP. Нужно отправить запрос <strong>M-SEARCH</strong> через UDP на мультикаст-адрес <strong>239.255.255.250:1900</strong>, затем собирать приходящие ответы. Подробнее <a href="https://habrahabr.ru/post/328726/" rel="nofollow noreferrer">здесь</a>.</p>

</blockquote>
<hr/>
<p><i>Content is retrieved from StackExchange API. </i></p>
<p><i>Auto-generated by ruso-archive tools. </i></p>
