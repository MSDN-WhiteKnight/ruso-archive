---
title: "Post 934445"
---
<p><i><a href="https://github.com/MSDN-WhiteKnight/ruso-archive/">RuSO Archive</a></i></p>
<h1>Post 934445</h1>
<h2>Answer 934445</h2>
<p><a href="https://ru.stackoverflow.com/a/934445/">Source</a> - by <a href="https://ru.stackoverflow.com/users/240512/msdn-whiteknight">MSDN.WhiteKnight</a></p>
<blockquote>
<p>Как-то так:</p>

<pre><code>typedef LRESULT (CALLBACK * PWNDPROC ) (HWND, UINT, WPARAM, LPARAM); 
PWNDPROC RichEditOldWndProc = NULL; //указатель на стандартную WNDPROC элемента Rich Edit

LRESULT CALLBACK RichEditNewWndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam) //переопределенный WNDPROC для Rich Edit
{   
    CHARRANGE cr;
    int line;

    switch (message)
    {
    case WM_KEYDOWN:
        switch (wParam){
        case VK_UP:

            //получаем текущую позицию курсора 
            ZeroMemory(&amp;cr,sizeof(cr));
            SendMessage(hWnd, EM_EXGETSEL, 0, (LPARAM)&amp;cr);

            //находим, на какой строке находится курсор
            line = SendMessage(hWnd, EM_EXLINEFROMCHAR, 0, cr.cpMin);

            //если курсор на первой строке, не передаем управление стандартной WNDPROC
            if(line == 0) return 0;
            break;                      
        }
        break;  

        //аналогично для случаев вниз/вправо/влево...

    }

    //передаем управление стандартной WNDPROC...
    return RichEditOldWndProc(hWnd,message,wParam,lParam);
}


void InitRichEdit()
{  
   LoadLibrary(TEXT("Msftedit.dll"));

   HWND hwndEdit= CreateWindowEx(0, MSFTEDIT_CLASS, TEXT(""),
    ES_MULTILINE | WS_VISIBLE | WS_CHILD | WS_BORDER | WS_TABSTOP, 
    x, y, width, height, 
    hWnd, NULL, hInst, NULL);

   //сохраняем указатель на стандартную WNDPROC
   RichEditOldWndProc = (PWNDPROC) GetWindowLongPtr(hwndEdit, GWLP_WNDPROC);

   //переопределяем WNDPROC
   SetWindowLongPtr(hwndEdit, GWLP_WNDPROC, (LONG_PTR)RichEditNewWndProc);
}
</code></pre>

</blockquote>
<hr/>
<p><i>Content is retrieved from StackExchange API. </i></p>
<p><i>Auto-generated by ruso-archive tools. </i></p>
