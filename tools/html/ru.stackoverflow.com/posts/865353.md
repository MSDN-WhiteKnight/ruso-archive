---
title: "Post 865353"
---
<p><i><a href="https://github.com/MSDN-WhiteKnight/ruso-archive/">RuSO Archive</a></i></p>
<h1>Post 865353</h1>
<h2>Answer 865353</h2>
<p><a href="https://ru.stackoverflow.com/a/865353/">Source</a> - by <a href="https://ru.stackoverflow.com/users/240512/msdn-whiteknight">MSDN.WhiteKnight</a></p>
<blockquote>
<p><code>C:\WINDOWS\system32\config\systemprofile</code> - это путь к профилю для пользователя SYSTEM. Если вам нужен профиль другого пользователя, запускайте сервис от его имени, или найдите путь для конкретного пользователя (у SYSTEM для этого достаточно прав). Это можно сделать как-то так:</p>

<ol>
<li><p>Получить токен пользователя через <a href="https://msdn.microsoft.com/a6d880a0-0aed-4bdb-89c9-4f667ecb510e" rel="nofollow noreferrer">LogonUser</a></p></li>
<li><p>Загрузить его профиль через <a href="https://docs.microsoft.com/ru-ru/windows/desktop/api/userenv/nf-userenv-loaduserprofilew" rel="nofollow noreferrer">LoadUserProfile</a></p></li>
<li><p>Получить путь к нужной папке с помощью <a href="https://docs.microsoft.com/ru-ru/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath" rel="nofollow noreferrer">SHGetKnownFolderPath</a>, передав ей полученный токен</p></li>
</ol>

</blockquote>
<hr/>
<p><i>Content is retrieved from StackExchange API. </i></p>
<p><i>Auto-generated by ruso-archive tools. </i></p>
