---
title: "Как выполнить последовательность команд cmd из WindowsForm?"
---
<p><i><a href="https://github.com/MSDN-WhiteKnight/ruso-archive/">RuSO Archive</a></i></p>
<h1>Как выполнить последовательность команд cmd из WindowsForm?</h1>
<p><a href="https://ru.stackoverflow.com/questions/977121/%d0%9a%d0%b0%d0%ba-%d0%b2%d1%8b%d0%bf%d0%be%d0%bb%d0%bd%d0%b8%d1%82%d1%8c-%d0%bf%d0%be%d1%81%d0%bb%d0%b5%d0%b4%d0%be%d0%b2%d0%b0%d1%82%d0%b5%d0%bb%d1%8c%d0%bd%d0%be%d1%81%d1%82%d1%8c-%d0%ba%d0%be%d0%bc%d0%b0%d0%bd%d0%b4-cmd-%d0%b8%d0%b7-windowsform">Source</a> - by <a href="https://ru.stackoverflow.com/users/336698/%d0%98%d0%b2%d0%b0%d0%bd">Иван</a></p>
<blockquote>
<p>Как запустить cmd в скрытом режиме из приложения WindowsForm, и выполнять в ней команды с получением ответа.
Или как запустить консольное приложение с атрибутами из WindowsForm, и выполнять в ней команды с получением ответа.</p>

<p>Пример: Запустилась cmd
выполнилась 1 команда
получил ответ
если в ответе 1 то
выполняем команду 2
и тд…</p>

</blockquote>
<h2>Answer 978850</h2>
<p><a href="https://ru.stackoverflow.com/a/978850/">Source</a> - by <a href="https://ru.stackoverflow.com/users/240512/msdn-whiteknight">MSDN.WhiteKnight</a></p>
<blockquote>
<p>cmd.exe принимает команды через свой стандартный ввод, а результат выдает в стандартный вывод. Соответственно, нужно перенаправить эти потоки при создании процесса:</p>

<pre><code>public partial class Form1 : Form
{
    Process process;

    public Form1()
    {
        InitializeComponent();
        process = new Process();
        process.StartInfo.FileName = "cmd.exe";
        process.StartInfo.UseShellExecute = false;
        process.StartInfo.RedirectStandardOutput = true;
        process.StartInfo.RedirectStandardInput = true;
        process.StartInfo.StandardOutputEncoding = Encoding.GetEncoding(866);            
        process.StartInfo.CreateNoWindow = true;
        process.OutputDataReceived += Process_OutputDataReceived; //подписываемся на событие появления новых данных
        process.Start();            
        process.BeginOutputReadLine(); //начинаем операции асинхронного чтения Output
    }

    private void Process_OutputDataReceived(object sender, DataReceivedEventArgs e)
    {            
        //при получении данных из Output, выведем в TextBox 
        Invoke(new Action(() =&gt; { textBox1.Text += e.Data + Environment.NewLine; }));            
    }

    void SendCommand(string cmd)
    {
        process.StandardInput.WriteLine(cmd);
        process.StandardInput.Flush();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        SendCommand("program.exe arg1 arg2");
    }

    private void Form1_FormClosed(object sender, FormClosedEventArgs e)
    {
        process.StandardInput.WriteLine("exit");
        process.StandardInput.Flush();
        process.Close();
    }
}  
</code></pre>

</blockquote>
<hr/>
<p><i>Content is retrieved from StackExchange API. </i></p>
<p><i>Auto-generated by ruso-archive tools. </i></p>
