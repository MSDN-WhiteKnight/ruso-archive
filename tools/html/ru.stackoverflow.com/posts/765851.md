---
title: "Post 765851"
---
<p><i><a href="https://github.com/MSDN-WhiteKnight/ruso-archive/">RuSO Archive</a></i></p>
<h1>Post 765851</h1>
<h2>Answer 765851</h2>
<p><a href="https://ru.stackoverflow.com/a/765851/">Source</a> - by <a href="https://ru.stackoverflow.com/users/240512/msdn-whiteknight">MSDN.WhiteKnight</a></p>
<blockquote>
<p>Можно использовать функцию <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/bb762179%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396" rel="nofollow noreferrer">SHGetFileInfo</a> с параметром SHGFI_EXETYPE:</p>

<pre><code>public const uint SHGFI_EXETYPE = 0x000002000;

[DllImport("shell32.dll", CharSet = CharSet.Auto)]
public static extern int SHGetFileInfo(string pszPath, uint dwFileAttributes, IntPtr psfi, 
        uint cbFileInfo, uint uFlags);

public static void PrintExeType(string file)
{            
        int res = SHGetFileInfo(file, 0, IntPtr.Zero, 0, SHGFI_EXETYPE);

        int lowWord = res &amp; 0xffff;
        int hiWord = res &gt;&gt; 16;

        if (res != 0)
        {
            if (hiWord == 0x0000 &amp;&amp; lowWord == 0x5a4d /*MZ*/) 
            {
                MessageBox.Show("DOS application");
            }
            else if (hiWord == 0x0000 &amp;&amp; lowWord == 0x4550 /*PE*/)
            {
                MessageBox.Show("Console application");
            }
            else if ((hiWord != 0x0000) &amp;&amp; (lowWord == 0x454E/*NE*/ || lowWord == 0x4550 /*PE*/))
            {
                MessageBox.Show("GUI application");
            }
            else MessageBox.Show("Unknown");
        }
        else MessageBox.Show("Not executable");            
}
</code></pre>

</blockquote>
<hr/>
<p><i>Content is retrieved from StackExchange API. </i></p>
<p><i>Auto-generated by ruso-archive tools. </i></p>
