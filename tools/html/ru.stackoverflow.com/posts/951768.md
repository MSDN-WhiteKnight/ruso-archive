---
title: "Решение дилеммы с множественными копиями EXCEL в фоне"
---
<p><i><a href="https://github.com/MSDN-WhiteKnight/ruso-archive/">RuSO Archive</a></i></p>
<h1>Решение дилеммы с множественными копиями EXCEL в фоне</h1>
<p><a href="https://ru.stackoverflow.com/questions/951768/%d0%a0%d0%b5%d1%88%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b4%d0%b8%d0%bb%d0%b5%d0%bc%d0%bc%d1%8b-%d1%81-%d0%bc%d0%bd%d0%be%d0%b6%d0%b5%d1%81%d1%82%d0%b2%d0%b5%d0%bd%d0%bd%d1%8b%d0%bc%d0%b8-%d0%ba%d0%be%d0%bf%d0%b8%d1%8f%d0%bc%d0%b8-excel-%d0%b2-%d1%84%d0%be%d0%bd%d0%b5">Source</a> - by <a href="https://ru.stackoverflow.com/users/327692/corvered">corvered</a></p>
<blockquote>
<p>Суть проблемы в том что в приложение нужно добавить функцию поиска информации в документе, ориентируясь на имя файла. С этим проблем нет. Но вот в чём незадача: при запуске каждой копии приложения и попытке найти информацию в документе, в фоне будет запускаться новая копия приложения EXCEL с нужным документом. Документ очень большой и если запускать каждый раз новый EXCEL для каждой новой копии моего приложения, то они будут нехило отжирать память, да и сам EXCEL запускается с заметной задержкой. Что бы избежать кучи EXCEL в фоне, можно его закрывать после каждого обращения, но это будет ещё более неудобно, так как если работать в 1 копии программы, то будет каждый раз сильная задержка. Есть ли какой-то элегантный способ что бы заставить работать только с 1 копией EXCEL всем запущенным программам? Единственный вариант, который я вижу - это отдельное приложение-сервер, которое само откроет один раз документ и будет принимать запросы от клиентов и показывать информацию из таблицы. Ну или оставить как есть и объяснить пользователям, что бы не злоупотребляли?</p>

</blockquote>
<h2>Answer 951936</h2>
<p><a href="https://ru.stackoverflow.com/a/951936/">Source</a> - by <a href="https://ru.stackoverflow.com/users/240512/msdn-whiteknight">MSDN.WhiteKnight</a></p>
<blockquote>
<p>Пользователям ничего объяснять не надо, современные версии Excel при открытии документов через свой интерфейс или в проводнике и так открывают их все в одном процессе, если им особым образом не указать делать по другому. Что касается программного открытия, конечно, несколько экземпляров программы также могут работать с одним экземпляром Excel. Это делается примерно так:</p>

<pre><code>using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;

//...

public static Excel.Application GetExcelInstance()
{ 
    Excel.Application app=null;           

    try
    {
        app = (Excel.Application)Marshal.GetActiveObject("Excel.Application");
    }
    catch (COMException) { app = null; }

    if(app == null) app = new Excel.Application();
    return app;
}
</code></pre>

</blockquote>
<hr/>
<p><i>Content is retrieved from StackExchange API. </i></p>
<p><i>Auto-generated by ruso-archive tools. </i></p>
