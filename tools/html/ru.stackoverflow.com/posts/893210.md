---
title: "Post 893210"
---
<p><i><a href="https://github.com/MSDN-WhiteKnight/ruso-archive/">RuSO Archive</a></i></p>
<h1>Post 893210</h1>
<h2>Answer 893210</h2>
<p><a href="https://ru.stackoverflow.com/a/893210/">Source</a> - by <a href="https://ru.stackoverflow.com/users/240512/msdn-whiteknight">MSDN.WhiteKnight</a></p>
<blockquote>
<p>Как-то так:</p>

<pre><code>string[] countrys = new string[] { "США", "ОАЭ", "ЮАР" };            
var oldcol = dataGridView1.Columns[1];
var newcol = new DataGridViewComboBoxColumn();
newcol.HeaderText = oldcol.HeaderText;
newcol.Name = oldcol.Name;
newcol.DataSource = countrys;
newcol.DataPropertyName = oldcol.DataPropertyName;  
dataGridView1.Columns.RemoveAt(1);
dataGridView1.Columns.Insert(1,newcol);
</code></pre>

<p>Недостаток: если значение в таблице отсутствует в списке для ComboBox, при каждом нажатии на DataGridView валится ошибка (необходимо обработать событие DataError).</p>

<hr>

<p>Чтобы ComboBox раскрывался по первому клику, добавьте такой обработчик для события CellClick в DataGridView:</p>

<pre><code>private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
{
    DataGridViewCell cell = dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex];
    if (cell is DataGridViewComboBoxCell)
    {                
        dataGridView1.BeginEdit(false);
        (dataGridView1.EditingControl as DataGridViewComboBoxEditingControl).DroppedDown = true;                
    }
}
</code></pre>

</blockquote>
<hr/>
<p><i>Content is retrieved from StackExchange API. </i></p>
<p><i>Auto-generated by ruso-archive tools. </i></p>
