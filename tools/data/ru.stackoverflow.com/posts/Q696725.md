---
title: "Получение полного имени устройства аудиозахвата"
se.owner.user_id: 238013
se.owner.display_name: "D .Stark"
se.owner.link: "https://ru.stackoverflow.com/users/238013/d-stark"
se.link: "https://ru.stackoverflow.com/questions/696725/%d0%9f%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d0%bb%d0%bd%d0%be%d0%b3%d0%be-%d0%b8%d0%bc%d0%b5%d0%bd%d0%b8-%d1%83%d1%81%d1%82%d1%80%d0%be%d0%b9%d1%81%d1%82%d0%b2%d0%b0-%d0%b0%d1%83%d0%b4%d0%b8%d0%be%d0%b7%d0%b0%d1%85%d0%b2%d0%b0%d1%82%d0%b0"
se.question_id: 696725
se.post_type: question
se.score: 3
---
<pre><code>ICreateDevEnum devEnum;
IEnumMoniker enumMoniker;
IMoniker[] monikers = new IMoniker[1];
IPropertyBag propBag;

devEnum = (ICreateDevEnum)Activator.CreateInstance(Type.GetTypeFromCLSID(CLSID_SystemDeviceEnum));
devEnum.CreateClassEnumerator(CLSID_AudioInputDeviceCategory, out enumMoniker, 0);

while (enumMoniker.Next(1, monikers, IntPtr.Zero) == 0) {

    object variant;
    object propBagObj;

    monikers[0].BindToStorage(null, null, ref IPropertyBagGuid, out propBagObj);
    propBag = (IPropertyBag)propBagObj;

    if (propBag.Read("FriendlyName", out variant, null) == 0)
        System.Windows.MessageBox.Show(variant.ToString() + " (" + variant.ToString().Length + ")");
}
</code></pre>

<p>Под Windows 10 этот код у меня работает прекрасно и выводит полное имя микрофона (44 символа). На Windows 7 имя выводится не полное, а лишь первые 31 символ.</p>

<p>Подскажите, что может быть причиной такого поведения и как это починить (возможно, аналогичный более универсальный код)?</p>

<p>На устройствах, сразу скажу, стоят разные версии DirectX (12 (где всё работает) и 11).</p>
