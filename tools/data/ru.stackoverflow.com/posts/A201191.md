---
title: "Answer 201191"
se.owner.user_id: 2283
se.owner.display_name: "renegator"
se.owner.link: "https://ru.stackoverflow.com/users/2283/renegator"
se.answer_id: 201191
se.question_id: 98589
se.post_type: answer
se.score: 2
se.is_accepted: False
---
<p>Пример в MSDN замечательно работает. Например так:</p>
<ol>
<li>
<p>Этот код (которого в MSDN нет) - вынесем в загрузку формы</p>
<pre><code>private void Form1_Load(object sender, EventArgs e)
{
    FileStream fs = new FileStream(@"D:\index.html", FileMode.OpenOrCreate);
    webBrowser1.DocumentStream = file;
}
</code></pre>
</li>
<li>
<p>А этот - ну например в обработчик клика</p>
<pre><code> private void button1_Click(object sender, EventArgs e)
 {
     tmlDocument doc = webBrowser1.Document;
     HtmlElement elem = doc.CreateElement("TABLE");
     doc.Body.AppendChild(elem);
 }
</code></pre>
</li>
</ol>
<p>Проблема в том, что доступ к коду документа появляется только после возникновения события DocumentCompleted</p>