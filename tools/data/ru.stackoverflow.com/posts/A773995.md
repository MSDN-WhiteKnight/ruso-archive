---
title: "Answer 773995"
se.owner.user_id: 193306
se.owner.display_name: "Sergej Loos"
se.owner.link: "https://ru.stackoverflow.com/users/193306/sergej-loos"
se.answer_id: 773995
se.question_id: 772547
se.post_type: answer
se.score: 0
se.is_accepted: False
---
<p>Для решения своей проблемы я исползовал JavaScript, указанный в вопросе:</p>

<pre><code>documentHtml = webBrowser.DomDocumentText; 

// extract frames content (by frame id)
var framesAsHtmlElements = webBrowser.Document.GetElementsByTagName("iframe"); 
foreach(HtmlElement frame in framesAsHtmlElements) {
    String id = frame.Id;
    if (String.IsNullOrEmpty(id) == false) {
        string jCode = "var iframe = document.getElementById('" + id + "'); var innerDoc = iframe.contentDocument || iframe.contentWindow.document; innerDoc.documentElement.innerHTML";
        String frameHtml = webBrowser.WebBrowser.Document.InvokeScript("eval", new object[] { jCode }) as String;

        if (String.IsNullOrEmpty(frameHtml) == false) {

            // ((?im)&lt;iframe(([.]|[^/]|\r\n|\r|\n)*?id=["']frame-id["'](.|\r\n|\r|\n)*?)(/&gt;|&lt;/iframe&gt;)+?)
            Regex regEx = new Regex(String.Format(@"(&lt;iframe(([.]|[^/]|\r\n|\r|\n)*?id=[""']{0}[""'](.|\r\n|\r|\n)*?)(/&gt;|&lt;/iframe&gt;)+?)", id), RegexOptions.Multiline | RegexOptions.IgnoreCase );
            Match match = regEx.Match(documentHtml);
            if (match.Success) {
                int pos = match.Index;
                int length = match.Length;

                documentHtml = documentHtml.Substring(0, pos) // before &lt;iframe&gt;
                    + "&lt;iframe" + match.Groups[2].Value + "/&gt;"
                    + frameHtml
                    + "&lt;/iframe&gt;"
                    + documentHtml.Substring(pos + length); 
                    ;
            }
        }
    }
}
</code></pre>
