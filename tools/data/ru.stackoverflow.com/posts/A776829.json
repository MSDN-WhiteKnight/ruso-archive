{"owner":{"reputation":44636,"user_id":177221,"user_type":"registered","accept_rate":100,"profile_image":"https://www.gravatar.com/avatar/70a98bcf7c2d5c791b33f0a86796f619?s=128&d=identicon&r=PG","display_name":"PashaPash","link":"https://ru.stackoverflow.com/users/177221/pashapash"},"is_accepted":false,"score":4,"last_activity_date":1517154009,"creation_date":1517154009,"answer_id":776829,"question_id":776708,"body":"<p>Для создания кастомного UI через WIX можно использовать <a href=\"http://wixtoolset.org/documentation/manual/v3/bundle/authoring_bundle_application.html\" rel=\"nofollow noreferrer\">Burn / BootstrapperApplication</a> - стандартный способ для создания оберток поверх MSI.</p>\n\n<p>Пример для WPF есть в <a href=\"https://github.com/wixtoolset/wix3/releases/tag/wix3111rtm\" rel=\"nofollow noreferrer\">src-пакете WiX</a>, в папке <code>src\\Setup\\WixBA</code>. Прикручивается (судя по документации) примерно так:</p>\n\n<ol>\n<li>Собирается DLL с UI (WixBA из примеров)</li>\n<li><p>В bundle.wxs (есть в стандартном шаблоне WiX для VS) добавляется</p>\n\n<pre><code>&lt;BootstrapperApplicationRef Id=\"ManagedBootstrapperApplicationHost\" &gt;\n  &lt;Payload SourceFile=\"$(var.InstallSourceResources)Bootstrapper\\WixBA.dll\"/&gt;\n  &lt;Payload Id=\"FusionInstallUX.config\"\n       SourceFile=\"$(var.InstallSourceResources)Bootstrapper\\WixBA.BootstrapperCore.config\"\n       Name=\"BootstrapperCore.config\" Compressed=\"yes\"/&gt;\n&lt;/BootstrapperApplicationRef&gt;\n</code></pre></li>\n</ol>\n\n<p>Сам по себе кастомный UI - это <a href=\"https://github.com/wixtoolset/wix3/blob/develop/src/Setup/WixBA/WixBA.cs\" rel=\"nofollow noreferrer\">просто класс-наследник <code>BootstrapperApplication</code> </a> в сборке, отмеченной атрибутом <code>BootstrapperApplicationAttribute</code>.</p>\n\n<p>Пример конфига:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n    &lt;configSections&gt;\n        &lt;sectionGroup\n            name=\"wix.bootstrapper\"\n            type=\"Microsoft.Tools.WindowsInstallerXml.Bootstrapper.BootstrapperSectionGroup, BootstrapperCore\"&gt;\n\n            &lt;section\n                name=\"host\"\n                type=\"Microsoft.Tools.WindowsInstallerXml.Bootstrapper.HostSection, BootstrapperCore\" /&gt;\n        &lt;/sectionGroup&gt;\n    &lt;/configSections&gt;\n\n    &lt;startup useLegacyV2RuntimeActivationPolicy=\"true\"&gt;\n        &lt;supportedRuntime version=\"v4.0\" /&gt;\n    &lt;/startup&gt;\n\n    &lt;wix.bootstrapper&gt;\n        &lt;host assemblyName=\"FusionInstallUX\"&gt;\n            &lt;supportedFramework version=\"v4\\Full\" /&gt;\n            &lt;supportedFramework version=\"v4\\Client\" /&gt;\n        &lt;/host&gt;\n    &lt;/wix.bootstrapper&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>Более подробные примеры:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/7840380/custom-wix-burn-bootstrapper-user-interface\">Custom WiX Burn bootstrapper user interface?\n</a></li>\n<li><a href=\"https://frozencloud.wordpress.com/2016/05/03/creating-a-custom-ui-installer-with-wix-burn-bootstrapper/\" rel=\"nofollow noreferrer\">Creating a custom UI installer with WIX Burn Bootstrapper</a></li>\n<li><a href=\"http://wixtoolset.org/documentation/manual/v3/bundle/authoring_bundle_application.html\" rel=\"nofollow noreferrer\">Author Bootstrapper Application for a Bundle</a></li>\n</ul>\n\n<hr>\n\n<p>Альтернативный вариант без burn / .NET, который (в теории) можно прикрутить к любому msi-инсталлятору - прописывание EmbeddedUI DLL в таблице MsiEmbeddedUI. Базовый пример и требования к dll расписаны в <a href=\"https://msdn.microsoft.com/en-us/library/cc542588(VS.85).aspx\" rel=\"nofollow noreferrer\">MSDN, Using an Embedded UI</a>.</p>\n"}