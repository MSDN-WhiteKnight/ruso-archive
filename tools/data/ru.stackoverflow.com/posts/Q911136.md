---
title: "Почему вызов метода у Com объекта бросает исключение"
se.owner.user_id: 206435
se.owner.display_name: "ヒミコ"
se.owner.link: "https://ru.stackoverflow.com/users/206435/%e3%83%92%e3%83%9f%e3%82%b3"
se.link: "https://ru.stackoverflow.com/questions/911136/%d0%9f%d0%be%d1%87%d0%b5%d0%bc%d1%83-%d0%b2%d1%8b%d0%b7%d0%be%d0%b2-%d0%bc%d0%b5%d1%82%d0%be%d0%b4%d0%b0-%d1%83-com-%d0%be%d0%b1%d1%8a%d0%b5%d0%ba%d1%82%d0%b0-%d0%b1%d1%80%d0%be%d1%81%d0%b0%d0%b5%d1%82-%d0%b8%d1%81%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5"
se.question_id: 911136
se.post_type: question
se.score: 3
---
<p>Как известно, что бы узнать кол-во доступных видео адаптеров через интерфейс <code>DXGI</code>, необходимо вызывать метод <code>EnumAdapters</code> до тех пор, пока данный метод не вернет значение <code>DXGI_ERROR_NOT_FOUND</code>. </p>

<p>Казалось бы, будет перечислять через цикл <code>while</code>:</p>

<pre><code>    static void Main(string[] args)
    {
        int result = Manager.CreateDxgiFactory(out IDXGIFactory factory);

        if (result != 0)
        {
            Exception erForHr = Marshal.GetExceptionForHR(result);
            throw erForHr;
        }

        uint count = 0;
        while (factory.EnumAdapters(count, out _) == 0)
        {
            count++;
        }
        ...
    }
</code></pre>

<p>Но не тут то было! Как только значение <code>count</code> станет больше чем доступно адаптеров, получаем исключение...</p>

<blockquote>
  <p>Объект не найден. При вызове IDXGIFactory::EnumAdaptes отсутствует
  адаптер с указанным порядковым номером. (Исключение из HRESULT:
  0x887A0002)</p>
</blockquote>

<p>Почему, и как платформа <code>.NET</code> обнаруживает то что произошло исключение, если в коде самостоятельно нигде не бросается исключение?</p>

<p>Как отключить данный функционал, т.к. надо перечислять пока есть доступные адаптеры?</p>

<p>Или необходимо оборачивать код в <code>try/catch</code> и в блоке <code>catch</code> выходить из цикла?</p>
