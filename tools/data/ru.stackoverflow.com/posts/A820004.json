{"owner":{"reputation":461,"user_id":294528,"user_type":"registered","profile_image":"https://i.stack.imgur.com/a1bOf.png?s=128&g=1","display_name":"Denys Save","link":"https://ru.stackoverflow.com/users/294528/denys-save"},"is_accepted":false,"score":0,"last_activity_date":1524801229,"creation_date":1524801229,"answer_id":820004,"question_id":818605,"body":"<p>Во-первых, в строке <code>for (int j = 0; i &lt; colCount; j++) {</code><br>\ni заменить на j, иначе внутренний цикл никогда не закончится.</p>\n\n<p>Во-вторых, проверить на согласованность ANSI / UNICODE. Я вижу Вы за LVM_GETITEMTEXT закрепили код LVM_GETITEMTEXTW (LVM_FIRST+0x115), т.е. UNICODE-вариант строки должен приходить. Для этого надо вызывать SendMessageW(), а не SendMessageA(). Проверьте, во что у Вас преобразуется SendMessage(): в SendMessageW() или в SendMessageA(). Я никогда не пробовал ANSI-функцией требовать UNICODE-строку и наоборот и не знаю,будет выполнено корректное преобразование или возвращена ошибка. Может с этим связана проблема.</p>\n"}