{"owner":{"reputation":64807,"user_id":182825,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG","display_name":"AnT","link":"https://ru.stackoverflow.com/users/182825/ant"},"is_accepted":true,"score":2,"last_activity_date":1515947469,"last_edit_date":1515947469,"creation_date":1515947094,"answer_id":770679,"question_id":770669,"body":"<p>Ну, вообще-то, <code>SetWindowLong</code> возвращает старое значение или <code>0</code> в случае ошибки. Однако если старое значение само по себе было <code>0</code> (что всегда имеет место при первом вызове с <code>GWL_USERDATA</code>), то будет возвращен, разумеется, именно <code>0</code> и это совсем не будет означать, что произошла ошибка.</p>\n\n<p>Другими словами, в случае <code>GWL_USERDATA</code> по возвращенному значению <code>0</code> еще невозможно утверждать, что что-то не в порядке. Если вы подозреваете, что произошла ошибка - проверяйте <code>GetLastError</code>. (Однако я нигде не вижу гарантии, что <code>SetWindowLong</code> ставит last error в <code>0</code> в случае успеха, поэтому для надежности в таком случае имеет смысл предварительно сделать <code>SetLastError(0)</code> самому.)</p>\n\n<p>Можете также для надежности сделать <code>GetWindowLong</code>, чтобы убедиться, что значение успешно записалось.</p>\n"}