---
title: "Класс type_info"
se.owner.user_id: 212367
se.owner.display_name: "Kto  To"
se.owner.link: "https://ru.stackoverflow.com/users/212367/kto-to"
se.link: "https://ru.stackoverflow.com/questions/1003049/%d0%9a%d0%bb%d0%b0%d1%81%d1%81-type-info"
se.question_id: 1003049
se.post_type: question
se.score: 1
---
<p>Записать в файл имя функции, версию и параметр. Если с того момента исходный код функции изменился, вернуть сообщение что "версия функций не совпадают".</p>

<p>Например есть 100 функций. Для проверки имен и версии я думаю воспользоваться классом <code>typeid</code> (в первый раз). Поэтому из функций делаю классы.
Пример как я думаю реализовать:</p>

<pre><code>class Base { void f(int seed) = 0; }
class C1   : public Base { void f(int seed) override; }
class C2   : public Base { void f(int seed) override; }
// ...
class C100 : public Base { void f(int seed) override; }

void saveToFile(Base *b, int seed) {
    // псевдокод. Открываю и записываю в файл
    auto t = typeid(*b);
    Fout &lt;&lt; t.name()      // имя функции
         &lt;&lt; t.hash_code() // версия функции
         &lt;&lt; seed;         // параметр функции
}

void readFromFile(Base *b, int seed) {
    // тут не знаю еще как делать.
}
</code></pre>

<p>Вопросы:</p>

<ol>
<li>Можно ли использовать <code>typeid()</code> для сохранения и сравнения типов классов?</li>
<li>Будет ли корректно работать, если я буду сохранять/открывать в разных версиях компиляторов С++?</li>
<li>Как красиво реализовать <code>readFromFile</code>?</li>
<li>Советы, предложения, замечания?</li>
</ol>

<p><strong>UDP: ответ - нельзя использовать <code>typeid()</code>.</strong> А как лучше сделать, что бы особо не запариваться. Что бы автоматически посчитать хеш функции/класса и сравнить имеются ли изменения. И желательно (но не обязательно) мультиплатформенность/на разных компиляторах</p>
