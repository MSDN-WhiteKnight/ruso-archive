---
title: "Удаленная проверка установленных обновлений Windows"
se.owner.user_id: 207176
se.owner.display_name: "Oleg  Bezverhii"
se.owner.link: "https://ru.stackoverflow.com/users/207176/oleg-bezverhii"
se.link: "https://ru.stackoverflow.com/questions/969166/%d0%a3%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%bd%d0%b0%d1%8f-%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%bd%d1%8b%d1%85-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9-windows"
se.question_id: 969166
se.post_type: question
se.score: 1
---
<p>Появилась интересная задача на работе. Имеются сервера КИПиА, которые иногда могут сбоить и так далее. После сбоя проводят развертывание образа и часто бывает, что в данном образе не хватает нужных обновлений. Служба безопасности приезжает на проверки и через "Панель управления->Программы и компоненты->Установленные обновления" и сверяет со списком.</p>

<p><a href="https://i.stack.imgur.com/ET7rp.jpg" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/ET7rp.jpg" alt="введите сюда описание изображения"></a>
Поэтому встала задача о написании приложении, которое по локальной сети бы собирала информацию с серверов о установленных обновлений, в случае отсутствия его в списках выдавала, что такого-то обновления нет. </p>

<p>Сервера находятся в своей подсети, доступ в интернет ограничен, Active Directory не настроен, WSUS не стоит.</p>

<p>Поэтому пару вопросов.</p>

<p>1) Может уже есть готовые аналоги, проверяющие всё это дело?</p>

<p>2) Получение списка обновлений через команду</p>

<pre><code>wmic qfe get
</code></pre>

<p>выдает не все обновления. 
Использовал WMI запросы (Win32_QuickFixEngineering: <a href="https://github.com/OlegBezverhii/UpdatesList/blob/master/ConsoleUpdate/Program.cs" rel="nofollow noreferrer">пример на гитхабе</a>) - выдает тоже самое, что и wmic.</p>

<p>Получается, что можно получить весь список только через WUAPI или есть ещё какие-то способы?</p>
