{"tags":["c#","wpf",".net","oledb"],"owner":{"user_type":"does_not_exist","display_name":"user307204"},"is_answered":false,"view_count":37,"answer_count":1,"score":1,"last_activity_date":1535096972,"creation_date":1535057029,"last_edit_date":1535096972,"question_id":872730,"link":"https://ru.stackoverflow.com/questions/872730/%d0%9d%d0%b5-%d0%be%d1%82%d0%ba%d1%80%d1%8b%d0%b2%d0%b0%d0%b5%d1%82%d1%81%d1%8f-xlsx-%d0%b2-datagrid","title":"Не открывается .xlsx в datagrid","body":"<p>Возникла проблема с WPF: в приложении у меня при нажатии кнопки должен открыться файл с расширением .xlsx и его содержимое перенестись в DataGrid, что не происходит, всё так  пустым и остаётся.</p>\n\n<pre><code>    private void btnOpen_Click(object sender, RoutedEventArgs e)\n    {\n        try\n        {\n            OpenFileDialog openFileDialog1 = new OpenFileDialog();\n            openFileDialog1.Filter = \"XML Files (*.xml; *.xls; *.xlsx; *.xlsm; *.xlsb) |*.xml; *.xls; *.xlsx; *.xlsm; *.xlsb\";\n            openFileDialog1.FilterIndex = 3;\n\n            openFileDialog1.Multiselect = false;\n            openFileDialog1.InitialDirectory = @\"Desktop\";\n\n            Nullable&lt;bool&gt; result = openFileDialog1.ShowDialog();\n            if (result == true)\n            {\n                string pathName = openFileDialog1.FileName;\n                string fileName = System.IO.Path.GetFileNameWithoutExtension(openFileDialog1.FileName);\n                DataTable tbContainer = new DataTable();\n                string strConn = string.Empty;\n                string sheetName = fileName;\n\n                FileInfo file = new FileInfo(pathName);\n                if (!file.Exists) { throw new Exception(\"Error, file doesn't exists!\"); }\n                string extension = file.Extension;\n                switch (extension)\n                {\n                    case \".xls\":\n                        strConn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + pathName + \";Extended Properties='Excel 8.0;HDR=Yes;IMEX=1;'\";\n                        break;\n                    case \".xlsx\":\n                        strConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + pathName + \";Extended Properties='Excel 12.0;HDR=Yes;IMEX=1;'\";\n                        break;\n                    default:\n                        strConn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + pathName + \";Extended Properties='Excel 8.0;HDR=Yes;IMEX=1;'\";\n                        break;\n                }\n                OleDbConnection cnnxls = new OleDbConnection(strConn);\n                OleDbDataAdapter oda = new OleDbDataAdapter(string.Format(\"select * from [{0}$]\", sheetName), cnnxls);\n                oda.Fill(tbContainer);\n\n                gridStudents.SetBinding(ItemsControl.ItemsSourceProperty, new Binding { Source = tbContainer });\n            }\n\n        }\n        catch (Exception)\n        {\n\n        }\n    }\n</code></pre>\n"}