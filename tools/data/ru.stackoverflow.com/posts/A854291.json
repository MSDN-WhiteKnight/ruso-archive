{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":1,"last_activity_date":1531496638,"last_edit_date":1531496638,"creation_date":1531494288,"answer_id":854291,"question_id":853725,"body":"<p>Используйте класс SqlConnectionStringBuilder, он позволяет безопасно построить строку соединения из данных, полученных на этапе выполнения (например, из TextBox):</p>\n\n<pre><code>using System.Data.SqlClient;\n...\n\nSqlConnectionStringBuilder builder = new SqlConnectionStringBuilder();\nbuilder.DataSource = ServerName;\nbuilder.InitialCatalog = DatabaseName;\nbuilder.UserID = UserName;\nbuilder.Password = Password;\nstring ConnectionString = builder.ConnectionString;\n</code></pre>\n\n<p>Если нужен продвинутый GUI для ввода параметров базы данных, можно воспользоваться ActiveX диалоговым окном OLE DB (оно строит строку соединения для провайдера OLE DB, а не обычного SQL Client, но суть та же):</p>\n\n<pre><code>//Добавить ссылки:\n//COM -&gt; Microsoft OLE DB Service Component 1.0 Type Library\n//COM -&gt; Microsoft ActiveX Data Objects 2.0 Library\n\nstring ConnString = \"\";\nobject _con = null;\nMSDASC.DataLinks _link = new MSDASC.DataLinks();\n\n_con = _link.PromptNew();\nif (_con == null) ConnString = string.Empty;\nelse ConnString = ((ADODB.Connection)_con).ConnectionString;\n</code></pre>\n\n<p>Выглядит как-то так:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hTPUr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hTPUr.png\" alt=\"Database selction dialog\"></a></p>\n\n<p>Источник: <a href=\"https://stackoverflow.com/a/2256149/8674428\">https://stackoverflow.com/a/2256149/8674428</a></p>\n"}