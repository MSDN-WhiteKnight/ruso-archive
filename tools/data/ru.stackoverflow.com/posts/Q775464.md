---
title: "Поддерживается ли функция localtime_s в трансляторе GCC?"
se.owner.user_id: 192421
se.owner.display_name: "pepsicoca1"
se.owner.link: "https://ru.stackoverflow.com/users/192421/pepsicoca1"
se.link: "https://ru.stackoverflow.com/questions/775464/%d0%9f%d0%be%d0%b4%d0%b4%d0%b5%d1%80%d0%b6%d0%b8%d0%b2%d0%b0%d0%b5%d1%82%d1%81%d1%8f-%d0%bb%d0%b8-%d1%84%d1%83%d0%bd%d0%ba%d1%86%d0%b8%d1%8f-localtime-s-%d0%b2-%d1%82%d1%80%d0%b0%d0%bd%d1%81%d0%bb%d1%8f%d1%82%d0%be%d1%80%d0%b5-gcc"
se.question_id: 775464
se.post_type: question
se.score: 3
---
<p>Добрый день.</p>

<p>Пользуюсь в основном Visual Studio, и с некоторых пор Visual Studio с маниакальным упорством настаивает, чтобы вместо localtime все применяли localtime_s из-за незащищенности localtime от использования в многопоточных приложениях. В версии Visual Studio 2017 это предупреждение переведено в ранг ошибки компилятора. </p>

<p>Все бы ничего, но иногда нужно чтобы код транслировался и под GCC. Поэтому я решил проверить, поддерживается ли localtime_s в GCC. Я взял онлайн транслятор GCC <a href="http://cpp.sh/" rel="nofollow noreferrer">http://cpp.sh/</a> и написал программу:</p>

<pre><code>// Example program
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;time.h&gt;

int main()
{

struct tm *ptr;
struct tm structtime;
time_t lt;
lt = time(NULL);

ptr = localtime(&amp;lt);
printf(asctime(ptr));

ptr = localtime_s(&amp;structtime,&amp;lt);
printf(asctime(&amp;structtime));

  std::string name;
  std::cout &lt;&lt; "What is your name? ";
  getline (std::cin, name);
  std::cout &lt;&lt; "Hello, " &lt;&lt; name &lt;&lt; "!\n";
}
</code></pre>

<p>При попытки трансляции в строке </p>

<pre><code>ptr = localtime_s(&amp;structtime,&amp;lt);
</code></pre>

<p>транслятор сообщил мне, что:</p>

<blockquote>
  <p>17:34: error: 'localtime_s' was not declared in this scope</p>
</blockquote>

<p>Соответственно вопросы:</p>

<ol>
<li>Поддерживается ли localtime_s в GCC?</li>
<li>Может быть нужен другой хедер, не time.h?</li>
</ol>

<p>Спасибо.</p>

<p>UPD1:</p>

<p>На других онлайн GCC трансляторах таких как:</p>

<p><a href="https://www.onlinegdb.com/online_c++_compiler" rel="nofollow noreferrer">https://www.onlinegdb.com/online_c++_compiler</a></p>

<p><a href="https://ideone.com/" rel="nofollow noreferrer">https://ideone.com/</a></p>

<p>тоже не работает localtime_s. Даже если определить все указанные макросы.</p>
