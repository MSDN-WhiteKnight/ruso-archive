---
title: "Получить свойства звукового устройства с помощью MMDevice API"
se.owner.user_id: 243717
se.owner.display_name: "Range"
se.owner.link: "https://ru.stackoverflow.com/users/243717/range"
se.link: "https://ru.stackoverflow.com/questions/733291/%d0%9f%d0%be%d0%bb%d1%83%d1%87%d0%b8%d1%82%d1%8c-%d1%81%d0%b2%d0%be%d0%b9%d1%81%d1%82%d0%b2%d0%b0-%d0%b7%d0%b2%d1%83%d0%ba%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d1%83%d1%81%d1%82%d1%80%d0%be%d0%b9%d1%81%d1%82%d0%b2%d0%b0-%d1%81-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e-mmdevice-api"
se.question_id: 733291
se.post_type: question
se.score: 2
---
<p>Требуется получить определённые свойства звукового устройства(выделю на скриншоте). Я дошёл до свойств, получил количество этих свойств, могу к ним обратиться - но что делать далее не знаю. Подскажите, как получить данные свойства(именно, наименование, количество..)
Код:</p>

<pre><code>    HRESULT hresult; // для ошибок и проверок
    const CLSID CLSID_MMDeviceEnumerator = __uuidof(MMDeviceEnumerator);
    const IID IID_IMMDeviceEnumerator = __uuidof(IMMDeviceEnumerator);
    CoInitialize(NULL); // инициализируем систему COM
    hresult = CoCreateInstance( // создаем COM - объект, связанный с устройствами аудио вывода
        CLSID_MMDeviceEnumerator, NULL,
        CLSCTX_ALL, IID_IMMDeviceEnumerator,
        (void**)&amp;enumerator);

    IMMDeviceCollection *pCollection = nullptr; // указатель на коллекцию устройств
    IMMDevice *pEndpoint = NULL; // указатель на конкретное устройство

    hresult = this-&gt;enumerator-&gt;EnumAudioEndpoints( // получаем список устройств в системе(оно одно у меня, добавлять не думаю, но
        // если буду - делать проверку устройств(ниже) в цикле, там надо получить количество устройств ещё
        eRender, DEVICE_STATE_ACTIVE,
        &amp;pCollection);

    hresult = pCollection-&gt;Item(0, &amp;pEndpoint); // получаем единственное устройство в системе
    IPropertyStore* propertys; // свойства устройства
    hresult = pEndpoint-&gt;OpenPropertyStore(STGM_READ, &amp;propertys); // получаем свойства устройства для чтения(запись нам не нужна)
    DWORD count;  propertys-&gt;GetCount(&amp;count);
    for (DWORD i(0); i &lt; count; i++)
    {
        PROPERTYKEY prop;
        propertys-&gt;GetAt(i, &amp;prop);
        // конкретные свойства(какие?) лежат в prop, но как "расшифровать" - не понимаю
    }
</code></pre>

<p><a href="https://i.stack.imgur.com/8TzKd.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/8TzKd.png" alt="введите сюда описание изображения"></a></p>
