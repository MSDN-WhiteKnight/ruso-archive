{"tags":["c#","naudio"],"owner":{"reputation":101,"user_id":312216,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/63475be41ffbbdb764f884160eeafdac?s=128&d=identicon&r=PG&f=1","display_name":"Liidia","link":"https://ru.stackoverflow.com/users/312216/liidia"},"is_answered":true,"view_count":86,"accepted_answer_id":915097,"answer_count":1,"score":2,"last_activity_date":1543863350,"creation_date":1543844127,"last_edit_date":1543846143,"question_id":914946,"link":"https://ru.stackoverflow.com/questions/914946/exception-from-hresult-0x80072ee7","title":"Exception from HResult 0x80072EE7","body":"<p>Что может означать ошибка Exception from HResult 0x80072EE7? Где это можно подсмотреть?</p>\n\n<p>Конкретно ошибка возникает при использовании библиотеки NAudio, при вызове MediaFoundationReader.Read. Ниже мой код.</p>\n\n<pre><code>private void PlaceLinksIntoBuffer()\n        {\n            Uri baseUri = new Uri(InputPath);\n            while (!IsStopped)\n            {\n                mediaSegmentUris.TryPeek(out IMediaSegment mediaSegment);\n                if (mediaSegment == null) continue;\n\n                int mediaSegmentApproximateDuration = Convert.ToInt32(Math.Ceiling(mediaSegment.Duration));\n\n                if (IsBufferNearlyFull(mediaSegmentApproximateDuration))\n                {\n                    Thread.Sleep(500);\n                }\n                else\n                {\n                    mediaSegmentUris.TryDequeue(out mediaSegment);\n                    Uri resourceUri = new Uri(baseUri, mediaSegment.Uri);\n\n                    MediaFoundationReader mediaFoundationReader;\n                    try\n                    {\n                        mediaFoundationReader =\n                            new MediaFoundationReader(resourceUri.AbsoluteUri);\n                        readUris.Enqueue(mediaSegment.Uri);\n                    }\n                    catch (Exception e)\n                    {\n                        brokenUris.Enqueue(mediaSegment.Uri);\n                        continue;\n                    }\n\n                    byte[] buffer = new byte [mediaFoundationReader.WaveFormat.AverageBytesPerSecond *\n                                              mediaSegmentApproximateDuration * 2];\n                    int readBytes = mediaFoundationReader.Read(buffer, 0,\n                        mediaFoundationReader.WaveFormat.AverageBytesPerSecond * mediaSegmentApproximateDuration * 2);\n\n                    if (bufferedWaveProvider == null)\n                    {\n                        bufferedWaveProvider = new BufferedWaveProvider(mediaFoundationReader.WaveFormat)\n                        {\n                            BufferDuration = TimeSpan.FromSeconds(mediaSegmentApproximateDuration * 5)\n                        };\n                    }\n\n                    bufferedWaveProvider.AddSamples(buffer, 0, readBytes);\n                    mediaFoundationReader.Dispose();\n                }\n            }\n        }\n</code></pre>\n"}