{"tags":["c++"],"owner":{"reputation":22984,"user_id":176217,"user_type":"registered","accept_rate":88,"profile_image":"https://i.stack.imgur.com/4sQMO.jpg?s=128&g=1","display_name":"αλεχολυτ","link":"https://ru.stackoverflow.com/users/176217/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"},"is_answered":true,"view_count":622,"answer_count":5,"score":14,"last_activity_date":1532936944,"creation_date":1513681551,"question_id":760436,"link":"https://ru.stackoverflow.com/questions/760436/%d0%9f%d0%b5%d1%80%d0%b5%d0%b4%d0%b0%d1%87%d0%b0-%d0%bf%d0%be-%d1%81%d1%81%d1%8b%d0%bb%d0%ba%d0%b5-%d1%81-%d0%bf%d0%be%d1%81%d0%bb%d0%b5%d0%b4%d1%83%d1%8e%d1%89%d0%b8%d0%bc-%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5%d0%bc-vs-%d0%bf%d0%b5%d1%80%d0%b5%d0%b4%d0%b0%d1%87%d0%b0-%d0%bf%d0%be-%d0%b7%d0%bd%d0%b0%d1%87%d0%b5%d0%bd%d0%b8%d1%8e","title":"Передача по ссылке с последующим копированием vs передача по значению","body":"<p>Есть некий тяжёлый для копирования тип, например:</p>\n\n<pre><code>struct S \n{ \n    int a[100]; \n};\n</code></pre>\n\n<p>И стоит задача обработки значения переменной этого типа с возвратом изменённой копии, т.е. оригинал должен быть сохранён. Напрашиваются два подхода:</p>\n\n<ol>\n<li><pre><code>S test(const S&amp; s)\n{\n    S news = s;           // делаем копию\n    news.a[42] = 100500;  // изменяем \n    return news;          // возвращаем\n}\n</code></pre></li>\n<li><pre><code>S test(S s)               // делаем копию\n{\n    s.a[42] = 100500;     // изменяем\n    return s;             // возвращаем\n}\n</code></pre></li>\n</ol>\n\n<p>Вариант 2 выглядит более коротким с точки зрения кода, однако, как показывает <a href=\"https://godbolt.org/g/G6UhMd\" rel=\"noreferrer\">сборка</a>, передача по ссылке даёт более короткий ассемблерный код.</p>\n\n<p>Почему так происходит и какие есть ещё плюсы и минусы этих двух подходов, чтобы понимать, какой из них предпочесть? Может есть ещё какие-то варианты?</p>\n"}