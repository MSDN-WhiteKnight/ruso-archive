---
title: "Answer 594022"
se.owner.user_id: 228528
se.owner.display_name: "Даниил Чижевский"
se.owner.link: "https://ru.stackoverflow.com/users/228528/%d0%94%d0%b0%d0%bd%d0%b8%d0%b8%d0%bb-%d0%a7%d0%b8%d0%b6%d0%b5%d0%b2%d1%81%d0%ba%d0%b8%d0%b9"
se.answer_id: 594022
se.question_id: 592948
se.post_type: answer
se.score: 0
se.is_accepted: False
---
<p>Ну, как-то так:</p>

<pre><code>using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using System.Windows;
using System.Runtime.InteropServices;


  namespace VolumeOff
  {
    [StructLayout(LayoutKind.Sequential)]
    public struct WAVEFORMATEX
    {
        public ushort wFormatTag;
        public ushort nChannels;
        public uint nSamplesPerSec;
        public uint nAvgBytesPerSec;
        public ushort nBlockAlign;
        public ushort wBitsPerSample;
        public ushort cbSize;
    }


   public partial class Form1 : Form
   {
    public const uint WAVE_MAPPER = unchecked((uint)(-1));
    public Form1()
    {
        InitializeComponent();
    }
    [DllImport("winmm.dll", SetLastError = true)]
    public static extern uint waveOutOpen(ref uint hWaveOut, uint uDeviceID, ref WAVEFORMATEX lpFormat, uint dwCallback, uint dwInstance, uint dwFlags);

    [DllImport("winmm.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern uint waveOutGetVolume(uint hwo, ref uint dwVolume);

    [DllImport("winmm.dll", SetLastError = true, CallingConvention = CallingConvention.Winapi)]
    public static extern int waveOutSetVolume(uint uDeviceID, uint dwVolume);

    [DllImport("winmm.dll", SetLastError = true, CharSet = CharSet.Auto)]
    public static extern uint waveOutClose(uint hwo);

    [DllImport("Kernel32.dll", EntryPoint = "RtlZeroMemory", SetLastError = false)]
    static extern void ZeroMemory(ref WAVEFORMATEX dest, int size);


    private void button1_Click(object sender, EventArgs e)
    {
        uint volume = 0;
        unsafe
        {
            uint hWO = 0;
            WAVEFORMATEX waveF = new WAVEFORMATEX();

            ZeroMemory(ref waveF, sizeof(WAVEFORMATEX));
            waveOutOpen(ref hWO, WAVE_MAPPER, ref waveF, 0, 0, 0);
            waveOutGetVolume(hWO, ref volume);
            waveOutClose(hWO);
        }
        textBox1.Text = volume.ToString();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        unsafe
        {
            uint hWO = 0;
            WAVEFORMATEX waveF = new WAVEFORMATEX();

            ZeroMemory(ref waveF, sizeof(WAVEFORMATEX));
            waveOutOpen(ref hWO, WAVE_MAPPER, ref waveF, 0, 0, 0);
            waveOutSetVolume(hWO, Convert.ToUInt32(textBox1.Text.ToString()));
            waveOutClose(hWO);
        }
     }
  }
}
</code></pre>
