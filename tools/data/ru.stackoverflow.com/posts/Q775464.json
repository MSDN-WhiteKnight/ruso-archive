{"tags":["c++","visual-studio","gcc","visual-studio-2017"],"owner":{"reputation":4282,"user_id":192421,"user_type":"registered","accept_rate":48,"profile_image":"https://www.gravatar.com/avatar/e287adb1e5d34863c9e5a5aa6a73d67a?s=128&d=identicon&r=PG","display_name":"pepsicoca1","link":"https://ru.stackoverflow.com/users/192421/pepsicoca1"},"is_answered":true,"view_count":308,"accepted_answer_id":775470,"answer_count":2,"score":3,"last_activity_date":1516942061,"creation_date":1516876023,"last_edit_date":1516880259,"question_id":775464,"link":"https://ru.stackoverflow.com/questions/775464/%d0%9f%d0%be%d0%b4%d0%b4%d0%b5%d1%80%d0%b6%d0%b8%d0%b2%d0%b0%d0%b5%d1%82%d1%81%d1%8f-%d0%bb%d0%b8-%d1%84%d1%83%d0%bd%d0%ba%d1%86%d0%b8%d1%8f-localtime-s-%d0%b2-%d1%82%d1%80%d0%b0%d0%bd%d1%81%d0%bb%d1%8f%d1%82%d0%be%d1%80%d0%b5-gcc","title":"Поддерживается ли функция localtime_s в трансляторе GCC?","body":"<p>Добрый день.</p>\n\n<p>Пользуюсь в основном Visual Studio, и с некоторых пор Visual Studio с маниакальным упорством настаивает, чтобы вместо localtime все применяли localtime_s из-за незащищенности localtime от использования в многопоточных приложениях. В версии Visual Studio 2017 это предупреждение переведено в ранг ошибки компилятора. </p>\n\n<p>Все бы ничего, но иногда нужно чтобы код транслировался и под GCC. Поэтому я решил проверить, поддерживается ли localtime_s в GCC. Я взял онлайн транслятор GCC <a href=\"http://cpp.sh/\" rel=\"nofollow noreferrer\">http://cpp.sh/</a> и написал программу:</p>\n\n<pre><code>// Example program\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;time.h&gt;\n\nint main()\n{\n\nstruct tm *ptr;\nstruct tm structtime;\ntime_t lt;\nlt = time(NULL);\n\nptr = localtime(&amp;lt);\nprintf(asctime(ptr));\n\nptr = localtime_s(&amp;structtime,&amp;lt);\nprintf(asctime(&amp;structtime));\n\n  std::string name;\n  std::cout &lt;&lt; \"What is your name? \";\n  getline (std::cin, name);\n  std::cout &lt;&lt; \"Hello, \" &lt;&lt; name &lt;&lt; \"!\\n\";\n}\n</code></pre>\n\n<p>При попытки трансляции в строке </p>\n\n<pre><code>ptr = localtime_s(&amp;structtime,&amp;lt);\n</code></pre>\n\n<p>транслятор сообщил мне, что:</p>\n\n<blockquote>\n  <p>17:34: error: 'localtime_s' was not declared in this scope</p>\n</blockquote>\n\n<p>Соответственно вопросы:</p>\n\n<ol>\n<li>Поддерживается ли localtime_s в GCC?</li>\n<li>Может быть нужен другой хедер, не time.h?</li>\n</ol>\n\n<p>Спасибо.</p>\n\n<p>UPD1:</p>\n\n<p>На других онлайн GCC трансляторах таких как:</p>\n\n<p><a href=\"https://www.onlinegdb.com/online_c++_compiler\" rel=\"nofollow noreferrer\">https://www.onlinegdb.com/online_c++_compiler</a></p>\n\n<p><a href=\"https://ideone.com/\" rel=\"nofollow noreferrer\">https://ideone.com/</a></p>\n\n<p>тоже не работает localtime_s. Даже если определить все указанные макросы.</p>\n"}