---
title: "Как получить доступ к порту сканера QR-кода?"
se.owner.user_id: 312216
se.owner.display_name: "Liidia"
se.owner.link: "https://ru.stackoverflow.com/users/312216/liidia"
se.link: "https://ru.stackoverflow.com/questions/912284/%d0%9a%d0%b0%d0%ba-%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b8%d1%82%d1%8c-%d0%b4%d0%be%d1%81%d1%82%d1%83%d0%bf-%d0%ba-%d0%bf%d0%be%d1%80%d1%82%d1%83-%d1%81%d0%ba%d0%b0%d0%bd%d0%b5%d1%80%d0%b0-qr-%d0%ba%d0%be%d0%b4%d0%b0"
se.question_id: 912284
se.post_type: question
se.score: 2
---
<p>У меня есть подключенный через USB-порт сканер QR-кода. Естественно, что известны его vendor ID и product ID. Как, имея эти данные, распознать, какой порт слушать? Я опыталась использовать библиотеку LibUsbDotNet, но не смогла понять, как с ней работать. Информацию о подключенных клавиатурах я могу получить следующим образом, но совершенно не могу понять, что делать дальше.</p>

<pre><code>ManagementObjectSearcher searcher =
                              new ManagementObjectSearcher("root\\CIMV2",
                              "SELECT * FROM Win32_Keyboard");
            ManagementObjectCollection keyboards = searcher.Get();

            foreach (ManagementObject queryObj in keyboards)
            {
                Console.WriteLine("-----------------------------------");
                Console.WriteLine("Win32_Keyboard instance");
                Console.WriteLine("-----------------------------------");
                Console.WriteLine("Availability: {0}", queryObj["Availability"]);
                Console.WriteLine("Caption: {0}", queryObj["Caption"]);
                Console.WriteLine("ConfigManagerErrorCode: {0}", queryObj["ConfigManagerErrorCode"]);
                Console.WriteLine("ConfigManagerUserConfig: {0}", queryObj["ConfigManagerUserConfig"]);
                Console.WriteLine("CreationClassName: {0}", queryObj["CreationClassName"]);
                Console.WriteLine("Description: {0}", queryObj["Description"]);
                Console.WriteLine("DeviceID: {0}", queryObj["DeviceID"]);
                Console.WriteLine("ErrorCleared: {0}", queryObj["ErrorCleared"]);
                Console.WriteLine("ErrorDescription: {0}", queryObj["ErrorDescription"]);
                Console.WriteLine("InstallDate: {0}", queryObj["InstallDate"]);
                Console.WriteLine("IsLocked: {0}", queryObj["IsLocked"]);
                Console.WriteLine("LastErrorCode: {0}", queryObj["LastErrorCode"]);
                Console.WriteLine("Layout: {0}", queryObj["Layout"]);
                Console.WriteLine("Name: {0}", queryObj["Name"]);
                Console.WriteLine("NumberOfFunctionKeys: {0}", queryObj["NumberOfFunctionKeys"]);
                Console.WriteLine("Password: {0}", queryObj["Password"]);
                Console.WriteLine("PNPDeviceID: {0}", queryObj["PNPDeviceID"]);

                if (queryObj["PowerManagementCapabilities"] == null)
                    Console.WriteLine("PowerManagementCapabilities: {0}", queryObj["PowerManagementCapabilities"]);
                else
                {
                    UInt16[] arrPowerManagementCapabilities = (UInt16[])(queryObj["PowerManagementCapabilities"]);
                    foreach (UInt16 arrValue in arrPowerManagementCapabilities)
                    {
                        Console.WriteLine("PowerManagementCapabilities: {0}", arrValue);
                    }
                }
                Console.WriteLine("PowerManagementSupported: {0}", queryObj["PowerManagementSupported"]);
                Console.WriteLine("Status: {0}", queryObj["Status"]);
                Console.WriteLine("StatusInfo: {0}", queryObj["StatusInfo"]);
                Console.WriteLine("SystemCreationClassName: {0}", queryObj["SystemCreationClassName"]);
                Console.WriteLine("SystemName: {0}", queryObj["SystemName"]);
            }

            Console.ReadKey();
</code></pre>
