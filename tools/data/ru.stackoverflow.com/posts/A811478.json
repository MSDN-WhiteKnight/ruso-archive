{"owner":{"reputation":16068,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":1,"last_activity_date":1523251259,"creation_date":1523251259,"answer_id":811478,"question_id":805934,"body":"<blockquote>\n  <p>Даже при сохранении в html-формате пишется кол-во объединенных колонок и строк.</p>\n</blockquote>\n\n<p>Так может и воспользоваться этой деталью? Перегнать doc в html и распарсить атрибут <em>colspan</em>/<em>rowspan</em></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Data;\nusing System.IO;\nusing System.Text;\nusing Microsoft.Office.Interop.Word;\nusing System.Runtime.InteropServices;\n//Add Reference: Microsoft HTML Object Library\n\nnamespace ConsoleApplication1\n{\n    class Program\n    {\n        public static List&lt;string&gt; FindMergedColumns(string html)\n        {\n            List&lt;string&gt; res = new List&lt;string&gt;();\n\n            mshtml.HTMLDocument doc = null;\n            mshtml.IHTMLDocument2 d2 = null;\n            mshtml.IHTMLDocument3 d = null;            \n\n            try\n            {\n                doc = new mshtml.HTMLDocument();\n                d2 = (mshtml.IHTMLDocument2)doc;\n                d2.write(html);\n                d2.close();\n\n                d = (mshtml.IHTMLDocument3)doc;\n                var coll = d.getElementsByTagName(\"table\");\n                object val;\n                int numtable = 1;\n                int row = 1, column = 1;\n                int span;\n\n                foreach (mshtml.IHTMLElement2 table in coll)\n                {\n                    var rows = table.getElementsByTagName(\"tr\");\n                    foreach (mshtml.IHTMLElement2 tr in rows)\n                    {               \n                        var cells = tr.getElementsByTagName(\"td\");\n                        foreach (mshtml.IHTMLElement td in cells)\n                        {\n                            val = td.getAttribute(\"colspan\");\n                            if(val == null)val = 0;\n                            span = Convert.ToInt32(val);\n\n                            if (span &gt; 1)\n                            {\n                                res.Add(String.Format(\"Table {0}, Row {1}, Column {2}: {3} columns merged\",numtable,row,column,span));\n                            }\n\n                            column++;\n                        }\n                        row++;\n                        column = 1;\n                    }\n                    numtable++;\n                    row = 1; column = 1;\n                }\n                doc.close();\n            }\n            finally\n            {\n                //освобождение ресурсов\n                if (doc != null) Marshal.ReleaseComObject(doc);\n                if (d2 != null) Marshal.ReleaseComObject(d2);\n                if (d != null) Marshal.ReleaseComObject(d);\n            }\n            return res;\n        }\n\n        public static void Main(string[] argv)\n        {\n            var word = new Microsoft.Office.Interop.Word.Application();\n            object miss = System.Reflection.Missing.Value;\n            object path = \"c:\\\\test\\\\test.doc\";\n            object readOnly = true;\n            var docs = word.Documents.Open(ref path, ref miss, ref readOnly,\n                                           ref miss, ref miss, ref miss, ref miss,\n                                           ref miss, ref miss, ref miss, ref miss,\n                                           ref miss, ref miss, ref miss, ref miss,\n                                           ref miss);\n\n            string tmp = Path.GetTempPath() + \"file.htm\";\n\n            //конвертируем doc в html\n            docs.SaveAs(FileName: tmp, FileFormat: WdSaveFormat.wdFormatHTML);\n            ((_Document)docs).Close();\n            ((_Application)word).Quit();\n\n            //парсим HTML\n            string html = File.ReadAllText(tmp);\n            var res = FindMergedColumns(html);\n            File.Delete(tmp);\n\n            foreach (var line in res) Console.WriteLine(line);\n            Console.ReadKey();            \n\n        }        \n\n    }\n\n}\n</code></pre>\n"}