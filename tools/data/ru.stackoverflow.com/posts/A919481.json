{"owner":{"reputation":16137,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":0,"last_activity_date":1544699080,"creation_date":1544699080,"answer_id":919481,"question_id":916231,"body":"<p>Похожая проблема описана здесь: <a href=\"https://github.com/dotnet/roslyn/issues/25370\" rel=\"nofollow noreferrer\">https://github.com/dotnet/roslyn/issues/25370</a></p>\n\n<p>Если добавить в код вывод диагностических сообщений MSBuild:</p>\n\n<pre><code>var diagnostics = msWorkspace.Diagnostics;\nforeach (var diagnostic in diagnostics)\n{\n     Console.WriteLine(diagnostic.Message);\n}\n</code></pre>\n\n<p>Он покажет примерно следующее:</p>\n\n<blockquote>\n  <p>Сбой Msbuild при обработке файла \"...\" с сообщением: MSB0001: Internal MSBuild Error: Type information for Microsoft.Build.Utilities.ToolLocationHelper was present in the whitelist cache as Microsoft.Build.Utilities.ToolLocationHelper, Microsoft.Build.Utilities.Core, Version=15.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a but the type could not be loaded. unexpectedly null</p>\n</blockquote>\n\n<p>Установка NuGet-пакета <a href=\"https://www.nuget.org/packages/Microsoft.Build.Tasks.Core/15.9.20\" rel=\"nofollow noreferrer\">Microsoft.Build.Tasks.Core</a> должна решить проблему. Ошибки MSBuild при этом полностью не исчезают, однако, список документов начинает выводится:</p>\n\n<pre><code>foreach (Project project in solution.Projects)\n{\n    Console.WriteLine(project.Name);                \n    foreach (var document in project.Documents)\n    {\n        Console.WriteLine(\"- \" + document.Name);\n    }\n}\n\n/* Результат:\n\nConsoleApp1\n- Program.cs\n- AssemblyInfo.cs\n- .NETFramework,Version=v4.6.AssemblyAttributes.cs\n*/\n</code></pre>\n"}