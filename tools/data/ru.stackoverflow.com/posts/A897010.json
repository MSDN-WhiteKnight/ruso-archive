{"owner":{"reputation":16117,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":1,"last_activity_date":1540321566,"creation_date":1540321566,"answer_id":897010,"question_id":896643,"body":"<blockquote>\n  <p>Хотя если модуль был загружен то LoadLibrary возвращает его Handle а не бросает ошибку, что странно</p>\n</blockquote>\n\n<p>На самом деле, в этом нет ничего странного. Загрузка DLL в Windows спроектирована так, чтобы два куска кода в одном процессе могли независимо друг от друга использовать одну и ту же библиотеку. Когда вы вызываете LoadLibrary и библиотека уже загружена, она не просто возвращает дескриптор, а еще и увеличивает счетчик ссылок для этой библиотеки. Последующий вызов FreeLibrary не выгрузит библиотеку сразу, а уменьшит счетчик ссылок, и выгрузит ее только когда счетчик ссылок достигнет нуля. О каком-то \"коде ошибки\" в данном случае речи не идет, это абсолютно штатная ситуация.</p>\n\n<p>При обычном использовании функций LoadLibrary / GetProcAddress нет особой необходимости задумываться, загружена ли уже библиотека или нет. Если нужно именно проверить, загружена ли библиотека (например, в целях отладки), функция GetModuleHandle подходит: она для незагруженного модуля вернет NULL и GetLastError будет равно 0x0000007E (ERROR_MOD_NOT_FOUND).</p>\n"}