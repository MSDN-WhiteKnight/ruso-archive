---
title: "Как создать/перезаписать свойства и группы свойств файла со Structured Storage API?"
se.owner.user_id: 182750
se.owner.display_name: "XelaNimed"
se.owner.link: "https://ru.stackoverflow.com/users/182750/xelanimed"
se.link: "https://ru.stackoverflow.com/questions/966846/%d0%9a%d0%b0%d0%ba-%d1%81%d0%be%d0%b7%d0%b4%d0%b0%d1%82%d1%8c-%d0%bf%d0%b5%d1%80%d0%b5%d0%b7%d0%b0%d0%bf%d0%b8%d1%81%d0%b0%d1%82%d1%8c-%d1%81%d0%b2%d0%be%d0%b9%d1%81%d1%82%d0%b2%d0%b0-%d0%b8-%d0%b3%d1%80%d1%83%d0%bf%d0%bf%d1%8b-%d1%81%d0%b2%d0%be%d0%b9%d1%81%d1%82%d0%b2-%d1%84%d0%b0%d0%b9%d0%bb%d0%b0-%d1%81%d0%be-structured-storage-a"
se.question_id: 966846
se.post_type: question
se.score: 4
---
<p>Работаю с программой <a href="https://solidedge.siemens.com/ru/" rel="nofollow noreferrer">SolidEdge</a> от Siemens. Мне необходимо читать/создавать/редактировать свойства и группы свойств файлов. Для этих целей имеется официальное COM API, но оно требует установленную SolidEdge с лицензией и помимо этого работает очень медленно. Но так как файлы программы являются составными (<a href="https://docs.microsoft.com/en-us/windows/desktop/Stg/compound-files" rel="nofollow noreferrer">Compound Files</a>) и поддерживают API структурированного хранилища (<a href="https://docs.microsoft.com/en-us/windows/desktop/Stg/structured-storage-start-page" rel="nofollow noreferrer">Structured Storage</a>), то это можно использовать для решения задачи. Для чтения свойств файла уже существует <a href="https://github.com/SolidEdgeCommunity/SolidEdge.Community.Reader" rel="nofollow noreferrer">SolidEdge.Community.Reader</a>, с помощью которого можно читать свойства файлов не используя COM интерфейс, но он поддерживает только чтение свойств. На <a href="https://community.plm.automation.siemens.com/t5/Solid-Edge-Developer-Forum/Writing-to-Solid-Edge-File-Properties-without-SE-installed/td-p/442302" rel="nofollow noreferrer">форуме Siemens</a> автор библиотеки <a href="https://community.plm.automation.siemens.com/t5/Solid-Edge-Developer-Forum/Writing-to-Solid-Edge-File-Properties-without-SE-installed/m-p/442585/highlight/true#M9294" rel="nofollow noreferrer">предлагает</a> добавить функциональность создания/редактирования свойств, если это необходимо, но каким образом не уточняет. Как бы то ни было, с помощью Structured Storage API решить проблему возможно. В этом я убедился используя <a href="http://www.mitec.cz/ssv.html" rel="nofollow noreferrer">Structured Storage Viewer</a>, с помощью которого можно редактировать свойства файлов, создавать группы свойств и т.д.. После продолжительного поиска ничего конкретного для работы со составными файлами с помощью C# я не нашёл. В связи с чем имеются пару вопросов:</p>

<ul>
<li>каким образом создавать/редактировать/удалять группы свойств в составных файлах?  </li>
<li>каким образом создавать/редактировать/удалять свойства в составных файлах?</li>
<li>в идеале хотелось бы узнать, каким образом расширить функционал библиотеки <a href="https://github.com/SolidEdgeCommunity/SolidEdge.Community.Reader" rel="nofollow noreferrer">SolidEdge.Community.Reader</a> для возможности записи свойств?</li>
</ul>

<hr>

<h3>Ссылки по теме</h3>

<ul>
<li><a href="https://stackoverflow.com/questions/55581942">вопрос на enSO</a></li>
<li><a href="https://docs.microsoft.com/en-us/windows/desktop/Stg/compound-files" rel="nofollow noreferrer">Compound Files</a></li>
<li><a href="https://docs.microsoft.com/en-us/windows/desktop/Stg/structured-storage-start-page" rel="nofollow noreferrer">Structured Storage</a></li>
<li><a href="https://github.com/SolidEdgeCommunity/SolidEdge.Community.Reader" rel="nofollow noreferrer">SolidEdge.Community.Reader на GitHub</a></li>
<li><a href="http://www.mitec.cz/ssv.html" rel="nofollow noreferrer">Structured Storage Viewer</a></li>
<li><a href="https://github.com/ironfede/openmcdf" rel="nofollow noreferrer">OpenMcdf на GitHub</a></li>
</ul>

<p>P.S.: <a href="https://www.dropbox.com/s/0xqs6doxb23sswm/Test.par?dl=0" rel="nofollow noreferrer">файл</a> SolidEdge для тестов.</p>
