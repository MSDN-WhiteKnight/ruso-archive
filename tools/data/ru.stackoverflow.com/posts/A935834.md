---
title: "Answer 935834"
se.owner.user_id: 291056
se.owner.display_name: "Aleks Keller"
se.owner.link: "https://ru.stackoverflow.com/users/291056/aleks-keller"
se.answer_id: 935834
se.question_id: 931706
se.post_type: answer
se.score: 0
se.is_accepted: True
---
<p>Как всё заработало в итоге.</p>

<pre><code>//виртуальный буфер (глобальная переменная)
private RichTextBox _richTextBox = new RichTextBox();

//название файла для сохранения
string target = "Договор №" + CurrentCredit.Number + ".doc";
//грузим шаблон в RichTextBox - контрол сам порешает за все кодировки
_richTextBox.LoadFile(Storage.AgreementTemplateFile, RichTextBoxStreamType.RichText);
//магия
Replace("#nomer#", CurrentCredit.Number.ToString());
//при сохранении о кодировке опять-таки позаботится RichTextBox
_richTextBox.SaveFile(target);

//главное - функция Replace:

private void Replace(string from, string to)
{
    int start = _richTextBox.Find(from, 0, RichTextBoxFinds.None);
    _richTextBox.Select(start, from.Length);
    _richTextBox.SelectedText = to;
}
</code></pre>
