---
title: "Открытый OleDbConnection не дает завершится программу"
se.owner.user_id: 32793
se.owner.display_name: "iluxa1810"
se.owner.link: "https://ru.stackoverflow.com/users/32793/iluxa1810"
se.link: "https://ru.stackoverflow.com/questions/796861/%d0%9e%d1%82%d0%ba%d1%80%d1%8b%d1%82%d1%8b%d0%b9-oledbconnection-%d0%bd%d0%b5-%d0%b4%d0%b0%d0%b5%d1%82-%d0%b7%d0%b0%d0%b2%d0%b5%d1%80%d1%88%d0%b8%d1%82%d1%81%d1%8f-%d0%bf%d1%80%d0%be%d0%b3%d1%80%d0%b0%d0%bc%d0%bc%d1%83"
se.question_id: 796861
se.post_type: question
se.score: -5
---
<p>Я понимаю, что хорошим стилем является самому вызвать <code>Dispose</code> в нужном месте.</p>

<p>Однако, есть простое консольное приложение, которое работает с <code>OleDbConnection</code>, делая запросы к БД.</p>

<p>Так вот, под конец работы приложения программа зависает, если не вызвать <code>Dispose</code>, хотя... в этом случае должен отработать финализатор.</p>

<p>Неужели у этого класса забаженный финализатор?</p>

<p><strong>UPD</strong></p>

<p>Стека нет, так как программа останавливается в конце блока Main</p>

<p>Я заметил, что такое происходит если запустить 2 раза подряд программу.</p>

<p>Первый раз нормально отрабатывает, запускаю второй раз и зависает.</p>

<p>Минимальный код:</p>

<pre><code>class Converter
{
        private static readonly ILog _log = LogManager.GetLogger(typeof(DbConverter));
        private OleDbConnection _conn;
        private DbDictionary _dbDict;
         public Converter(string pathToDb, string pathToDict)
        {
            _conn = DbHelper.GetAccessConnection(pathToDb);
            _dbDict = new DbDictionary(pathToDict);
            _conn.Open();
        }

        void DoWork(){
        //Какие-то последовательные запросы через Dapper
        }


}
</code></pre>

<p>Класс DbDictionary по сути, тоже самое, что и Converter, т.е класс с <code>OleDbConnection</code> и одним методом <code>FindValue</code>.</p>
