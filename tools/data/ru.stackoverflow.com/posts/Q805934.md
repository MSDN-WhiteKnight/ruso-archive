---
title: "Обход объединенных ячеек в Word"
se.owner.user_id: 32793
se.owner.display_name: "iluxa1810"
se.owner.link: "https://ru.stackoverflow.com/users/32793/iluxa1810"
se.link: "https://ru.stackoverflow.com/questions/805934/%d0%9e%d0%b1%d1%85%d0%be%d0%b4-%d0%be%d0%b1%d1%8a%d0%b5%d0%b4%d0%b8%d0%bd%d0%b5%d0%bd%d0%bd%d1%8b%d1%85-%d1%8f%d1%87%d0%b5%d0%b5%d0%ba-%d0%b2-word"
se.question_id: 805934
se.post_type: question
se.score: 3
---
<p>В общем, в продолжение своей предыдущей темы по парсингу таблиц Word'a с помощью interop я столкнулся с объединенными ячейками.</p>

<p>Как я могу узнать на сколько ячеек произошло объединение, что бы я мог размножить F3 на N строчек?</p>

<p><a href="https://i.stack.imgur.com/61hjy.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/61hjy.png" alt=""></a></p>

<p>Капался в дебаггере в поисках нужного свойства, но что-то не нашел... Да и в интернете поголовно пишут, что такого свойства нет</p>

<p><strong>UPD 1</strong></p>

<p>На одном из ресурсов подкинули вот такую идею(Код на VBA, но легко переписывается на C#):</p>

<pre class="lang-vb prettyprint-override"><code>Sub ParseInExcel()
    Dim doc As Document, tbl As Table, eObj, eWbk, eWst, eRng, eCell
    Dim i As Long, j As Long
    Set doc = ThisDocument
    Set tbl = doc.Tables(1)
    tbl.Range.Copy
    Set eObj = CreateObject("Excel.Application")
    Set eWbk = eObj.Workbooks.Add
    Set eWst = eWbk.Sheets(1)
    eWst.Paste
    Set eRng = eWst.Cells(1).CurrentRegion
    For i = 1 To eRng.Rows.Count
        For j = 1 To eRng.Columns.Count
            Set eCell = eRng.Cells(i, j)
            If eCell.MergeCells Then
                Debug.Print eCell.MergeArea.Cells(1).Value &amp; " ";
            Else
                Debug.Print eCell.Value &amp; " ";
            End If
        Next
        Debug.Print
    Next
    eWbk.Saved = True
    eWbk.Close
    Set eWbk = Nothing
    eObj.Quit
    Set eObj = Nothing
End Sub
</code></pre>

<p>Смысл в том, что из Word все копипастится в Excel, а там уже появляются свойства, которые показывают объединение ячеек-<code>MergeRange</code>. Проблема в том, что будет занят буфер обмена(самое проблемное на мой взгляд, так как не смогу работать за ПК в момент работы программы иначе покалечу буфер), а так же в том, что подключается второй всадник апокалипсиса-Excel.</p>

<p>Если Excel знает, как представить таблицу из Word и создать свойства, которые показывают, что некая зона объединена, то значит должен иметься какой-то однозначный алгоритм для вычисления этого средствами Word'a.</p>

<p>Даже при сохранении в html-формате пишется кол-во объединенных колонок и строк.</p>

<p><strong>UPD 2</strong></p>

<p>По объединенным строкам я нашел решение, но по колонкам нет. Накидал <a href="https://ru.stackoverflow.com/a/808073/32793">свое решение</a>, но не думаю, что оно универсально. </p>

<p>Может у кого-то есть еще идеи?</p>

<p>P.S Interop не принципиален, но в приоритете, так как много кода на нем нарисовал.</p>

<p>Если есть решение например для *.DOCX, то я могу сменить формат.</p>
