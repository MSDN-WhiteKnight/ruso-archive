---
title: "Answer 758216"
se.owner.user_id: 32793
se.owner.display_name: "iluxa1810"
se.owner.link: "https://ru.stackoverflow.com/users/32793/iluxa1810"
se.answer_id: 758216
se.question_id: 758190
se.post_type: answer
se.score: 9
se.is_accepted: False
---
<p>Если вы откроете диспетчер задач, то увидите владельца процесса => следуя этому <a href="https://stackoverflow.com/questions/777548/how-do-i-determine-the-owner-of-a-process-in-c">ответу</a></p>

<p>Можно получить владельца процесса через WMI:</p>

<pre><code>public string GetProcessOwner(int processId)
{
    string query = "Select * From Win32_Process Where ProcessID = " + processId;
    ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);
    ManagementObjectCollection processList = searcher.Get();

    foreach (ManagementObject obj in processList)
    {
        string[] argList = new string[] { string.Empty, string.Empty };
        int returnVal = Convert.ToInt32(obj.InvokeMethod("GetOwner", argList));
        if (returnVal == 0)
        {
            // return DOMAIN\user
            return argList[1] + "\\" + argList[0];
        }
    }

    return "NO OWNER";
}

public string GetProcessOwner(string processName)
{
    string query = "Select * from Win32_Process Where Name = \"" + processName + "\"";
    ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);
    ManagementObjectCollection processList = searcher.Get();

    foreach (ManagementObject obj in processList)
    {
        string[] argList = new string[] { string.Empty, string.Empty };
        int returnVal = Convert.ToInt32(obj.InvokeMethod("GetOwner", argList));
        if (returnVal == 0)
        {
            // return DOMAIN\user
            string owner = argList[1] + "\\" + argList[0];
            return owner;       
        }
    }

    return "NO OWNER";
}
</code></pre>

<p>Это более лучшее решение, чем явно перечислять системные процессы, которые могут добавлять при установке спец. компонентов=> список составить тяжело.</p>

<p>Как меня поправляют в комментариях, есть еще всякие сервисы, где отсутствует учетка, так же есть некотые системные учетки, например MS SQL работает из специфичной учетки, если я не ошибаюсь.</p>
