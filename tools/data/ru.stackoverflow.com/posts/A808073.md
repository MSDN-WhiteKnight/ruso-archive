---
title: "Answer 808073"
se.owner.user_id: 32793
se.owner.display_name: "iluxa1810"
se.owner.link: "https://ru.stackoverflow.com/users/32793/iluxa1810"
se.answer_id: 808073
se.question_id: 805934
se.post_type: answer
se.score: 0
se.is_accepted: False
---
<p>Поиски привели меня на <a href="https://wordmvp.com/FAQs/MacrosVBA/GetRowColSpan.htm" rel="nofollow noreferrer">сайт</a>, где я нашел такое решение для определения объеденных строчек:</p>

<pre><code>int GetRowSpan(Cell cell)
{
    cell.Select();
    return (int)_wordApp.Selection.Information[WdInformation.wdEndOfRangeRowNumber] - (int)_wordApp.Selection.Information[WdInformation.wdStartOfRangeRowNumber] + 1;
}
</code></pre>

<p>К сожалению, ничего подобного я не нашел для объеденных колонок...</p>

<p>Написал свое решение, но не думаю, что оно универсальное:</p>

<pre><code>int GetColumnSpan(WordTable table, Cell cell)
    {
        var columnIndex = cell.ColumnIndex;
        var etalonSize = table.Cell(1, columnIndex).Width;
        if (cell.Width - etalonSize &lt; 0.5)
        {
            return 1;
        }
        var curWidth = cell.Width;
        var mergCount = 1;
        while (curWidth - etalonSize &gt; 0.5)
        {
            curWidth -= etalonSize;
            mergCount++;
        }
        return mergCount;
    }
</code></pre>

<p>Суть в том, что на вход я подаю эталонную ширину ячейки, а затем сравниваю ее с текущей. Если ширина болье => ячейка объеденена...</p>

<p>Если у кого-то есть мысли лучше, то пишите.</p>
