{"tags":["c#","многопоточность","консоль","xna"],"owner":{"reputation":159,"user_id":286844,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/956d24631f42fa34bb9309300bdaaf0c?s=128&d=identicon&r=PG&f=1","display_name":"Poul Shipilov","link":"https://ru.stackoverflow.com/users/286844/poul-shipilov"},"is_answered":true,"view_count":226,"accepted_answer_id":801004,"answer_count":2,"score":2,"last_activity_date":1521605127,"creation_date":1521042736,"last_edit_date":1521605127,"question_id":798256,"link":"https://ru.stackoverflow.com/questions/798256/%d0%9e%d1%88%d0%b8%d0%b1%d0%ba%d0%b8-%d0%bf%d1%80%d0%b8-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b5-%d1%81-%d0%ba%d0%be%d0%bd%d1%81%d0%be%d0%bb%d1%8c%d1%8e-%d0%b2-%d0%be%d1%82%d0%b4%d0%b5%d0%bb%d1%8c%d0%bd%d0%be%d0%bc-%d0%bf%d0%be%d1%82%d0%be%d0%ba%d0%b5","title":"Ошибки при работе с консолью в отдельном потоке","body":"<p>Мне нужно, чтобы в моем приложении открывалась консоль (оно не консольное xD). Я создаю поток, который должен открыть консоль. Но после открытия, во-первых, не работают команды <code>Console.WriteLine()</code>, иногда выдает ошибку <em>Неверный дескриптор</em> на <code>Console.Readline()</code> и <code>Console.Clear()</code> (другие пока не использовал), еще при втором запуске не дает печатать текст. Помогите мне сделать так, чтобы в этом потоке консоль работала как в \"Консольном приложении\".\nВот код:</p>\n\n<pre><code>public static class CMD\n    {\n        private static string InPut;\n        private static bool StopConsole = false;\n        private static bool StartConsole = false;\n        public static void Console()\n        {\n            StartConsole = true;\n            if (AllocConsole())\n            {\n                System.Console.WriteLine(\"Для выхода наберите exit\");\n                InPut = null;\n                while (true)\n                {                    \n                    InPut = System.Console.ReadLine();\n                    if (InPut == \"exit\")\n                        break;\n                    switch (InPut)\n                    {\n                        case \"cls\":\n                            System.Console.Clear();\n                            break;\n                        default:\n                            System.Console.WriteLine(\"Команда не найдена\\n\");\n                            break;\n                    }\n                }\n                FreeConsole();\n                StopConsole = true;\n            }\n            StartConsole = false;\n        }\n        public static void SetConsole()\n        {\n            while (true)\n                if (Keyboard.GetState().IsKeyDown(Keys.LeftControl) &amp;&amp; Keyboard.GetState().IsKeyDown(Keys.S) &amp;&amp; !StartConsole)\n                {\n                    Thread ConsoleThread = new Thread(Console);\n                    ConsoleThread.Start();\n                    if (StopConsole)\n                    {\n                        ConsoleThread.Abort();\n                        StartConsole = false;\n                    }\n                }\n        }\n\n\n\n        [DllImport(\"kernel32.dll\", SetLastError = true)]\n        [return: MarshalAs(UnmanagedType.Bool)]\n        private static extern bool AllocConsole();\n\n        [DllImport(\"kernel32.dll\", SetLastError = true)]\n        [return: MarshalAs(UnmanagedType.Bool)]\n        private static extern bool FreeConsole();\n    }\n</code></pre>\n"}