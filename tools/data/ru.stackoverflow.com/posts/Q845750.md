---
title: "Перехват http-трафика"
se.owner.user_id: 247831
se.owner.display_name: "Александр"
se.owner.link: "https://ru.stackoverflow.com/users/247831/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80"
se.link: "https://ru.stackoverflow.com/questions/845750/%d0%9f%d0%b5%d1%80%d0%b5%d1%85%d0%b2%d0%b0%d1%82-http-%d1%82%d1%80%d0%b0%d1%84%d0%b8%d0%ba%d0%b0"
se.question_id: 845750
se.post_type: question
se.score: 1
---
<p>Подскажите пожалуйста, как перехватывать http-запросы в c#? <strong>Мне нужно просто знать, на какие сайты переходили и всё.</strong></p>

<hr>

<p>Пробовал с помощью SharpPcap перехватывать пакеты, но я не знаю, что с ними делать дальше. Вот код:</p>

<pre><code>// Когда приходит пакет, вызывается это событие
private static void Program_OnPacketArrival(object sender, CaptureEventArgs e)
{
    Packet packet = Packet.ParsePacket(e.Packet.LinkLayerType, e.Packet.Data);
    TcpPacket tcp = (TcpPacket)packet.Extract(typeof(TcpPacket));

    if (tcp != null)
    {
        byte[] data = tcp.PayloadData;
        string res = Encoding.UTF8.GetString(data);
        Console.WriteLine(res);
    }
}
</code></pre>

<p>Но этот код печатает GET заголовки, и то только тогда, когда сайт не https. Надеюсь я понятно всё спросил. Спасибо.</p>
