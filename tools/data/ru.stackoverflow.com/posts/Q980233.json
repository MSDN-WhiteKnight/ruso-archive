{"tags":["c#","winforms","datagridview","drag-n-drop"],"owner":{"reputation":39,"user_id":302041,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Jhdq6.png?s=128&g=1","display_name":"CuteInsider","link":"https://ru.stackoverflow.com/users/302041/cuteinsider"},"is_answered":true,"view_count":29,"accepted_answer_id":980839,"answer_count":1,"score":1,"last_activity_date":1557833645,"creation_date":1557567593,"last_edit_date":1557833645,"question_id":980233,"link":"https://ru.stackoverflow.com/questions/980233/%d0%92%d1%8b%d0%b1%d1%80%d0%b0%d1%82%d1%8c-%d1%81%d1%82%d1%80%d0%be%d0%ba%d1%83-%d0%b2-%d0%ba%d0%be%d1%82%d0%be%d1%80%d1%83%d1%8e-%d0%bd%d0%b5%d0%be%d0%b1%d1%85%d0%be%d0%b4%d0%b8%d0%bc%d0%be-%d0%bf%d0%b5%d1%80%d0%b5%d0%bd%d0%b5%d1%81%d1%82%d0%b8-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8e-%d0%bd%d0%b5%d0%bf%d0%be%d1%81%d1%80%d0%b5%d0%b4%d1%81%d1%82%d0%b2%d0%b5%d0%bd%d0%bd%d0%be-%d0%b2%d0%be-%d0%b2%d1%80%d0%b5","title":"Выбрать строку, в которую необходимо перенести информацию непосредственно во время перетаскивания","body":"<p>Здравствуйте    ( ´ ▽ ` )ﾉ</p>\n\n<h2><strong>Цель:</strong></h2>\n\n<p>При перетаскивании объекта из одного DataGridView в другой, во время перетаскивания указать строку, в которую мы хотим переместить объект<br></p>\n\n<hr>\n\n<h2><strong>Что я пробовал</strong></h2>\n\n<p>Методы ниже выполняются в обработчике событий принимающего DataGridView</p>\n\n<ol>\n<li><p>Событие <code>MouseMove(object sender, MouseEventArgs e)</code></p>\n\n<pre><code>private void dtDinnerType_MouseMove(object sender, MouseEventArgs e)\n{\n    if ((e.Button &amp; MouseButtons.Left) == MouseButtons.Left)\n    {\n        DataGridView.HitTestInfo hit = dtDinnerType.HitTest(e.X, e.Y);\n        if (hit.Type == DataGridViewHitTestType.Cell)\n        {\n            dtDinnerType.Rows[hit.RowIndex].Selected = true;\n        }\n    }\n}\n</code></pre>\n\n<p>Данный метод выполнял свою работу как надо, до тех пор пока я не зажимал левую \nкнопку мыши (Перетаскивал), после он просто не выполняет событие <code>MouseMove</code>, \nкогда я вожу по объекту с зажатой кнопкой мыши, стоит мне отжать мышь и событие \nвыполняет свою работу, но не проходит проверку в методе, что правильно<br><br></p></li>\n<li><p>Событие <code>CellMouseEnter(object sender, DataGridViewCellEventArgs e)</code></p>\n\n<pre><code>private void dtDinnerType_CellMouseEnter(object sender, DataGridViewCellEventArgs e)\n{\n    if ((MouseButtons &amp; MouseButtons.Left) == MouseButtons.Left)\n    {\n        DataGridView.HitTestInfo hit = dtDinnerType.HitTest(Cursor.Position.X, Cursor.Position.Y);\n        if (hit.Type == DataGridViewHitTestType.Cell)\n        {\n            dtDinnerType.Rows[hit.RowIndex].Selected = true;\n        }\n    }\n}\n</code></pre>\n\n<p>Проблемам аналогична с методом выше<br><br></p></li>\n<li><p>Событие <code>DragDrop(object sender, DragEventArgs e)</code></p>\n\n<pre><code>private void dtDinnerType_DragDrop(object sender, DragEventArgs e)\n{\n    DataGridView.HitTestInfo hit = dtDinnerType.HitTest(e.X, e.Y);\n    if (hit.Type == DataGridViewHitTestType.Cell)\n    {\n        //Работа со строкой на которую мы навели \n    } \n}\n</code></pre>\n\n<p>Проблема в этом методе мне непонятна, <code>dtDinnerType.HitTest(e.X, e.Y)</code>, в данном случае этот метод возвращает:<br> <code>hit: {{ Type:None, Column:-1, Row:-1 }}</code> и <code>hit.Type == None</code><br>\nВедь при отпускании мы находимся над строкой в DGV и тест должен быть положительный </p></li>\n</ol>\n"}