---
title: "Как программно получить список всех свойств устройства в Device Manager&#39;e?"
se.owner.user_id: 226766
se.owner.display_name: "user226766"
se.owner.link: "https://ru.stackoverflow.com/users/226766/user226766"
se.link: "https://ru.stackoverflow.com/questions/752276/%d0%9a%d0%b0%d0%ba-%d0%bf%d1%80%d0%be%d0%b3%d1%80%d0%b0%d0%bc%d0%bc%d0%bd%d0%be-%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b8%d1%82%d1%8c-%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d0%b2%d1%81%d0%b5%d1%85-%d1%81%d0%b2%d0%be%d0%b9%d1%81%d1%82%d0%b2-%d1%83%d1%81%d1%82%d1%80%d0%be%d0%b9%d1%81%d1%82%d0%b2%d0%b0-%d0%b2-device-managere"
se.question_id: 752276
se.post_type: question
se.score: 3
---
<p>Привет всем!</p>

<p>Возникла идея написать приложение на подобии <a href="http://nirsoft.net/utils/usb_devices_view.html" rel="nofollow noreferrer">USBDeview</a> (приложение, отображающее все подключенные на данный момент USB девайсы). Хочу также реализовать функционал включения/выключения USB устройства по расписанию (USBDeview тоже так умеет). Все манипуляции провожу через запросы к WMI . Столкнулся с рядом проблем:</p>

<ol>
<li>При подключении нового USB устройства появляются два девайса - USB Mass Storage Device и Disk Drive. Какое из включать/выключать, чтобы USB устройство правильно отключилось?</li>
<li>Запрос "select * from Win32_PnpEntity" возвращает довольно скудный набор свойств (например отсутствуют нужные мне параметры, такие как Matching device Id, Class, Is connected и т.д. - все эти параметры есть в Device Manager'e во вкладке Details). Отсюда вытекает вопрос. Как отобразить ВСЕ свойства, которые есть в Device Manager'e?
Небольшой пример кода на C#: </li>
</ol>

<p><pre>
    class Program
    {
        static void Main(string[] args)
        {
           ManagementObjectCollection collection;
            using (var searcher = new ManagementObjectSearcher(@"Select * From Win32_PnpEntity"))
                collection = searcher.Get();</p>

<code>        foreach (var device in collection)
        {
            Console.WriteLine("===================================");
            foreach (var prop in device.Properties)
                Console.WriteLine("\t{0} : {1}", prop.Name, prop.Value);
            Console.WriteLine("===================================");
        }

        collection.Dispose();

        Console.Read();
    }
</code></pre>

<p>
При подключении флешки появляется два новых устройства:</p>

<p>Disk Drive: 
<a href="https://i.stack.imgur.com/IhqDO.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/IhqDO.png" alt="diskdrive"></a></p>

<p>USB Mass Storage Device:
<a href="https://i.stack.imgur.com/qQ5Wu.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/qQ5Wu.png" alt="usb"></a></p>

<p>Мне же нужно получить список этих свойств: 
<a href="https://i.stack.imgur.com/gOcnA.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/gOcnA.png" alt="devicemanager"></a></p>

<p>Подскажите, пожалуйста, в каком направлении мне идти? </p>
