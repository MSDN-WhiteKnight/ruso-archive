---
title: "Answer 926514"
se.owner.user_id: 298154
se.owner.display_name: "NewView"
se.owner.link: "https://ru.stackoverflow.com/users/298154/newview"
se.answer_id: 926514
se.question_id: 926467
se.post_type: answer
se.score: 0
se.is_accepted: False
---
<p>Решение все-же есть как очистить объект типа IEnumerable полученный через рефлексию.
Уверен, в нем наверняка есть подводные камни.. </p>

<p>Как это реализовать:</p>

<pre><code>    private Object GetIEnumerableEle(PropertyInfo p, ref bool IsIenumerable)
    {
        Type[] t0;
        Type t1 = ((p == null) ? null : p.PropertyType),
             t2, t3;
        Object ie = null;
        IsIenumerable = false;

        if ((t1 != null) &amp;&amp; (t1.IsGenericType))
        {
            t2 = p.PropertyType.GetGenericTypeDefinition();

            if ((t2 != null) &amp;&amp; ((t2 == typeof(List&lt;&gt;)) || (t2 == typeof(IEnumerable&lt;&gt;))))
            {
                IsIenumerable = true;

                if (
                    ((t0 = t1.GetGenericArguments()) == null) ||
                    (t0[0] == null)
                   )
                    return ie;

                if ((t3 = t2.MakeGenericType(t0[0])) == null)
                    return ie;

                return Activator.CreateInstance(t3);
            }
        }
        return ie;
    }
</code></pre>

<p>Как этим пользоваться:</p>

<pre><code>    PropertyInfo[] p = ...;

    if (p[n].PropertyType.IsGenericType)
    {
        bool IsIenumerable = false;
        Object ie = GetIEnumerableEle(p[n], ref IsIenumerable);

        if ((IsIenumerable) &amp;&amp; (ie != null))
            p[n].SetValue(obj, ie, null);
    }
</code></pre>

<p>Ларчик то несложно открывался :)</p>
