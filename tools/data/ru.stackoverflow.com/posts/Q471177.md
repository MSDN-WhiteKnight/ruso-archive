---
title: "Как узнать тип стороннего приложения C#?"
se.owner.user_id: 193362
se.owner.display_name: "imlejn"
se.owner.link: "https://ru.stackoverflow.com/users/193362/imlejn"
se.link: "https://ru.stackoverflow.com/questions/471177/%d0%9a%d0%b0%d0%ba-%d1%83%d0%b7%d0%bd%d0%b0%d1%82%d1%8c-%d1%82%d0%b8%d0%bf-%d1%81%d1%82%d0%be%d1%80%d0%be%d0%bd%d0%bd%d0%b5%d0%b3%d0%be-%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d1%8f-c"
se.question_id: 471177
se.post_type: question
se.score: 2
---
<p>Как узнать тип стороннего приложения на C# - Консольное приложения или Windows Forms? Полез в Reflection - ничего не нашёл.</p>

<p><strong>UPD:</strong></p>

<p>Спасибо @PavelMayorov за подсказку, решение получилось таким:</p>

<pre><code>using (Stream Stream = new FileStream(@"путь к файлу",FileMode.Open))
{
    using (BinaryReader BReader = new BinaryReader(Stream))
    {
        Stream.Position = 0x3C;
        uint peHeader = BReader.ReadUInt32();
        Stream.Position = peHeader+0x5C;
        ushort machine = BReader.ReadUInt16();
        Console.WriteLine(machine);
    }
} 
</code></pre>
