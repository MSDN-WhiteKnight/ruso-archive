---
title: "Как открыть файл с помощью команды приложения?"
se.owner.user_id: 236603
se.owner.display_name: "Vitokhv"
se.owner.link: "https://ru.stackoverflow.com/users/236603/vitokhv"
se.link: "https://ru.stackoverflow.com/questions/767263/%d0%9a%d0%b0%d0%ba-%d0%be%d1%82%d0%ba%d1%80%d1%8b%d1%82%d1%8c-%d1%84%d0%b0%d0%b9%d0%bb-%d1%81-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e-%d0%ba%d0%be%d0%bc%d0%b0%d0%bd%d0%b4%d1%8b-%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d1%8f"
se.question_id: 767263
se.post_type: question
se.score: 1
---
<p>Как открыть файл, чтобы он запускался через приложение? При условии, что реестр использует обязательный путь к приложению:</p>

<p><code>HKEY_CLASSES_ROOT\exefile\shell\open\command</code>
<a href="https://i.stack.imgur.com/11MBq.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/11MBq.png" alt="введите сюда описание изображения"></a>
<a href="https://i.stack.imgur.com/4Tbic.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/4Tbic.png" alt="введите сюда описание изображения"></a></p>

<p>Задача состоит в том, чтобы через приложение "А" передать параметры запуска <code>"%1" %*</code> любому файлу, который принудительно станет запускаться через это приложение "А".</p>

<p>Допустим, мы переносим файл на приложение, или запускаем его двойным кликом по файлу, приложение получает от файла аргументы в виде пути к файлу, если первое условие пропускается, файл "В" должен получить от приложения "А" аргументы запуска <code>"%1" %*</code>и запуститься.</p>

<pre><code>static void Main(string[] args)
{
    if (args.Any() &amp;&amp; BlockChecker.IsBlocked(args[0]) == true)
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }
    else if (args.Any())
    {
        ProcessStartInfo psi = new ProcessStartInfo((args[0]), @"%1 %*");
        psi.WindowStyle = ProcessWindowStyle.Normal;
        psi.RedirectStandardOutput = true;
        psi.UseShellExecute = false;
        psi.CreateNoWindow = true;
        Process.Start(psi);
        Application.Exit();
    }
}
</code></pre>

<p>Вышеупомянутый код работает, но не может принимать аргументы от ярлыков, все еще есть ошибки при запуске программ (Discord) и (браузер Opera) т.к. они используют ярлык с аргументами запуска: <code>C:\Users\User\AppData\Local\Discord\Update.exe --processStart Discord.exe</code></p>

<p>Эта проблема относится ко всем ярлыкам или программам с параметрами запуска...</p>

<p>Подробнее о классе BlockChecker.cs: <a href="https://ru.stackoverflow.com/questions/765571">#url</a></p>
