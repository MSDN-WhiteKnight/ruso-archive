---
title: "Разбор dll и добавление их в программу"
se.owner.user_id: 264042
se.owner.display_name: "Arasfon"
se.owner.link: "https://ru.stackoverflow.com/users/264042/arasfon"
se.link: "https://ru.stackoverflow.com/questions/794122/%d0%a0%d0%b0%d0%b7%d0%b1%d0%be%d1%80-dll-%d0%b8-%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8%d1%85-%d0%b2-%d0%bf%d1%80%d0%be%d0%b3%d1%80%d0%b0%d0%bc%d0%bc%d1%83"
se.question_id: 794122
se.post_type: question
se.score: 1
---
<p>Есть программа, которая должна выполнять очень сложную функцию (прошу помочь в её реализации):</p>

<blockquote>
  <p>Есть dll. В ней лежит текстовый файл с примерно такой структурой:</p>
</blockquote>

<pre><code>{
    MainWindow="MainWindow.xaml"
    Code="MainWindow.xaml.cs"
    Pattern=WPFStandart
}
</code></pre>

<blockquote>
  <p>Запарсить я его смогу, но мне нужно как-то использовать окно с логикой, описанное в этой dll, причём dll должна лежать в папке с проектом, название у dll всегда разное (знаю как узнать его), и через Visual Studio в зависимости не добавишь, из-за названия и всегда разного содержимого (разрабы разные, а точнее их команды).</p>
</blockquote>

<p>Вся информация изначально хранится внутри dll в файле pkginfo.txt, который лежит в корне с проектом (компилируется как внедряемый при сборке ресурс), желательно, чтобы окно открывалось без локального копирования ("разархивации длл-ки").</p>

<p><strong>Update</strong>
Я нашёл способ с </p>

<pre><code>[DllImport("name.dll")]
public static extern void VoidInDll();
</code></pre>

<p>Но у меня название открываемого DLL задаёт пользователь, а <code>DllImport</code> принимает только константы. 
Жду варианты...</p>
