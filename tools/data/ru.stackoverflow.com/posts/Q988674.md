---
title: "C# WPF Отображение на форме хода установки msi установщика"
se.owner.user_id: 339447
se.owner.display_name: "patrik"
se.owner.link: "https://ru.stackoverflow.com/users/339447/patrik"
se.link: "https://ru.stackoverflow.com/questions/988674/c-wpf-%d0%9e%d1%82%d0%be%d0%b1%d1%80%d0%b0%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bd%d0%b0-%d1%84%d0%be%d1%80%d0%bc%d0%b5-%d1%85%d0%be%d0%b4%d0%b0-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b8-msi-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d1%89%d0%b8%d0%ba%d0%b0"
se.question_id: 988674
se.post_type: question
se.score: 2
---
<p>Через мою программу запускается msi установщик. Есть ли способ отследить ход установки и вывести его на форму?</p>

<pre><code>public void install_uninstall(string _targetIpAddress)
{
    //string _targetIpAddress = (string)PC;
    string[] directum = { "1.msi", "2.msi", "3.msi" };

    string retVal = "";

    ConnectionOptions options = new ConnectionOptions();
    //options.Username = @"domain\username";
    //options.Password = "password";
    ManagementScope scope = new ManagementScope(("\\\\" + _targetIpAddress + "\\root\\cimv2"), options);
    scope.Connect();



    ManagementObjectSearcher searcher;
    SelectQuery query;
    EnumerationOptions enumOptions;
    ManagementPath p = new ManagementPath("Win32_Product");
    ManagementClass classInstance = new ManagementClass(scope, p, null);
    ManagementBaseObject inParams = classInstance.GetMethodParameters("Install");
    ManagementBaseObject outParams;
    inParams["AllUsers"] = true;
    inParams["Options"] = string.Empty;

    if (programs.Contains("1"))
    {
        thisTime = DateTime.Now;
        percent = 100 / 6F;

        Dispatcher.BeginInvoke(new ThreadStart(delegate { text_install.Document.Blocks.Add(new Paragraph(new Run(thisTime + " Удаление..."))); ProgressBar.IsIndeterminate = false; PercentText.Visibility = Visibility.Visible; }));


    thisTime = DateTime.Now;
    Dispatcher.BeginInvoke(new ThreadStart(delegate { text_install.Document.Blocks.Add(new Paragraph(new Run(thisTime + " Установка..."))); }));

    foreach (var item in dir)
    {
        inParams["PackageLocation"] = @"\\" + _targetIpAddress + @"\d$\Dir\" + item;
        outParams = classInstance.InvokeMethod("Install", inParams, null);
        retVal = outParams["ReturnValue"].ToString();

        retVal_install(dir, inParams, retVal, item);
    }
}
</code></pre>
