{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":1,"last_activity_date":1538975681,"creation_date":1538975681,"answer_id":890345,"question_id":889915,"body":"<p>Вы предполагаете, что наличие в таблице NULL приведет к получению через ExecuteScalar значения null, но это не так. На самом деле, OLE DB при этом возвращает особое значение DBNull. Также, нет необходимости выполнять запрос два раза. Замените</p>\n\n<pre><code>if (IdCount.ExecuteScalar() != null)  max = Convert.ToInt32(IdCount.ExecuteScalar());\n</code></pre>\n\n<p>на</p>\n\n<pre><code>object data = IdCount.ExecuteScalar();\nif(data != null &amp;&amp; data != DBNull.Value) max = Convert.ToInt32(data);\n</code></pre>\n"}