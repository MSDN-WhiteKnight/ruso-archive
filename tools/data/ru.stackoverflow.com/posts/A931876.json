{"owner":{"reputation":6074,"user_id":17974,"user_type":"registered","accept_rate":83,"profile_image":"https://www.gravatar.com/avatar/e65c04f96eb45f1dec239d85c76d6afa?s=128&d=identicon&r=PG","display_name":"nick_n_a","link":"https://ru.stackoverflow.com/users/17974/nick-n-a"},"is_accepted":false,"score":2,"last_activity_date":1547480595,"last_edit_date":1547480595,"creation_date":1547453486,"answer_id":931876,"question_id":931706,"body":"<p>Для вставки текста RTF в шаблон я использовал такое приведение</p>\n\n<pre><code>  public static string toRTF(string value)\n        {  /*Конвертирует текст, в текст пригодный для RTF документа */\n            //                                                                                                             FF\n            string syms = @\"ЎўЈЈ¤Ґ¦§Ё©Є«¬­®Ї°±Ііґµ¶•ё№є»јЅѕїАБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдежзийклмнопрстуфхцчшщъыьэюя\";                      \n            string rep_1 = @\"0123456789abcdef\";\n            int j = 0;\n            int k = 0;\n            while (j &lt; value.Length)\n            {\n                if (syms.IndexOf(value[j]) &gt;= 0)\n                {\n                    k = syms.IndexOf(value[j]);\n                    value = value.Replace(value[j].ToString(), \"\\\\'\" + rep_1[(k / 16) + 10].ToString() + rep_1[k &amp; 15].ToString());\n                };\n                j++;\n            };\n            value = value.Replace(\"\\\\n\", \"\\\\par;\");\n            return value;\n        }\n</code></pre>\n\n<p>Да.. пожалуй хранить и копировать таблицу сложно... вариант 2 - без таблицы</p>\n\n<pre><code>  public static string toRTF(string value)\n        {  /*Конвертирует текст, в текст пригодный для RTF документа */\n            byte[] t = new byte[1];\n            int j = 0;                \n            while (j &lt; value.Length)\n            {\n                if (value[j] &gt;= '\\x7F')\n                {\n                    System.Text.Encoding.GetEncoding(1251).GetBytes(value,j,1,t,0);                      \n                    value = value.Replace(value[j].ToString(), \"\\\\'\" + t[0].ToString('x'));\n                };\n                j++;\n            };\n            value = value.Replace(\"\\\\n\", \"\\\\par;\");\n            return value;\n        }\n</code></pre>\n\n<p>Т.е. буква я маленькая имеет код  <code>\\'FF</code>. Плюс... шаблон должен содержать метку 1251, т.е. в файле с поддержкой 1251 заголовок должен быть такой</p>\n\n<pre><code> {\\rtf1\\adeflang1025\\ansi\\ansicpg1251\\\n</code></pre>\n\n<p>Еще я заменяю возврат каретки на <code>\\par;</code> потому что текст так переносится в rtf. </p>\n\n<p>Текст можно вообще не преобразовывать, оставить как есть и лишь перенести в кодировку 1251, если есть уверенность, что ваш файл будут открывать исключительно в среде windows. Некоторые \"неродные\" редакторы не понимают файлы без указанного перевода.</p>\n\n<p>P.S. RTF не самый простой формат, не могу рассказать подробно о его деталях. Приведенный код использую в одном из проэктов. Преобразование в heх можно реализовать лучше.. но так уже получилось - не само оптимально. В вики внизу есть ссылка на спецификацию <a href=\"http://ru.wikipedia.org/wiki/Rich_Text_Format\" rel=\"nofollow noreferrer\">http://ru.wikipedia.org/wiki/Rich_Text_Format</a>, если есть сложности - думаю спецификацикация даст ответ на ваши вопросы.</p>\n"}