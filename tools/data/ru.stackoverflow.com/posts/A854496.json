{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":3,"last_activity_date":1531558235,"creation_date":1531558235,"answer_id":854496,"question_id":854461,"body":"<p>Например с помощью <a href=\"https://docs.microsoft.com/en-us/windows/desktop/gdiplus/-gdiplus-flatapi-flat\" rel=\"nofollow noreferrer\">GDI+ Flat API</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;Windows.h&gt;\n\ntypedef struct _GdiplusStartupInput\n{\n    UINT32 GdiplusVersion;             // Must be 1  (or 2 for the Ex version)\n    void* DebugEventCallback; // Ignored on free builds\n    BOOL SuppressBackgroundThread;     // FALSE unless you're prepared to call \n                                       // the hook/unhook functions properly\n    BOOL SuppressExternalCodecs;       // FALSE unless you want GDI+ only to use\n                                       // its internal image codecs.\n} GdiplusStartupInput;\n\ntypedef struct _GdiplusStartupOutput\n{      \n    void* NotificationHook;\n    void* NotificationUnhook;\n} GdiplusStartupOutput;\n\nint _tmain(int argc, _TCHAR* argv[])\n{       \n\n  HANDLE g ;\n  int  (__stdcall *GdiplusStartup)(ULONG_PTR *,const GdiplusStartupInput *,GdiplusStartupOutput *);\n  int  (__stdcall *GdiplusShutdown)(ULONG_PTR *);  \n  int  (__stdcall *GdipLoadImageFromFile)(WCHAR* filename, void **image);\n  int  (__stdcall *GdipSaveImageToFile) (void *image,  WCHAR* filename, void* clsidEncoder,  void* encoderParams);\n  GdiplusStartupInput input = {1,0};\n  GdiplusStartupOutput output = {0};\n  ULONG_PTR gdiplusToken;\n  CLSID   encoderClsid ={0x557cf401,0x1a04,0x11d3,0x9a,0x73,0x00,0x00,0xf8,0x1e,0xf3,0x2e}; //image/jpeg\n  void* pImage=NULL;\n  int result;   \n\n  //загрузка указателей на функции\n  g= LoadLibraryA(\"gdiplus.dll\");\n  GdiplusStartup= (int  (__stdcall *)(ULONG_PTR *,const GdiplusStartupInput *,GdiplusStartupOutput *))GetProcAddress((HMODULE)g,\"GdiplusStartup\");\n  GdiplusShutdown= (int  (__stdcall *)(ULONG_PTR *))GetProcAddress((HMODULE)g,\"GdiplusShutdown\");\n  GdipLoadImageFromFile  = (int  (__stdcall *)(WCHAR* filename, void **image))GetProcAddress((HMODULE)g,\"GdipLoadImageFromFile\");\n  GdipSaveImageToFile  = (int  (__stdcall *) (void *image,  WCHAR* filename, void* clsidEncoder,  void* encoderParams))GetProcAddress((HMODULE)g,\"GdipSaveImageToFile\");\n\n  //инициализация GDI+\n  result = GdiplusStartup(&amp;gdiplusToken,&amp;input,&amp;output);\n  if(result != 0) {wprintf(L\"GdiplusStartup failed: error %d\\n\",result);getchar();return 1;}\n\n  //загрузка Image\n  result = GdipLoadImageFromFile(L\"d:\\\\image.bmp\",&amp;pImage);\n  if(result != 0) {wprintf(L\"GdipLoadImageFromFile failed: error %d\\n\",result);getchar();return 1;}\n\n  //сохранение Image\n  result = GdipSaveImageToFile(pImage,L\"d:\\\\image.jpg\",&amp;encoderClsid,NULL);  \n  if(result != 0) {wprintf(L\"GdipSaveImageToFile failed: error %d\\n\",result);getchar();return 1;}\n\n  wprintf(L\"Image saved successfully\\n\");\n  GdiplusShutdown(&amp;gdiplusToken);  \n\n  getchar();\n  return 0;\n}\n</code></pre>\n"}