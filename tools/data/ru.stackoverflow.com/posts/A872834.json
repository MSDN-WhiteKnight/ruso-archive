{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":0,"last_activity_date":1535096915,"creation_date":1535096915,"answer_id":872834,"question_id":872730,"body":"<ol>\n<li><p>Вы указываете в запросе имя файла, а нужно - имя листа</p></li>\n<li><p>Вы игнорируете все исключения, поэтому вы не можете даже увидеть сообщение об ошибке</p></li>\n</ol>\n\n<p>Вывести содержимое первого листа можно так:</p>\n\n<pre><code>OpenFileDialog openFileDialog1 = new OpenFileDialog();\nopenFileDialog1.Filter = \"XML Files (*.xml; *.xls; *.xlsx; *.xlsm; *.xlsb) |*.xml; *.xls; *.xlsx; *.xlsm; *.xlsb\";\nopenFileDialog1.FilterIndex = 3;\n\nopenFileDialog1.Multiselect = false;\nopenFileDialog1.InitialDirectory = @\"Desktop\";\n\nNullable&lt;bool&gt; result = openFileDialog1.ShowDialog();\nif (result == true)\n{\n    string pathName = openFileDialog1.FileName;\n    string fileName = System.IO.Path.GetFileNameWithoutExtension(openFileDialog1.FileName);\n    DataTable tbContainer = new DataTable();\n    string strConn = string.Empty;                    \n    string sheetName;\n\n    FileInfo file = new FileInfo(pathName);\n    if (!file.Exists) { throw new Exception(\"Error, file doesn't exists!\"); }\n    string extension = file.Extension;\n    switch (extension)\n    {\n        case \".xls\":\n            strConn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + pathName + \";Extended Properties='Excel 8.0;HDR=Yes;IMEX=1;'\";\n            break;\n        case \".xlsx\":\n            strConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + pathName + \";Extended Properties='Excel 12.0;HDR=Yes;IMEX=1;'\";\n            break;\n        default:\n            strConn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + pathName + \";Extended Properties='Excel 8.0;HDR=Yes;IMEX=1;'\";\n            break;\n    }\n    OleDbConnection cnnxls = new OleDbConnection(strConn);\n    using (cnnxls)\n    {\n        cnnxls.Open();\n\n        DataTable dtSchema = cnnxls.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new object[] { null, null, null, \"TABLE\" });\n        sheetName = dtSchema.Rows[0].Field&lt;string&gt;(\"TABLE_NAME\");                        \n\n        OleDbDataAdapter oda = new OleDbDataAdapter(string.Format(\"select * from [{0}]\", sheetName), cnnxls);\n        oda.Fill(tbContainer);\n    }\n\n    grid1.SetBinding(ItemsControl.ItemsSourceProperty, new Binding { Source = tbContainer });\n}\n</code></pre>\n"}