{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":1,"last_activity_date":1520682623,"creation_date":1520682623,"answer_id":796077,"question_id":795993,"body":"<p>Зачем искать какие-то библиотеки, если это легко можно реализовать с помощью стандартных средств WinForms: для построения графиков использовать Chart, а для вычисления выражений - скажем, JavaScript в невидимом WebBrowser. Конечно, можно задействовать средства динамической компиляции и вычислять выражения на C#, но, я думаю, с JavaScript попроще будет.</p>\n\n<p>Данный пример позволяет построить график функции, задаваемой любым JS-выражением:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Globalization;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Windows.Forms.DataVisualization.Charting;\n\nnamespace WinFormsTest\n{\n    public partial class Form1 : Form\n    {\n        protected WebBrowser wb;\n\n        public Form1()\n        {\n            InitializeComponent();\n\n            //инициализируем WebBrowser для вычислений\n            wb = new WebBrowser();\n            wb.ScriptErrorsSuppressed = true;//убрать на этапе отладки, чтобы видеть ошибки\n\n            //подгатавливаем JS-код для вычисления произвольного выражения\n            string js = @\"function execute(script){return eval(script);}\";\n\n            wb.DocumentText =\n                \"&lt;html&gt;&lt;head&gt;&lt;script type=\\\"text/javascript\\\"&gt;\"+\n                js+\"&lt;/script&gt;&lt;/head&gt;&lt;body&gt;Hello World&lt;/body&gt;&lt;/html&gt;\";\n        }\n\n        /// &lt;summary&gt;\n        /// Построение графика функции\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"ch\"&gt;Элемент управления Chart&lt;/param&gt;\n        /// &lt;param name=\"expression\"&gt;Математическое выражение функции от аргумента x в JavaScript-синтаксисе&lt;/param&gt;\n        /// &lt;param name=\"x_min\"&gt;Начало интервала значений аргумента&lt;/param&gt;\n        /// &lt;param name=\"x_max\"&gt;Конец интервала значений аргумента&lt;/param&gt;\n        /// &lt;param name=\"dx\"&gt;Шаг изменения аргумента&lt;/param&gt;\n        public void PlotGraph(Chart ch,string expression, double x_min, double x_max,double dx)\n        {\n            DataTable dt = new DataTable();\n            dt.Columns.Add(\"x\", typeof(Double));\n            dt.Columns.Add(\"y\", typeof(Double));\n\n            DataRow row;\n            double x;\n            string s;\n            object y;\n\n            //создаем культуру, совместимую с представлением чисел в JS\n            CultureInfo culture =\n                new CultureInfo( CultureInfo.CurrentCulture.Name);\n            culture.NumberFormat.NegativeSign = \"-\";\n            culture.NumberFormat.NumberDecimalSeparator = \".\";\n\n            //создаем таблицу значений\n            for (x = x_min; x &lt; x_max; x += dx)\n            {\n                row = dt.NewRow();\n                row[\"x\"] = x;\n\n                //подгатавливаем выражение для JS\n                s = \"var x=\" + x.ToString(culture) + \"; \" + expression + \";\";\n\n                //вычисляем выражение\n                y = wb.Document.InvokeScript(\"execute\",new object[] { s });\n\n                //преобразуем результат из строки в Double\n                row[\"y\"] = Convert.ToDouble(y, culture);\n                dt.Rows.Add(row);\n            }\n\n            //добавляем ряд в Chart\n            ch.DataSource = dt;\n            Series ser = new Series();\n            ser.Name = expression;\n            ser.XValueMember = \"x\";\n            ser.YValueMembers = \"y\";\n            ser.ChartType = SeriesChartType.Line;\n            ch.Series.Clear();\n            ch.Series.Add(ser);\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            //пример использования\n            PlotGraph(chart1, \"Math.sin(x)+0.3*Math.sin(15*x)\", 0.0, Math.PI * 2, 0.1);\n\n        }\n    }\n}\n</code></pre>\n\n<p>Если перенастроить WebBrowser на новую версию IE через реестр, можно и прямо в нем графики строить, через HTML5 Canvas.</p>\n"}