{"owner":{"reputation":2952,"user_id":22836,"user_type":"registered","accept_rate":79,"profile_image":"https://i.stack.imgur.com/EmmZL.png?s=128&g=1","display_name":"4per","link":"https://ru.stackoverflow.com/users/22836/4per"},"is_accepted":false,"score":-1,"last_activity_date":1473143963,"last_edit_date":1473143963,"creation_date":1449040499,"answer_id":471194,"question_id":471177,"body":"<p>Не скажу что способ хороший, но вдруг</p>\n\n<pre><code>    private void TestIsWindowExe()\n    {\n        MessageBox.Show(IsWindowExe(\"notepad.exe\", TimeSpan.FromSeconds(10)).ToString());\n        MessageBox.Show(IsWindowExe(\"cmd.exe\", TimeSpan.FromSeconds(10)).ToString());\n    }\n\n    /// &lt;summary&gt;\n    /// Проверка исполняемого файла, является ли он оконным\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"exepath\"&gt;путь к исполняемому файлу&lt;/param&gt;\n    /// &lt;param name=\"timeout\"&gt;время ожидания загрузки программы&lt;/param&gt;\n    /// &lt;returns&gt;Является ли оконным&lt;/returns&gt;\n    private bool IsWindowExe(string exepath, TimeSpan timeout)\n    {\n        var process = new System.Diagnostics.Process();\n        var startInfo = new System.Diagnostics.ProcessStartInfo();\n        startInfo.FileName = exepath;            \n        process.StartInfo = startInfo;\n        process.Start();\n        bool iswindow;\n        try\n        {               \n            if (process.WaitForInputIdle(Convert.ToInt32(timeout.TotalMilliseconds)))\n               iswindow = true;\n            else\n               throw new TimeoutException(\"Превышен таймаут ожидания загрузки процесса\");\n        }\n        catch (InvalidOperationException ex)\n        {\n            iswindow = false;\n        }\n        process.Kill();\n        return iswindow;\n    }\n</code></pre>\n"}