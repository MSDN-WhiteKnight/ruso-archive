---
title: "Answer 820004"
se.owner.user_id: 294528
se.owner.display_name: "Denys Save"
se.owner.link: "https://ru.stackoverflow.com/users/294528/denys-save"
se.answer_id: 820004
se.question_id: 818605
se.post_type: answer
se.score: 0
se.is_accepted: False
---
<p>Во-первых, в строке <code>for (int j = 0; i &lt; colCount; j++) {</code><br>
i заменить на j, иначе внутренний цикл никогда не закончится.</p>

<p>Во-вторых, проверить на согласованность ANSI / UNICODE. Я вижу Вы за LVM_GETITEMTEXT закрепили код LVM_GETITEMTEXTW (LVM_FIRST+0x115), т.е. UNICODE-вариант строки должен приходить. Для этого надо вызывать SendMessageW(), а не SendMessageA(). Проверьте, во что у Вас преобразуется SendMessage(): в SendMessageW() или в SendMessageA(). Я никогда не пробовал ANSI-функцией требовать UNICODE-строку и наоборот и не знаю,будет выполнено корректное преобразование или возвращена ошибка. Может с этим связана проблема.</p>
