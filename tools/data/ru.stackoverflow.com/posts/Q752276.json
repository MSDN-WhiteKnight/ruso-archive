{"tags":["c#","c++","wmi"],"owner":{"reputation":73,"user_id":226766,"user_type":"registered","accept_rate":50,"profile_image":"https://www.gravatar.com/avatar/923c4c9d9759b91bd6b4b2983bb2b954?s=128&d=identicon&r=PG&f=1","display_name":"user226766","link":"https://ru.stackoverflow.com/users/226766/user226766"},"is_answered":true,"view_count":887,"accepted_answer_id":753705,"answer_count":1,"score":3,"last_activity_date":1512401850,"creation_date":1512125357,"last_edit_date":1512367442,"question_id":752276,"link":"https://ru.stackoverflow.com/questions/752276/%d0%9a%d0%b0%d0%ba-%d0%bf%d1%80%d0%be%d0%b3%d1%80%d0%b0%d0%bc%d0%bc%d0%bd%d0%be-%d0%bf%d0%be%d0%bb%d1%83%d1%87%d0%b8%d1%82%d1%8c-%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba-%d0%b2%d1%81%d0%b5%d1%85-%d1%81%d0%b2%d0%be%d0%b9%d1%81%d1%82%d0%b2-%d1%83%d1%81%d1%82%d1%80%d0%be%d0%b9%d1%81%d1%82%d0%b2%d0%b0-%d0%b2-device-managere","title":"Как программно получить список всех свойств устройства в Device Manager&#39;e?","body":"<p>Привет всем!</p>\n\n<p>Возникла идея написать приложение на подобии <a href=\"http://nirsoft.net/utils/usb_devices_view.html\" rel=\"nofollow noreferrer\">USBDeview</a> (приложение, отображающее все подключенные на данный момент USB девайсы). Хочу также реализовать функционал включения/выключения USB устройства по расписанию (USBDeview тоже так умеет). Все манипуляции провожу через запросы к WMI . Столкнулся с рядом проблем:</p>\n\n<ol>\n<li>При подключении нового USB устройства появляются два девайса - USB Mass Storage Device и Disk Drive. Какое из включать/выключать, чтобы USB устройство правильно отключилось?</li>\n<li>Запрос \"select * from Win32_PnpEntity\" возвращает довольно скудный набор свойств (например отсутствуют нужные мне параметры, такие как Matching device Id, Class, Is connected и т.д. - все эти параметры есть в Device Manager'e во вкладке Details). Отсюда вытекает вопрос. Как отобразить ВСЕ свойства, которые есть в Device Manager'e?\nНебольшой пример кода на C#: </li>\n</ol>\n\n<p><pre>\n    class Program\n    {\n        static void Main(string[] args)\n        {\n           ManagementObjectCollection collection;\n            using (var searcher = new ManagementObjectSearcher(@\"Select * From Win32_PnpEntity\"))\n                collection = searcher.Get();</p>\n\n<code>        foreach (var device in collection)\n        {\n            Console.WriteLine(\"===================================\");\n            foreach (var prop in device.Properties)\n                Console.WriteLine(\"\\t{0} : {1}\", prop.Name, prop.Value);\n            Console.WriteLine(\"===================================\");\n        }\n\n        collection.Dispose();\n\n        Console.Read();\n    }\n</code></pre>\n\n<p>\nПри подключении флешки появляется два новых устройства:</p>\n\n<p>Disk Drive: \n<a href=\"https://i.stack.imgur.com/IhqDO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IhqDO.png\" alt=\"diskdrive\"></a></p>\n\n<p>USB Mass Storage Device:\n<a href=\"https://i.stack.imgur.com/qQ5Wu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qQ5Wu.png\" alt=\"usb\"></a></p>\n\n<p>Мне же нужно получить список этих свойств: \n<a href=\"https://i.stack.imgur.com/gOcnA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gOcnA.png\" alt=\"devicemanager\"></a></p>\n\n<p>Подскажите, пожалуйста, в каком направлении мне идти? </p>\n"}