{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":1,"last_activity_date":1549434900,"creation_date":1549434900,"answer_id":941357,"question_id":648178,"body":"<p>Для работы с Excel необходимо добавить ссылку на библиотеку типов \"Microsoft Excel ... Object Library\" (на вкладке COM в диалоге добавления ссылки):</p>\n\n<p><a href=\"https://i.stack.imgur.com/UR62f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UR62f.png\" alt=\"reference\"></a></p>\n\n<p>Пример подключения к запущенному экземпляру Excel и изменения значения ячейки в активном листе выглядит так:</p>\n\n<pre><code>using namespace System;\nusing namespace System::Runtime::InteropServices;\nusing namespace Microsoft::Office::Interop::Excel;\n\nint main(array&lt;System::String ^&gt; ^args)\n{\n    Application^ app = nullptr;\n    Object^ sheet = nullptr;\n    Worksheet^ ws = nullptr;\n    Range ^ cells = nullptr;\n    Range ^ cell = nullptr;\n\n    try {\n        //подключаемся к активному экземпляру Excel\n        app = (Application^)Marshal::GetActiveObject(\"Excel.Application\");\n        if (app == nullptr) throw gcnew ApplicationException(\"Fatal error: Running Excel instance not found!\");\n\n        //находим активный лист\n        sheet = app-&gt;ActiveSheet;\n        if (sheet == nullptr) throw gcnew ApplicationException(\"Fatal error: No active sheet in Excel!\");\n        ws = (Worksheet^)sheet;\n\n        //переходим в ячейку и устанавливаем ее значение\n        cells = ws-&gt;Cells;\n        cell = (Range^)cells-&gt;Item[1, 1];\n        cell-&gt;Activate();\n        cell-&gt;Value2 = gcnew String(\"Hello from C++/CLI!\");         \n    }\n    finally{\n        //очистка ресурсов\n        if (cell != nullptr)Marshal::ReleaseComObject(cell);\n        if (cells != nullptr)Marshal::ReleaseComObject(cells);\n        if (ws != nullptr)Marshal::ReleaseComObject(ws);\n        if (sheet != nullptr)Marshal::ReleaseComObject(sheet);\n        if (app != nullptr)Marshal::ReleaseComObject(app);\n    }\n\n    Console::WriteLine(\"All done! Press any key to exit\");\n    Console::ReadKey();\n    return 0;\n}\n</code></pre>\n"}