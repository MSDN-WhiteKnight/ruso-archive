---
title: "Exception from HResult 0x80072EE7"
se.owner.user_id: 312216
se.owner.display_name: "Liidia"
se.owner.link: "https://ru.stackoverflow.com/users/312216/liidia"
se.link: "https://ru.stackoverflow.com/questions/914946/exception-from-hresult-0x80072ee7"
se.question_id: 914946
se.post_type: question
se.score: 2
---
<p>Что может означать ошибка Exception from HResult 0x80072EE7? Где это можно подсмотреть?</p>

<p>Конкретно ошибка возникает при использовании библиотеки NAudio, при вызове MediaFoundationReader.Read. Ниже мой код.</p>

<pre><code>private void PlaceLinksIntoBuffer()
        {
            Uri baseUri = new Uri(InputPath);
            while (!IsStopped)
            {
                mediaSegmentUris.TryPeek(out IMediaSegment mediaSegment);
                if (mediaSegment == null) continue;

                int mediaSegmentApproximateDuration = Convert.ToInt32(Math.Ceiling(mediaSegment.Duration));

                if (IsBufferNearlyFull(mediaSegmentApproximateDuration))
                {
                    Thread.Sleep(500);
                }
                else
                {
                    mediaSegmentUris.TryDequeue(out mediaSegment);
                    Uri resourceUri = new Uri(baseUri, mediaSegment.Uri);

                    MediaFoundationReader mediaFoundationReader;
                    try
                    {
                        mediaFoundationReader =
                            new MediaFoundationReader(resourceUri.AbsoluteUri);
                        readUris.Enqueue(mediaSegment.Uri);
                    }
                    catch (Exception e)
                    {
                        brokenUris.Enqueue(mediaSegment.Uri);
                        continue;
                    }

                    byte[] buffer = new byte [mediaFoundationReader.WaveFormat.AverageBytesPerSecond *
                                              mediaSegmentApproximateDuration * 2];
                    int readBytes = mediaFoundationReader.Read(buffer, 0,
                        mediaFoundationReader.WaveFormat.AverageBytesPerSecond * mediaSegmentApproximateDuration * 2);

                    if (bufferedWaveProvider == null)
                    {
                        bufferedWaveProvider = new BufferedWaveProvider(mediaFoundationReader.WaveFormat)
                        {
                            BufferDuration = TimeSpan.FromSeconds(mediaSegmentApproximateDuration * 5)
                        };
                    }

                    bufferedWaveProvider.AddSamples(buffer, 0, readBytes);
                    mediaFoundationReader.Dispose();
                }
            }
        }
</code></pre>
