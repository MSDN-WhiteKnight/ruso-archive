---
title: "Answer 770679"
se.owner.user_id: 182825
se.owner.display_name: "AnT"
se.owner.link: "https://ru.stackoverflow.com/users/182825/ant"
se.answer_id: 770679
se.question_id: 770669
se.post_type: answer
se.score: 2
se.is_accepted: True
---
<p>Ну, вообще-то, <code>SetWindowLong</code> возвращает старое значение или <code>0</code> в случае ошибки. Однако если старое значение само по себе было <code>0</code> (что всегда имеет место при первом вызове с <code>GWL_USERDATA</code>), то будет возвращен, разумеется, именно <code>0</code> и это совсем не будет означать, что произошла ошибка.</p>

<p>Другими словами, в случае <code>GWL_USERDATA</code> по возвращенному значению <code>0</code> еще невозможно утверждать, что что-то не в порядке. Если вы подозреваете, что произошла ошибка - проверяйте <code>GetLastError</code>. (Однако я нигде не вижу гарантии, что <code>SetWindowLong</code> ставит last error в <code>0</code> в случае успеха, поэтому для надежности в таком случае имеет смысл предварительно сделать <code>SetLastError(0)</code> самому.)</p>

<p>Можете также для надежности сделать <code>GetWindowLong</code>, чтобы убедиться, что значение успешно записалось.</p>
