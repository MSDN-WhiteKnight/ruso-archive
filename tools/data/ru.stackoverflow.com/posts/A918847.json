{"owner":{"reputation":16137,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":2,"last_activity_date":1544593151,"creation_date":1544593151,"answer_id":918847,"question_id":918656,"body":"<p>У меня вот так работает</p>\n\n<p>C#:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Runtime.InteropServices;\nusing System.Text;\n\nnamespace AxTest\n{\n    [ProgId(\"AxTest.Class1\")]\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    [Guid(\"177E405F-0C29-4FB1-B55A-D5324EDE1E97\")]\n    [ComVisible(true)]\n    public class Class1 \n    {\n        public string Test(string x)\n        {\n            throw new Exception(\"Something bad happened!\");\n        }        \n\n    }\n}\n</code></pre>\n\n<p>JS:</p>\n\n<pre><code>&lt;html&gt;\n   &lt;head&gt;\n          &lt;title&gt;ActiveX test&lt;/title&gt;\n   &lt;/head&gt;\n   &lt;body&gt;\n        &lt;script type=\"text/jscript\"&gt;\n\n            try {\n\n                var customObject = new ActiveXObject(\"AxTest.Class1\");\n                var res = customObject.Test(\"Foo\");\n                alert(res);\n\n            } catch (ex) {\n\n                alert(\"Exception: \" + ex.message);\n\n            }\n\n\n        &lt;/script&gt;\n   &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Судя по сообщению, у вас исключение завернуто в TargetInvocationException. Чтобы получить нормальное сообщение об ошибке, вам надо его перехватывать и пробрасывать как свое исключение. Потому что в JS не достать InnerException.</p>\n"}