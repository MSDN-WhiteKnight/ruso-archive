{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":8,"last_activity_date":1502182625,"last_edit_date":1502182625,"creation_date":1502172453,"answer_id":703222,"question_id":701857,"body":"<p>как-то так</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Проверка корректности имени файла\n/// &lt;/summary&gt;\n/// &lt;param name=\"name\"&gt;Проверяемое имя&lt;/param&gt;        \npublic static bool ValidateFileName(string name)\n{\n    try\n    {\n        FileStream fs = File.Open(name, FileMode.Open);\n        if (fs != null) fs.Close();\n    }\n    catch (ArgumentException)\n    {\n        return false;//имя файла введено некорректно\n    }\n    catch (FileNotFoundException)\n    {                \n        return true;//имя файла введено корректно, но файл не существует\n    }\n    catch (IOException)\n    {\n        return true;//имя файла введено корректно, но файл недоступен\n    }\n    return true;//имя файла введено корректно\n}\n\n/// &lt;summary&gt;\n/// Проверка корректности имени файла с предложением исправленного имени\n/// &lt;/summary&gt;\n/// &lt;param name=\"name\"&gt;Проверяемое имя&lt;/param&gt;\n/// &lt;param name=\"corrected_name\"&gt;Предлагаемое исправленное имя&lt;/param&gt;        \npublic static bool ValidateFileName(string name,out string corrected_name)\n{\n    try\n    {\n        FileStream fs = File.Open(name, FileMode.Open);\n        if (fs != null) fs.Close();\n    }\n    catch (ArgumentException)//имя файла введено некорректно\n    {\n        //пытаемся исправить имя\n        char[] banned = System.IO.Path.GetInvalidFileNameChars();\n        StringBuilder sb = new StringBuilder();\n\n        foreach (char c in name)\n        {\n            if (banned.Contains(c)) sb.Append('_');\n            else sb.Append(c);\n        }\n\n        if (ValidateFileName(sb.ToString()) != false)\n        {\n            //удалось исправить имя\n            corrected_name = sb.ToString();\n        }\n        else corrected_name = \"\";//не удалось исправить имя (видимо это зарезервированное имя типа CON)\n        return false;\n    }\n    catch (FileNotFoundException)\n    {\n        corrected_name = \"\";\n        return true;//имя файла введено корректно, но файл не существует\n    }\n    catch (IOException)\n    {\n        corrected_name = \"\";\n        return true;//имя файла введено корректно, но файл недоступен\n    }\n    corrected_name = \"\";\n    return true;//имя файла введено корректно\n}\n</code></pre>\n\n<p>Но на самом деле, в настольных приложениях лучше так не делать, а использовать для ввода имени SaveFileDialog с включенной проверкой корректности. Так что это в основном для служб или веб-приложений.</p>\n"}