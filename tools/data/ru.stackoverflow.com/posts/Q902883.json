{"tags":["c#","config"],"owner":{"reputation":65,"user_id":307974,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/e00e774f1184e10d1205c8bfbd78bf1a?s=128&d=identicon&r=PG&f=1","display_name":"Андрей Кутасевич","link":"https://ru.stackoverflow.com/users/307974/%d0%90%d0%bd%d0%b4%d1%80%d0%b5%d0%b9-%d0%9a%d1%83%d1%82%d0%b0%d1%81%d0%b5%d0%b2%d0%b8%d1%87"},"is_answered":true,"view_count":62,"accepted_answer_id":903367,"answer_count":1,"score":2,"last_activity_date":1541581198,"creation_date":1541497636,"last_edit_date":1541581198,"question_id":902883,"link":"https://ru.stackoverflow.com/questions/902883/%d0%9f%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b5%d0%ba-%d0%b4%d1%80%d1%83%d0%b3%d0%be%d0%b3%d0%be-%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d1%8f-%d0%b8%d0%b7-app-config","title":"Получение настроек другого приложения из app.config","body":"<p>Имеется вот такой файл app.config в приложении \"A\":</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n&lt;configSections&gt;\n    &lt;sectionGroup name=\"userSettings\" type=\"System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" &gt;\n        &lt;section name=\"AutoCalcService.Properties.Settings\" type=\"System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" allowExeDefinition=\"MachineToLocalUser\" requirePermission=\"false\" /&gt;\n    &lt;/sectionGroup&gt;\n    &lt;sectionGroup name=\"applicationSettings\" type=\"System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" &gt;\n        &lt;section name=\"AutoCalcService.Properties.Settings\" type=\"System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" requirePermission=\"false\" /&gt;\n    &lt;/sectionGroup&gt;\n&lt;/configSections&gt;\n&lt;startup&gt;&lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.6.2\"/&gt;&lt;/startup&gt;\n&lt;userSettings&gt;\n    &lt;AutoCalcService.Properties.Settings&gt;\n        &lt;setting name=\"RoutesOptimize\" serializeAs=\"String\"&gt;\n            &lt;value&gt;False&lt;/value&gt;\n        &lt;/setting&gt;\n        &lt;setting name=\"NotificationSender\" serializeAs=\"String\"&gt;\n            &lt;value&gt;value1&lt;/value&gt;\n        &lt;/setting&gt;\n        &lt;setting name=\"NotificationTitle\" serializeAs=\"String\"&gt;\n            &lt;value&gt;value2&lt;/value&gt;\n        &lt;/setting&gt;\n        &lt;setting name=\"NotificationMessage\" serializeAs=\"String\"&gt;\n            &lt;value&gt;value3&lt;/value&gt;\n        &lt;/setting&gt;\n    &lt;/AutoCalcService.Properties.Settings&gt;\n&lt;/userSettings&gt;\n&lt;applicationSettings&gt;\n    &lt;AutoCalcService.Properties.Settings&gt;\n        &lt;setting name=\"NotificationGoogleAppId\" serializeAs=\"String\"&gt;\n            &lt;value&gt;value4&lt;/value&gt;\n        &lt;/setting&gt;\n    &lt;/AutoCalcService.Properties.Settings&gt;\n&lt;/applicationSettings&gt;\n</code></pre>\n\n<p></p>\n\n<p>Задача: получить доступ к нему из приложения \"Б\", которое с ним никак не связано, и позволить приложению \"Б\" править настройки в секции  приложения \"A\" (секция  доступна только для чтения) - т.е., сделать админку! Возможности архитектурно вынести app.config в отдельное приложение и \"унаследовать\" от него и \"A\", и \"Б\" - увы, нет.</p>\n\n<p>Мне удалось получить сам Configuration и даже отдельные его секции вот так:</p>\n\n<pre><code>string otherExePath = @\"DLAutoCalcService.exe\";\nConfiguration otherConfig = ConfigurationManager.OpenExeConfiguration(otherExePath);\n\nvar sectgr = otherConfig.SectionGroups[\"userSettings\"];\nvar sect = sectgr.Sections[\"AutoCalcService.Properties.Settings\"];\n</code></pre>\n\n<p>Объекты sectgr (тип ConfigurationSectionGroup) и sect (тип ConfigurationSection) не null, а в sect даже есть мои настройки, но мне не удается до них \"достучаться\". В публичных членах sect свойство Settings (которое видно на скриншоте) отсутствует.</p>\n\n<p><a href=\"https://i.stack.imgur.com/P40Yd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P40Yd.png\" alt=\"введите сюда описание изображения\"></a></p>\n\n<p>Пожалуйста, помогите мне продолжить мой код до получения, изменения и сохранения измений на примере настройки \"RoutesOptimize\".</p>\n"}