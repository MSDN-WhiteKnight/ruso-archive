{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":1,"last_activity_date":1514903972,"creation_date":1514903972,"answer_id":765818,"question_id":764547,"body":"<p>Для EXE-файла можно узнать разрядность с помощью функции <a href=\"https://msdn.microsoft.com/en-us/library/aa364819%28VS.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">GetBinaryType</a></p>\n\n<pre><code>using System;\nusing System.Runtime.InteropServices;\n\npublic enum BinaryType : uint\n{\n    SCS_32BIT_BINARY = 0,\n    SCS_64BIT_BINARY = 6,\n    SCS_DOS_BINARY = 1,\n    SCS_OS216_BINARY = 5,\n    SCS_PIF_BINARY = 3,\n    SCS_POSIX_BINARY = 4,\n    SCS_WOW_BINARY = 2\n}\n\npublic class MyClass\n{\n    [DllImport(\"kernel32.dll\")]\n    public static extern bool GetBinaryType(string lpApplicationName,\n       out BinaryType lpBinaryType);\n\n    void PrintExeType(string ExeFilePath)\n    {\n        BinaryType bt;\n        bool res = Native.GetBinaryType(ExeFilePath, out bt);\n\n        if (res == false) MessageBox.Show(\"Not executable\");\n        else\n        {\n            switch (bt)\n            {\n                case BinaryType.SCS_32BIT_BINARY: MessageBox.Show(\"32-bit executable\"); break;\n                case BinaryType.SCS_64BIT_BINARY: MessageBox.Show(\"64-bit executable\"); break;\n                default: MessageBox.Show(\"Other executable\"); break;\n            }\n        }\n    }              \n\n}\n</code></pre>\n"}