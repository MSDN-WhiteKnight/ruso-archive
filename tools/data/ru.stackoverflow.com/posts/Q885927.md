---
title: "Дубликаты ссылок mscorlib в Roslyn при компиляции"
se.owner.user_id: 278293
se.owner.display_name: "Luser"
se.owner.link: "https://ru.stackoverflow.com/users/278293/luser"
se.link: "https://ru.stackoverflow.com/questions/885927/%d0%94%d1%83%d0%b1%d0%bb%d0%b8%d0%ba%d0%b0%d1%82%d1%8b-%d1%81%d1%81%d1%8b%d0%bb%d0%be%d0%ba-mscorlib-%d0%b2-roslyn-%d0%bf%d1%80%d0%b8-%d0%ba%d0%be%d0%bc%d0%bf%d0%b8%d0%bb%d1%8f%d1%86%d0%b8%d0%b8"
se.question_id: 885927
se.post_type: question
se.score: 1
---
<p>Путь к <code>.dll</code> файлам брал от сюда: </p>

<p><code>C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\</code></p>

<pre><code>List&lt;string&gt; DLL = new List&lt;string&gt;(); //тут уже лежит список путей к .dll
using (var provider = new CSharpCodeProvider())
{
   // DLL.ToArray() добавляю ссылки 
   var Params = new CompilerParameters() 
   {
     //parametrs build
   };
   provider.CompileAssemblyFromSource(Params, SourceCode) // compile
}
</code></pre>

<p>Но во время компиляции получаю ошибку:</p>

<blockquote>
  <p>error CS1703: Multiple assemblies with equivalent identity have been
  imported: 
  'C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorlib.dll'  and 
  'C:\Program Files (x86)\Reference\Assemblies\Microsoft\Framework.NETFramework\v3.5\Profile\Client\mscorlib.dll'.</p>
  
  <p>Remove one of the duplicate references.</p>
</blockquote>

<p>Как исправить?</p>

<hr>

<p>[<strong>Дополнительная информация</strong>]</p>

<p>Сам проект скомпилирован под <code>.Net4.5</code> </p>

<p>(специально для <strong>Roslyn</strong>, под другие версии <em>NetFramework</em> его библиотеки он не ставит)</p>

<p>Если брать такой код:</p>

<pre><code>List&lt;string&gt; DLL = new List&lt;string&gt;() // просто файлы
{
   "mscorlib.dll", "System.Data.dll"
}
using (var provider = new CSharpCodeProvider())
{
  var Params = new CompilerParameters(DLL.ToArray())
  {
     //parametrs build
  };
  provider.CompileAssemblyFromSource(Params, SourceCode) // compile
}
</code></pre>

<p>То всё работает, но ссылки из <code>List&lt;string&gt;</code> он добавляет от как бы самого проекта ( под котором он скомпилирован ) P.S: Не из папок!</p>

<p>А мне нужно добавить из нужной мне папки, но если я этого делаю (см 1-ый пост )
то получаю ошибку о том что нельзя добавить библиотеки <code>.dll</code> из разных папок.
Как мне получить нужные мне библиотеки и добавить их в сборку я не знаю как.</p>

<hr>

<p>[<strong>Что предпринимал?</strong> ]</p>

<p>Попробовал удалить из того файла который компилируется ссылки (<code>usings</code>).</p>

<p>Попробовал удалить файл <code>packages.config</code></p>

<p>Но всё безрезультатно.</p>
