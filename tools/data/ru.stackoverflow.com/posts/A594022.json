{"owner":{"reputation":1296,"user_id":228528,"user_type":"registered","accept_rate":100,"profile_image":"https://i.stack.imgur.com/sVFda.jpg?s=128&g=1","display_name":"Даниил Чижевский","link":"https://ru.stackoverflow.com/users/228528/%d0%94%d0%b0%d0%bd%d0%b8%d0%b8%d0%bb-%d0%a7%d0%b8%d0%b6%d0%b5%d0%b2%d1%81%d0%ba%d0%b8%d0%b9"},"is_accepted":false,"score":0,"last_activity_date":1483506579,"last_edit_date":1483506579,"creation_date":1479748172,"answer_id":594022,"question_id":592948,"body":"<p>Ну, как-то так:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Windows;\nusing System.Runtime.InteropServices;\n\n\n  namespace VolumeOff\n  {\n    [StructLayout(LayoutKind.Sequential)]\n    public struct WAVEFORMATEX\n    {\n        public ushort wFormatTag;\n        public ushort nChannels;\n        public uint nSamplesPerSec;\n        public uint nAvgBytesPerSec;\n        public ushort nBlockAlign;\n        public ushort wBitsPerSample;\n        public ushort cbSize;\n    }\n\n\n   public partial class Form1 : Form\n   {\n    public const uint WAVE_MAPPER = unchecked((uint)(-1));\n    public Form1()\n    {\n        InitializeComponent();\n    }\n    [DllImport(\"winmm.dll\", SetLastError = true)]\n    public static extern uint waveOutOpen(ref uint hWaveOut, uint uDeviceID, ref WAVEFORMATEX lpFormat, uint dwCallback, uint dwInstance, uint dwFlags);\n\n    [DllImport(\"winmm.dll\", SetLastError = true, CharSet = CharSet.Auto)]\n    public static extern uint waveOutGetVolume(uint hwo, ref uint dwVolume);\n\n    [DllImport(\"winmm.dll\", SetLastError = true, CallingConvention = CallingConvention.Winapi)]\n    public static extern int waveOutSetVolume(uint uDeviceID, uint dwVolume);\n\n    [DllImport(\"winmm.dll\", SetLastError = true, CharSet = CharSet.Auto)]\n    public static extern uint waveOutClose(uint hwo);\n\n    [DllImport(\"Kernel32.dll\", EntryPoint = \"RtlZeroMemory\", SetLastError = false)]\n    static extern void ZeroMemory(ref WAVEFORMATEX dest, int size);\n\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        uint volume = 0;\n        unsafe\n        {\n            uint hWO = 0;\n            WAVEFORMATEX waveF = new WAVEFORMATEX();\n\n            ZeroMemory(ref waveF, sizeof(WAVEFORMATEX));\n            waveOutOpen(ref hWO, WAVE_MAPPER, ref waveF, 0, 0, 0);\n            waveOutGetVolume(hWO, ref volume);\n            waveOutClose(hWO);\n        }\n        textBox1.Text = volume.ToString();\n    }\n\n    private void button2_Click(object sender, EventArgs e)\n    {\n        unsafe\n        {\n            uint hWO = 0;\n            WAVEFORMATEX waveF = new WAVEFORMATEX();\n\n            ZeroMemory(ref waveF, sizeof(WAVEFORMATEX));\n            waveOutOpen(ref hWO, WAVE_MAPPER, ref waveF, 0, 0, 0);\n            waveOutSetVolume(hWO, Convert.ToUInt32(textBox1.Text.ToString()));\n            waveOutClose(hWO);\n        }\n     }\n  }\n}\n</code></pre>\n"}