---
title: "Answer 914460"
se.owner.user_id: 
se.owner.display_name: "user221357"
se.owner.link: ""
se.answer_id: 914460
se.question_id: 859014
se.post_type: answer
se.score: 1
se.is_accepted: False
---
<p>У всех контролов есть функция DrawToBitmap()</p>

<p>Если предположить, что у тебя панель меньше размера содержимого(и у тебя есть полоса прокрутки). Тогда ты меняешь на 1 секунду размер панели до размера содержимого, делаешь скриншот, а потом возвращаешь размер панели назад:</p>

<pre><code>    public Bitmap GetControlScreenshot(Control control)
    {
        Size szCurrent = control.Size;
        control.AutoSize = true;

        Bitmap bmp = new Bitmap(control.Width, control.Height);//создаем картинку нужных размеров
        control.DrawToBitmap(bmp, control.ClientRectangle);//копируем изображение нужного контрола в bmp

        control.AutoSize = false;
        control.Size = szCurrent;

        return bmp;
    }
</code></pre>

<p>Если же панель не на столько большая, будет достаточно:</p>

<pre><code>System.Drawing.Bitmap bmp = new System.Drawing.Bitmap(panel1.Width, panel1.Height);//создаем картинку нужных размеров
panel1.DrawToBitmap(bmp, panel1.ClientRectangle);//копируем изображение нужного контрола в bmp
</code></pre>

<p>Собственно, если воспользоваться на родительском элементе, то он отрисует в битмап и все дочерние. И скриншотить ничего не нужно, оно захватит полностью контролы, даже, если в даную секунду на форме их не видно. (то есть часть контрола выходит ЗА рамки формы)</p>

<p>Вот пример окна:
<a href="https://i.stack.imgur.com/HyRz7.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/HyRz7.png" alt="введите сюда описание изображения"></a></p>

<p>Вот пример сделанного скриншота панели:
<a href="https://i.stack.imgur.com/bKzOC.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/bKzOC.png" alt="введите сюда описание изображения"></a></p>

<p>Никаких мучений с рекурсией не нужно.</p>

<p>Upd:
Для скриншота всей формы и всех элементов на ней подход тот же(ведь, сама форма -- тот же контрол!):</p>

<pre><code>   System.Drawing.Bitmap bmp = new System.Drawing.Bitmap(this.Width, this.Height);//создаем картинку нужных размеров

   this.DrawToBitmap(bmp, new Rectangle(0, 0, this.Width, this.Height));//копируем изображение нужного контрола в bmp

   bmp.Save("E:\\somePanelImage.bmp");    //ну и дальше просто сохраняем
</code></pre>

<p>UPD2: некоторые считают что таким макаром нельзя отскриншотить дочерние элементы. У этого растут ноги от того, что некоторые люди создают контролы програмно не задавая родительского элемента новому. </p>

<p>Что б проще: програмно создается новый элемент и размещается с абсолютными координатами формы НАД панелью. В таком случае, конечно же, панель будет отскриншочена этим методом пустой, ведь "дочерний" элемент не является дочерним в буквальном смысле. <strong>Он находится просто НАД панелью и только лишь визуально выглядит дочерним контролом.</strong> </p>
