---
title: "Быстрое преобразование Фурье, как работать с комплексными числами, если их нет"
se.owner.user_id: 317856
se.owner.display_name: "Valera"
se.owner.link: "https://ru.stackoverflow.com/users/317856/valera"
se.link: "https://ru.stackoverflow.com/questions/913771/%d0%91%d1%8b%d1%81%d1%82%d1%80%d0%be%d0%b5-%d0%bf%d1%80%d0%b5%d0%be%d0%b1%d1%80%d0%b0%d0%b7%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5-%d0%a4%d1%83%d1%80%d1%8c%d0%b5-%d0%ba%d0%b0%d0%ba-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0%d1%82%d1%8c-%d1%81-%d0%ba%d0%be%d0%bc%d0%bf%d0%bb%d0%b5%d0%ba%d1%81%d0%bd%d1%8b%d0%bc%d0%b8-%d1%87%d0%b8%d1%81%d0%bb%d0%b0%d0%bc%d0%b8-%d0%b5%d1%81%d0%bb%d0%b8-%d0%b8%d1%85-%d0%bd%d0%b5%d1%82"
se.question_id: 913771
se.post_type: question
se.score: 0
---
<pre><code>using System.Numerics;

namespace BPF
{
    public static class danie
    {
        public static Complex[] X;
        public static Complex[] Y;

        public static Complex[] FastPFurie;

    }
    class Program
    {
        static void Main(string[] args)
        {

            danie.X = GetDan("exaX.txt");
            danie.Y = GetDan("exa.txt");
            FFT ff = new FFT();
            danie.FastPFurie=FFT.fft(danie.X);
            Form1 f = new Form1();
            f.ShowDialog();
            Console.ReadKey();
        }
        public static int n = 0;


        public static Complex[] GetDan(string fail)//получение данных из файла
        {
            n = 0;
            string s = "";
            StreamReader r = new StreamReader(fail);
            s = r.ReadLine();
            n = s.Split(' ').Length;
            Complex[] matrix = new Complex[n];
            string[] l = s.Split(' ');
            for (int k = 0; k &lt; n; k++)
            {
                matrix[k] = Convert.ToDouble(l[k]);
            }
            r.Close();
            return matrix;
        }
    }

}
</code></pre>

<p>-</p>

<pre><code>public class FFT
{
    /// Вычисление поворачивающего модуля e^(-i*2*PI*k/N)

    private static Complex w(int k, int N)
    {
        if (k % N == 0) return 1;
        double arg = -2 * Math.PI * k / N;
        return new Complex(Math.Cos(arg), Math.Sin(arg));
    }

    /// Возвращает спектр сигнала

    /// &lt;param name="x"&gt;Массив значений сигнала. Количество значений должно быть степенью 2&lt;/param&gt;
    /// &lt;returns&gt;Массив со значениями спектра сигнала&lt;/returns&gt;
    public static Complex[] fft(Complex[] x)
    {
        Complex[] X;
        int N = x.Length;
        if (N == 2)
        {
            X = new Complex[2];
            X[0] = x[0] + x[1];
            X[1] = x[0] - x[1];
        }
        else
        {
            Complex[] x_even = new Complex[N / 2];
            Complex[] x_odd = new Complex[N / 2];
            for (int i = 0; i &lt; N / 2; i++)
            {
                x_even[i] = x[2 * i];
                x_odd[i] = x[2 * i + 1];
            }
            Complex[] X_even = fft(x_even);
            Complex[] X_odd = fft(x_odd);
            X = new Complex[N];
            for (int i = 0; i &lt; N / 2; i++)
            {
                X[i] = X_even[i] + w(i, N) * X_odd[i];
                X[i + N / 2] = X_even[i] - w(i, N) * X_odd[i];
            }
        }
        return X;
    }
    /// &lt;summary&gt;
    /// Центровка массива значений полученных в fft (спектральная составляющая при нулевой частоте будет в центре массива)
    /// &lt;/summary&gt;
    /// &lt;param name="X"&gt;Массив значений полученный в fft&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public static Complex[] nfft(Complex[] X)
    {
        int N = X.Length;
        Complex[] X_n = new Complex[N];
        for (int i = 0; i &lt; N / 2; i++)
        {
            X_n[i] = X[N / 2 + i];
            X_n[N / 2 + i] = X[i];
        }
        return X_n;
    }
}
</code></pre>

<p>Из файлах содержатся значения сигнала экг: 26,48 24,743 19,478 18,407 20,252 23,051 21,028.... и тд это зачения по Y, по X в другом файле, после преобразований, выдаёт чудо график...</p>

<pre><code>public Form1()
    {
        InitializeComponent();
        chart1.Series[0].ChartType = SeriesChartType.Spline;
        chart2.Series[0].ChartType = SeriesChartType.Spline;
    }

    private void button1_Click(object sender, EventArgs e)
    {
        foreach (Complex complex in danie.FastPFurie)
            chart1.Series[0].Points.AddXY(complex.Real, complex.Imaginary);
    }
</code></pre>

<p><a href="https://i.stack.imgur.com/ybPw1.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/ybPw1.png" alt="введите сюда описание изображения"></a></p>
