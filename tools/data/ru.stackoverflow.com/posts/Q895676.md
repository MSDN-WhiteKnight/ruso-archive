---
title: "Передача делегата в неуправляемый код как указатель на функцию"
se.owner.user_id: 206435
se.owner.display_name: "ヒミコ"
se.owner.link: "https://ru.stackoverflow.com/users/206435/%e3%83%92%e3%83%9f%e3%82%b3"
se.link: "https://ru.stackoverflow.com/questions/895676/%d0%9f%d0%b5%d1%80%d0%b5%d0%b4%d0%b0%d1%87%d0%b0-%d0%b4%d0%b5%d0%bb%d0%b5%d0%b3%d0%b0%d1%82%d0%b0-%d0%b2-%d0%bd%d0%b5%d1%83%d0%bf%d1%80%d0%b0%d0%b2%d0%bb%d1%8f%d0%b5%d0%bc%d1%8b%d0%b9-%d0%ba%d0%be%d0%b4-%d0%ba%d0%b0%d0%ba-%d1%83%d0%ba%d0%b0%d0%b7%d0%b0%d1%82%d0%b5%d0%bb%d1%8c-%d0%bd%d0%b0-%d1%84%d1%83%d0%bd%d0%ba%d1%86%d0%b8%d1%8e"
se.question_id: 895676
se.post_type: question
se.score: 4
---
<p>Имеется неуправляемый метод, который принимает указатель на функцию <code>callback</code>.</p>

<p>Определенный прототип выглядит так:</p>

<pre><code>typedef SDL_HitTestResult (SDLCALL *SDL_HitTest)
                          (SDL_Window *win, const SDL_Point *area, void *data);
</code></pre>

<p>Думаю определение делегата должно быть соответственно таким:</p>

<pre><code>delegate HitTestResult HitTestDelegate(IntPtr windowPtr,
                                       IntPtr pointAreaPtr, IntPtr userData);
</code></pre>

<p>Но тут теперь возникает вопрос, нужно ли данный делегат помечать как указатель на неуправляемую функцию, т.е. ставить ему атрибут</p>

<pre><code>[UnmanagedFunctionPointer(CallingConvention.Cdecl)]
delegate HitTestResult HitTestDelegate(IntPtr windowPtr,
                                       IntPtr pointAreaPtr, IntPtr userData);
</code></pre>

<p>Т.к. стоит <code>SDLCALL</code> определнный как <code>__cdecl</code>.</p>
