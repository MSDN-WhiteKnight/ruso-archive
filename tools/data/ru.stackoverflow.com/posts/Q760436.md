---
title: "Передача по ссылке с последующим копированием vs передача по значению"
se.owner.user_id: 176217
se.owner.display_name: "αλεχολυτ"
se.owner.link: "https://ru.stackoverflow.com/users/176217/%ce%b1%ce%bb%ce%b5%cf%87%ce%bf%ce%bb%cf%85%cf%84"
se.link: "https://ru.stackoverflow.com/questions/760436/%d0%9f%d0%b5%d1%80%d0%b5%d0%b4%d0%b0%d1%87%d0%b0-%d0%bf%d0%be-%d1%81%d1%81%d1%8b%d0%bb%d0%ba%d0%b5-%d1%81-%d0%bf%d0%be%d1%81%d0%bb%d0%b5%d0%b4%d1%83%d1%8e%d1%89%d0%b8%d0%bc-%d0%ba%d0%be%d0%bf%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d0%bd%d0%b8%d0%b5%d0%bc-vs-%d0%bf%d0%b5%d1%80%d0%b5%d0%b4%d0%b0%d1%87%d0%b0-%d0%bf%d0%be-%d0%b7%d0%bd%d0%b0%d1%87%d0%b5%d0%bd%d0%b8%d1%8e"
se.question_id: 760436
se.post_type: question
se.score: 14
---
<p>Есть некий тяжёлый для копирования тип, например:</p>

<pre><code>struct S 
{ 
    int a[100]; 
};
</code></pre>

<p>И стоит задача обработки значения переменной этого типа с возвратом изменённой копии, т.е. оригинал должен быть сохранён. Напрашиваются два подхода:</p>

<ol>
<li><pre><code>S test(const S&amp; s)
{
    S news = s;           // делаем копию
    news.a[42] = 100500;  // изменяем 
    return news;          // возвращаем
}
</code></pre></li>
<li><pre><code>S test(S s)               // делаем копию
{
    s.a[42] = 100500;     // изменяем
    return s;             // возвращаем
}
</code></pre></li>
</ol>

<p>Вариант 2 выглядит более коротким с точки зрения кода, однако, как показывает <a href="https://godbolt.org/g/G6UhMd" rel="noreferrer">сборка</a>, передача по ссылке даёт более короткий ассемблерный код.</p>

<p>Почему так происходит и какие есть ещё плюсы и минусы этих двух подходов, чтобы понимать, какой из них предпочесть? Может есть ещё какие-то варианты?</p>
