{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":2,"last_activity_date":1551263430,"creation_date":1551263430,"answer_id":950058,"question_id":948990,"body":"<p>Вам нужно преобразовать строку в UTF-8 перед тем, как получать hex-представление. Можно использовать, например, <a href=\"https://docs.microsoft.com/en-us/cpp/standard-library/codecvt-utf8-utf16-class?view=vs-2015\" rel=\"nofollow noreferrer\">codecvt_utf8_utf16</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;locale.h&gt;\n#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;locale&gt;\n#include &lt;codecvt&gt;\n\nint _tmain(int argc, _TCHAR* argv[])\n{    \n    setlocale(LC_ALL,\"Russian\");\n\n    wchar_t wide_str[] = L\"жизнь\";  \n    wchar_t hex_buffer[256] = L\"\";\n    wchar_t buf[32];\n\n    //преобразуем строку в UTF-8\n    std::wstring_convert&lt;std::codecvt_utf8_utf16&lt;wchar_t&gt;, wchar_t&gt; utf16conv;  \n    auto utf8_str = utf16conv.to_bytes(wide_str);\n\n    //преобразуем UTF-8 в hex-представление\n    for(int i=0;i&lt;utf8_str.length();i++){   \n        swprintf(buf, L\"%%%x\",(unsigned int)(unsigned char)(utf8_str.c_str()[i]));\n        wcscat(hex_buffer,buf);\n    }\n    wprintf(L\"%s = %s\\n\",wide_str,hex_buffer);\n\n    getchar();\n    return 0;\n}\n// Результат:\n//\n// жизнь = %d0%b6%d0%b8%d0%b7%d0%bd%d1%8c\n</code></pre>\n"}