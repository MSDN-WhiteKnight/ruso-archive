---
title: "Как напечатать стек вызовов в обработчике исключения?"
se.owner.user_id: 217357
se.owner.display_name: "LmTinyToon"
se.owner.link: "https://ru.stackoverflow.com/users/217357/lmtinytoon"
se.link: "https://ru.stackoverflow.com/questions/788394/%d0%9a%d0%b0%d0%ba-%d0%bd%d0%b0%d0%bf%d0%b5%d1%87%d0%b0%d1%82%d0%b0%d1%82%d1%8c-%d1%81%d1%82%d0%b5%d0%ba-%d0%b2%d1%8b%d0%b7%d0%be%d0%b2%d0%be%d0%b2-%d0%b2-%d0%be%d0%b1%d1%80%d0%b0%d0%b1%d0%be%d1%82%d1%87%d0%b8%d0%ba%d0%b5-%d0%b8%d1%81%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d1%8f"
se.question_id: 788394
se.post_type: question
se.score: 2
---
<p>У меня есть c++ программа на Windows, в которой я хочу предусмотреть полный логгинг стека вызовов в случае возникновения ошибки (hardware, software). Возможно ли реализовать такую функциональность? Вот небольшой кусок кода, содержащий внешний seh обработчик:</p>

<pre><code>__try
{
     difficult_task();
}
__except(my_seh_filter(GetExceptionInformation()))
{
    // How to print full backtrace of exception here?
}
</code></pre>

<p>Что я знаю на данный момент:</p>

<ol>
<li>Поставляемая windows DbgHelp.dll позволяет получить информацию о стэке вызовов (распечатать стэк можно).</li>
<li>SEH обработка исключений позволяет получить контекст в котором возникло исключение. (Тип исключения, адресс возникновения исключения, регистры процессора на момент выброса исключения).</li>
</ol>

<p>Есть одно <strong>НО</strong>. Я хочу распечатать стек вызовов непосредственно в seh фильтре или соответсвующем catch блоке. И мне не совсем понятно, как можно используя эти два инструмента  распечатать backtrace (он ведь на момент раскрутки стэка может изменится). Одно дело когда я распечатываю стэк в момент выброса исключения. Другое когда в момент обработки (я предполагаю что на момент обработки исключения полной информации о стеке у меня уже не будет).</p>
