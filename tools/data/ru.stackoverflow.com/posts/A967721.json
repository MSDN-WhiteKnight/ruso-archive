{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":3,"last_activity_date":1555184511,"last_edit_date":1555184511,"creation_date":1554872957,"answer_id":967721,"question_id":967628,"body":"<h1>Windows 10</h1>\n\n<p>Можно использовать API UWP (<a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.data.pdf\" rel=\"nofollow noreferrer\">Windows.Data.Pdf</a>). Для его использования необходим добавить ссылки на:</p>\n\n<ul>\n<li>библиотеку метаданных UWP, путь к которой имеет вид <code>C:\\Program Files (x86)\\Windows Kits\\10\\UnionMetadata\\(версия)\\Windows.winmd</code> (для добавления ссылки на нее в диалоговом окне выбора библиотеки необходимо изменить фильтр на \"Все файлы\");</li>\n<li>сборку System.Runtime.WindowsRuntime (<code>C:\\Program Files (x86)\\Reference Assemblies\\Microsoft\\Framework\\.NETCore\\v4.5\\System.Runtime.WindowsRuntime.dll</code>).</li>\n</ul>\n\n<p>Тогда код для отображения страницы PDF-документа в WPF будет выглядеть так:</p>\n\n<p>XAML</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Window\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n        mc:Ignorable=\"d\"\n        x:Class=\"WpfApp1.MainWindow\"\n        Title=\"MainWindow\" Height=\"400\" Width=\"600\" &gt;\n\n    &lt;Grid HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\" x:Name=\"grid\" &gt;\n        &lt;Button Content=\"Button\" HorizontalAlignment=\"Left\" Height=\"50\" Margin=\"20,20,0,0\" \n                VerticalAlignment=\"Top\" Width=\"217\" Click=\"Button_Click\"/&gt;\n        &lt;Image HorizontalAlignment=\"Stretch\"  Margin=\"40,100,40,40\" VerticalAlignment=\"Stretch\" x:Name=\"img\"/&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>C#</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.IO;\nusing System.Collections.Generic;\nusing System.Text;\nusing System.Windows;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Controls;\nusing Windows.Data.Pdf;\nusing Windows.Storage;\nusing Windows.Storage.Streams;\n\nnamespace WpfApp1\n{\n    public partial class MainWindow : Window\n    {\n        public MainWindow()\n        {\n            InitializeComponent();            \n        }        \n\n        private async void Button_Click(object sender, RoutedEventArgs e)\n        {\n            StorageFile file = await StorageFile.GetFileFromPathAsync(@\"C:\\files\\document.pdf\");\n            PdfDocument pdf = await PdfDocument.LoadFromFileAsync(file);\n            PdfPage page = pdf.GetPage(0);\n            BitmapImage image = new BitmapImage();\n\n            using (var stream = new InMemoryRandomAccessStream())\n            {\n                await page.RenderToStreamAsync(stream);\n\n                image.BeginInit();\n                image.CacheOption = BitmapCacheOption.OnLoad;\n                image.StreamSource = stream.AsStream();\n                image.EndInit();\n            }\n            img.Source = image;      \n        }\n    }    \n}\n</code></pre>\n\n<p>Источник: <a href=\"https://blogs.u2u.be/lander/post/2018/01/23/Creating-a-PDF-Viewer-in-WPF-using-Windows-10-APIs\" rel=\"nofollow noreferrer\">Lander Verhack. Creating a PDF Viewer in WPF using Windows 10 APIs</a></p>\n\n<h1>Предыдущие версии Windows</h1>\n\n<p>Использовать какую-либо стороннюю библиотеку, например:</p>\n\n<ul>\n<li><p><a href=\"https://cefsharp.github.io\" rel=\"nofollow noreferrer\">CefSharp</a> - аналог WebBrowser, который поддерживает также отображение PDF</p></li>\n<li><p><a href=\"https://www.codeproject.com/Articles/380019/Using-Adobe-Reader-in-a-WPF-app\" rel=\"nofollow noreferrer\">ActiveX-элемент Adobe Reader</a></p></li>\n</ul>\n"}