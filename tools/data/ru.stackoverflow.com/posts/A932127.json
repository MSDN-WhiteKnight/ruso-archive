{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":0,"last_activity_date":1547487660,"creation_date":1547487660,"answer_id":932127,"question_id":931706,"body":"<p>Если вас не интересует поддержка старого ПО, можно закодировать в Unicode, тогда проблемы кодировки не будет. Для этого пропустите строку через такой метод:</p>\n\n<pre><code>static string RtfEncode(string input)\n{\n    StringBuilder sb = new StringBuilder(input.Length * 4);\n\n    foreach (var c in input)\n    {\n        if (c &gt; 127) //заменяем не-ASCII символы на их Unicode представление\n        {\n            string escape = \"\\\\u\" + ((Int16)c).ToString() + \"?\";\n            sb.Append(escape);\n        }\n        else //ASCII добавляем без изменений\n        {\n            sb.Append(c);\n        }\n    }\n\n    return sb.ToString();\n}\n</code></pre>\n\n<p>Тогда замену можно произвести как-то так:</p>\n\n<pre><code>string template = \"#template#\";\nstring word = \"Иванов И.А.\";\nstring contents = File.ReadAllText(input_file);\n\nword = RtfEncode(word);\ncontents = contents.Replace(template, word);\nFile.WriteAllText(output_file, contents);\n</code></pre>\n\n<p>О кодировке не нужно заботиться, так как после RtfEncode задействованы только ASCII символы. При таком способе ничего не должно нарушиться, при условии что маркер замены в шаблоне никак не пересекает границы управляющих конструкций RTF. (Отредактируйте шаблон в блокноте, и убедитесь, что строка замены представлена именно так, как вы ожидаете.)</p>\n"}