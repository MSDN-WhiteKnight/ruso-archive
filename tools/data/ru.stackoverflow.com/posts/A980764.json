{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":1,"last_activity_date":1557727090,"creation_date":1557727090,"answer_id":980764,"question_id":980594,"body":"<p>В коде нет проверки возвращаемого значения для функций WritePrivateProfileString и GetPrivateProfileString. Вы, похоже, предполагаете, что эти функции сбрасывают код последней ошибки в 0, но это не так. </p>\n\n<pre><code>if(WritePrivateProfileString(section, key, value, Path) == 0)\n{\n    int er = Marshal.GetLastWin32Error();\n    if (er &gt; 0) throw new Exception(\"...\");\n}\n</code></pre>\n"}