---
title: "Как отловить все клавиши через низкоуровневый хук?"
se.owner.user_id: 308892
se.owner.display_name: "InvertSOD"
se.owner.link: "https://ru.stackoverflow.com/users/308892/invertsod"
se.link: "https://ru.stackoverflow.com/questions/879772/%d0%9a%d0%b0%d0%ba-%d0%be%d1%82%d0%bb%d0%be%d0%b2%d0%b8%d1%82%d1%8c-%d0%b2%d1%81%d0%b5-%d0%ba%d0%bb%d0%b0%d0%b2%d0%b8%d1%88%d0%b8-%d1%87%d0%b5%d1%80%d0%b5%d0%b7-%d0%bd%d0%b8%d0%b7%d0%ba%d0%be%d1%83%d1%80%d0%be%d0%b2%d0%bd%d0%b5%d0%b2%d1%8b%d0%b9-%d1%85%d1%83%d0%ba"
se.question_id: 879772
se.post_type: question
se.score: 4
---
<p>Как отловить в <code>HookCallback</code> все клавиши с проверкой по шифтам и.т.п?
Обычный <code>(Keys) Marshal.ReadInt32 (lParam)</code> просто пишет большими буквами.</p>

<pre><code>public delegate IntPtr LowLevelKeyboardProc(int nCode, IntPtr wParam, IntPtr lParam);
private static readonly LowLevelKeyboardProc _proc = HookCallback;

private static IntPtr _hookID = IntPtr.Zero;

private static IntPtr HookCallback(int nCode, IntPtr wParam, IntPtr lParam)
{
  if (nCode &gt;= 0 &amp;&amp; wParam == (IntPtr)WM_KEYDOWN)
  {
    try
    {
       Console.WriteLine((Keys)Marshal.ReadInt32(lParam));
    }
    catch (AccessViolationException ex) { Console.WriteLine($"Error: {ex.ToString()}"); }
  }
  return NativeMethods.CallNextHookEx(_hookID, nCode, wParam, lParam);
}
</code></pre>

<p>У меня есть идея занести список клавиш в <code>List&lt;Keys&gt;</code> и оттуда как-то делать проверку. </p>

<p>Но может у Вас есть идеи по лучше?! ( <em>желательно с примером</em> )</p>
