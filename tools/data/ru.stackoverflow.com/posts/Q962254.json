{"tags":["c++","winapi","сеть"],"owner":{"reputation":83,"user_id":325490,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/32ff8d927d0b251f0f188241549688f1?s=128&d=identicon&r=PG&f=1","display_name":"sddvxd","link":"https://ru.stackoverflow.com/users/325490/sddvxd"},"is_answered":true,"view_count":90,"answer_count":1,"score":2,"last_activity_date":1554100983,"creation_date":1553710089,"question_id":962254,"link":"https://ru.stackoverflow.com/questions/962254/%d0%9a%d0%b0%d0%ba-%d0%b0%d0%b4%d0%b0%d0%bf%d1%82%d0%b8%d1%80%d0%be%d0%b2%d0%b0%d1%82%d1%8c-%d0%ba%d0%be%d0%b4-%d0%bf%d0%be%d0%b4-%d0%bf%d0%be%d0%b8%d1%81%d0%ba-%d1%83%d1%81%d1%82%d1%80%d0%be%d0%b9%d1%81%d1%82%d0%b2-%d0%b2-%d1%81%d0%b5%d1%82%d0%b8","title":"Как адаптировать код под поиск устройств в сети?","body":"<p>Есть код, который почти полностью был скопирован из <a href=\"https://docs.microsoft.com/ru-ru/windows/desktop/WNet/enumerating-network-resources\" rel=\"nofollow noreferrer\">статьи MSDN:</a></p>\n\n<pre><code>BOOL WINAPI EnumResources(LPNETRESOURCE lpNR = nullptr){\n    HANDLE hNetEnum;\n    DWORD dwResultOpen = WNetOpenEnum(RESOURCE_CONTEXT,\n                                      NULL,\n                                      0,\n                                      lpNR,\n                                      &amp;hNetEnum);\n\n    if(dwResultOpen != NO_ERROR)\n        return FALSE;\n\n    constexpr DWORD numOfResources = 2048;\n    DWORD count = -1;\n    DWORD cbBuffer = numOfResources * sizeof (NETRESOURCE);\n    DWORD dwResultEnum = 0;\n    LPNETRESOURCE lpNRlocal = new NETRESOURCE[numOfResources];\n\n    do{\n        dwResultEnum = WNetEnumResource(hNetEnum, &amp;count, lpNRlocal, &amp;cbBuffer);\n        if(dwResultEnum == NO_ERROR){\n            for(int i = 0; i &lt; count; ++i){\n                cout &lt;&lt; \"Resource found!: \" &lt;&lt; lpNRlocal[i].lpLocalName &lt;&lt; endl;\n                if(RESOURCEUSAGE_CONTAINER == (lpNRlocal[i].dwUsage &amp; RESOURCEUSAGE_CONTAINER))\n                    if(!EnumResources(&amp;lpNRlocal[i]))\n                        cout &lt;&lt; \"error enum resources\\n\";\n            }\n        }\n\n    }while(dwResultEnum != ERROR_NO_MORE_ITEMS);\n\n    delete [] lpNRlocal;\n    CloseHandle(hNetEnum);\n    return TRUE;\n}\n</code></pre>\n\n<p>Проблема в том, что этот код выполняется долго, а как выполняется - дает просто список контейнеров (хотя надеялся больше типов будет). Подскажите пожалуйста, у кого был опыт работы с данными функциями - как адаптировать код выше, чтобы он выводил ip адреса устройств в локальной сети?</p>\n"}