{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":1,"last_activity_date":1536819197,"creation_date":1536819197,"answer_id":880754,"question_id":880627,"body":"<p>Например, прочитав содержимое ветки реестра <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/install/hklm-system-currentcontrolset-enum-registry-tree\" rel=\"nofollow noreferrer\">HKLM\\SYSTEM\\CurrentControlSet\\Enum</a></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Text;\nusing Microsoft.Win32;\n\nnamespace ConsoleApplication1\n{\n    class Program\n    {       \n        static void Main(string[] args)\n        {\n            var pci = Registry.LocalMachine.OpenSubKey(\"SYSTEM\\\\CurrentControlSet\\\\Enum\\\\PCI\");\n            var keys = pci.GetSubKeyNames();\n\n            foreach (var keyname in keys)\n            {\n                var subkey = pci.OpenSubKey(keyname);\n                var devices = subkey.GetSubKeyNames();\n\n                foreach (var devname in devices)\n                {\n                    var devkey = subkey.OpenSubKey(devname);\n                    object val = devkey.GetValue(\"FriendlyName\",\"\");\n                    if (val == null || (string)val == \"\")\n                    {\n                        val = devkey.GetValue(\"DeviceDesc\", \"\");\n                        if (val == null) val = \"\";\n                    }\n\n                    Console.WriteLine((string)val);\n                    devkey.Close();\n                }\n                subkey.Close();\n            }\n            pci.Close();\n\n            Console.ReadKey();            \n        }\n    }\n}\n</code></pre>\n"}