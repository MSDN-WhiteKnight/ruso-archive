---
title: "Answer 471194"
se.owner.user_id: 22836
se.owner.display_name: "4per"
se.owner.link: "https://ru.stackoverflow.com/users/22836/4per"
se.answer_id: 471194
se.question_id: 471177
se.post_type: answer
se.score: -1
se.is_accepted: False
---
<p>Не скажу что способ хороший, но вдруг</p>

<pre><code>    private void TestIsWindowExe()
    {
        MessageBox.Show(IsWindowExe("notepad.exe", TimeSpan.FromSeconds(10)).ToString());
        MessageBox.Show(IsWindowExe("cmd.exe", TimeSpan.FromSeconds(10)).ToString());
    }

    /// &lt;summary&gt;
    /// Проверка исполняемого файла, является ли он оконным
    /// &lt;/summary&gt;
    /// &lt;param name="exepath"&gt;путь к исполняемому файлу&lt;/param&gt;
    /// &lt;param name="timeout"&gt;время ожидания загрузки программы&lt;/param&gt;
    /// &lt;returns&gt;Является ли оконным&lt;/returns&gt;
    private bool IsWindowExe(string exepath, TimeSpan timeout)
    {
        var process = new System.Diagnostics.Process();
        var startInfo = new System.Diagnostics.ProcessStartInfo();
        startInfo.FileName = exepath;            
        process.StartInfo = startInfo;
        process.Start();
        bool iswindow;
        try
        {               
            if (process.WaitForInputIdle(Convert.ToInt32(timeout.TotalMilliseconds)))
               iswindow = true;
            else
               throw new TimeoutException("Превышен таймаут ожидания загрузки процесса");
        }
        catch (InvalidOperationException ex)
        {
            iswindow = false;
        }
        process.Kill();
        return iswindow;
    }
</code></pre>
