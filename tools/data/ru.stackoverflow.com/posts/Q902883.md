---
title: "Получение настроек другого приложения из app.config"
se.owner.user_id: 307974
se.owner.display_name: "Андрей Кутасевич"
se.owner.link: "https://ru.stackoverflow.com/users/307974/%d0%90%d0%bd%d0%b4%d1%80%d0%b5%d0%b9-%d0%9a%d1%83%d1%82%d0%b0%d1%81%d0%b5%d0%b2%d0%b8%d1%87"
se.link: "https://ru.stackoverflow.com/questions/902883/%d0%9f%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bd%d0%b0%d1%81%d1%82%d1%80%d0%be%d0%b5%d0%ba-%d0%b4%d1%80%d1%83%d0%b3%d0%be%d0%b3%d0%be-%d0%bf%d1%80%d0%b8%d0%bb%d0%be%d0%b6%d0%b5%d0%bd%d0%b8%d1%8f-%d0%b8%d0%b7-app-config"
se.question_id: 902883
se.post_type: question
se.score: 2
---
<p>Имеется вот такой файл app.config в приложении "A":</p>

<pre><code>&lt;?xml version="1.0"?&gt;
&lt;configuration&gt;
&lt;configSections&gt;
    &lt;sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" &gt;
        &lt;section name="AutoCalcService.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" requirePermission="false" /&gt;
    &lt;/sectionGroup&gt;
    &lt;sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" &gt;
        &lt;section name="AutoCalcService.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" /&gt;
    &lt;/sectionGroup&gt;
&lt;/configSections&gt;
&lt;startup&gt;&lt;supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.2"/&gt;&lt;/startup&gt;
&lt;userSettings&gt;
    &lt;AutoCalcService.Properties.Settings&gt;
        &lt;setting name="RoutesOptimize" serializeAs="String"&gt;
            &lt;value&gt;False&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting name="NotificationSender" serializeAs="String"&gt;
            &lt;value&gt;value1&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting name="NotificationTitle" serializeAs="String"&gt;
            &lt;value&gt;value2&lt;/value&gt;
        &lt;/setting&gt;
        &lt;setting name="NotificationMessage" serializeAs="String"&gt;
            &lt;value&gt;value3&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/AutoCalcService.Properties.Settings&gt;
&lt;/userSettings&gt;
&lt;applicationSettings&gt;
    &lt;AutoCalcService.Properties.Settings&gt;
        &lt;setting name="NotificationGoogleAppId" serializeAs="String"&gt;
            &lt;value&gt;value4&lt;/value&gt;
        &lt;/setting&gt;
    &lt;/AutoCalcService.Properties.Settings&gt;
&lt;/applicationSettings&gt;
</code></pre>

<p></p>

<p>Задача: получить доступ к нему из приложения "Б", которое с ним никак не связано, и позволить приложению "Б" править настройки в секции  приложения "A" (секция  доступна только для чтения) - т.е., сделать админку! Возможности архитектурно вынести app.config в отдельное приложение и "унаследовать" от него и "A", и "Б" - увы, нет.</p>

<p>Мне удалось получить сам Configuration и даже отдельные его секции вот так:</p>

<pre><code>string otherExePath = @"DLAutoCalcService.exe";
Configuration otherConfig = ConfigurationManager.OpenExeConfiguration(otherExePath);

var sectgr = otherConfig.SectionGroups["userSettings"];
var sect = sectgr.Sections["AutoCalcService.Properties.Settings"];
</code></pre>

<p>Объекты sectgr (тип ConfigurationSectionGroup) и sect (тип ConfigurationSection) не null, а в sect даже есть мои настройки, но мне не удается до них "достучаться". В публичных членах sect свойство Settings (которое видно на скриншоте) отсутствует.</p>

<p><a href="https://i.stack.imgur.com/P40Yd.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/P40Yd.png" alt="введите сюда описание изображения"></a></p>

<p>Пожалуйста, помогите мне продолжить мой код до получения, изменения и сохранения измений на примере настройки "RoutesOptimize".</p>
