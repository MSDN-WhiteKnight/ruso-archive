{"owner":{"reputation":16117,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":1,"last_activity_date":1537336761,"creation_date":1537336761,"answer_id":882955,"question_id":881670,"body":"<p>Можно просто преобразовать SVG в растровое изображение и отобразить его. Это можно сделать с помощью <a href=\"https://ru.stackoverflow.com/a/810978/240512\">сторонних библиотек</a>, или, при наличии Internet Explorer 11, стандартными средствами.</p>\n\n<p>Добавим ссылки на <strong>System.Drawing</strong> и <strong>COM -> Microsoft HTML Object Library</strong>. Создадим вспомогательный класс для преобразования SVG в BMP:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Drawing;\nusing System.Text;\nusing System.Runtime.InteropServices;\nusing System.ComponentModel;\n//Reference: System.Drawing\n//Reference: Microsoft HTML Object Library\n\nnamespace WpfApplication1\n{\n    public class SvgConvert\n    {\n        //преобразует SVG, заданный строкой svgcontent, в Bitmap заданных размеров и записывает его в поток output\n        public static void ToBitmap(string svgcontent, int w_image,int h_image,System.IO.Stream output)\n        {\n            RECTL rcClient = new RECTL();\n\n            bool b = SystemParametersInfo(SPI_GETWORKAREA, 0, ref rcClient, 0);\n            if (b == false) { rcClient.bottom = 480; rcClient.right = 640; }\n\n            int width = (int)(rcClient.right - rcClient.left);\n            int height = (int)(rcClient.bottom - rcClient.top);\n\n            IntPtr screendc = GetDC(IntPtr.Zero);\n\n            string svghtml =\n                \"&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=11\\\" /&gt;&lt;/head&gt;&lt;body&gt;\" + svgcontent + \"&lt;/body&gt;&lt;/html&gt;\";\n\n            mshtml.HTMLDocument doc = null;\n            mshtml.IHTMLDocument2 d2 = null;\n            IOleObject pObj = null;\n            IViewObject pView = null;\n\n            try\n            {\n                doc = new mshtml.HTMLDocument(); //создание документа\n                d2 = (mshtml.IHTMLDocument2)doc;\n                int hr;\n\n                //установка размера документа\n                pObj = (IOleObject)d2;\n                SIZEL sz = new SIZEL();\n\n                sz.x = (uint)MulDiv(width, HIMETRIC_INCH, GetDeviceCaps(screendc, LOGPIXELSX));\n                sz.y = (uint)MulDiv(height, HIMETRIC_INCH, GetDeviceCaps(screendc, LOGPIXELSY));\n\n                hr = pObj.SetExtent((int)System.Runtime.InteropServices.ComTypes.DVASPECT.DVASPECT_CONTENT, ref sz);\n                if (hr != 0) throw Marshal.GetExceptionForHR(hr);\n\n                //запись SVG в документ\n                d2.write(svghtml);\n                d2.close();\n\n                //преобразование в Bitmap\n                pView = (IViewObject)d2;\n                Bitmap bmp = new Bitmap(w_image, h_image);\n                Graphics g = Graphics.FromImage(bmp);\n                using (g)\n                {\n\n                    IntPtr hdc = g.GetHdc();\n                    hr = pView.Draw((int)System.Runtime.InteropServices.ComTypes.DVASPECT.DVASPECT_CONTENT,\n                        -1, IntPtr.Zero, IntPtr.Zero, IntPtr.Zero, hdc, ref rcClient, IntPtr.Zero,\n                        IntPtr.Zero, 0);\n                    if (hr != 0) throw Marshal.GetExceptionForHR(hr);\n                    g.ReleaseHdc(hdc);\n                }\n\n                //сохранение\n                bmp.Save(output, System.Drawing.Imaging.ImageFormat.Bmp);\n\n\n            }\n            finally\n            {\n                //освобождение ресурсов                \n                if (d2 != null) Marshal.ReleaseComObject(d2);\n                if (pObj != null) Marshal.ReleaseComObject(pObj);\n                if (pView != null) Marshal.ReleaseComObject(pView);\n                if (doc != null) Marshal.ReleaseComObject(doc);\n            }\n        }\n\n        [DllImport(\"gdi32.dll\")]\n        static extern int GetDeviceCaps(IntPtr hdc, int nIndex);\n\n        [DllImport(\"user32.dll\")]\n        static extern IntPtr GetDC(IntPtr hWnd);\n\n        [DllImport(\"user32.dll\")]\n        static extern bool SystemParametersInfo(int nAction, int nParam, ref RECTL rc, int nUpdate);\n\n        public static int MulDiv(int number, int numerator, int denominator)\n        {\n            return (int)(((long)number * numerator) / denominator);\n        }\n\n        const int LOGPIXELSX = 88;\n        const int LOGPIXELSY = 90;\n        const int HIMETRIC_INCH = 2540;\n        const int SPI_GETWORKAREA = 48;\n\n    }\n\n    [ComImport()]\n    [GuidAttribute(\"0000010d-0000-0000-C000-000000000046\")]\n    [InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIUnknown)]\n    public interface IViewObject\n    {\n        int Draw([MarshalAs(UnmanagedType.U4)] int dwDrawAspect, int lindex, IntPtr pvAspect, IntPtr ptd, IntPtr hdcTargetDev, IntPtr hdcDraw,\n            ref RECTL lprcBounds, IntPtr lprcWBounds, IntPtr pfnContinue, int dwContinue);\n        int a();\n        int b();\n        int c();\n        int d();\n        int e();\n    }\n\n    [ComImport()]\n    [Guid(\"00000112-0000-0000-C000-000000000046\")]\n    [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\n    public interface IOleObject\n    {\n        void f();\n        void g();\n        void SetHostNames(object szContainerApp, object szContainerObj);\n        void Close(uint dwSaveOption);\n        void SetMoniker(uint dwWhichMoniker, object pmk);\n        void GetMoniker(uint dwAssign, uint dwWhichMoniker, object ppmk);\n        void x();\n        void y();\n        void DoVerb(uint iVerb, uint lpmsg, object pActiveSite, uint lindex, uint hwndParent, uint lprcPosRect);\n        void EnumVerbs(ref object ppEnumOleVerb);\n        void Update();\n        void IsUpToDate();\n        void GetUserClassID(uint pClsid);\n        void GetUserType(uint dwFormOfType, uint pszUserType);\n        int SetExtent(uint dwDrawAspect, ref SIZEL psizel);\n        void GetExtent(uint dwDrawAspect, uint psizel);\n        void Advise(object pAdvSink, uint pdwConnection);\n        void Unadvise(uint dwConnection);\n        void EnumAdvise(ref object ppenumAdvise);\n        void GetMiscStatus(uint dwAspect, uint pdwStatus);\n        void SetColorScheme(object pLogpal);\n    };  \n\n    public struct RECTL\n    {\n        public uint left;\n        public uint top;\n        public uint right;\n        public uint bottom;\n    }\n\n    public struct SIZEL\n    {\n        public uint x;\n        public uint y;\n    }\n} \n</code></pre>\n\n<p>Тогда отобразить по URL можно так:</p>\n\n<pre><code>string svgcontent=\"\";\n\nif (uri.IsFile)\n{\n    svgcontent = File.ReadAllText(uri.LocalPath);\n}\nelse\n{\n    var client = new System.Net.WebClient();\n    using (client)\n    {\n        svgcontent = client.DownloadString(uri);\n    }\n}\n\nMemoryStream ms = new MemoryStream();\nSvgConvert.ToBitmap(svgcontent, 500,500, ms);                        \n\nBitmapImage bi = new BitmapImage();\nbi.BeginInit();\nbi.CacheOption = BitmapCacheOption.OnLoad;\nbi.StreamSource = ms;\nbi.EndInit();\n\nImage image = new Image();            \nimage.Source = bi;\ntextblock.Inlines.Add(image);\n</code></pre>\n"}