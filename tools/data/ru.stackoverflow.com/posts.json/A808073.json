{"owner":{"reputation":22868,"user_id":32793,"user_type":"registered","accept_rate":48,"profile_image":"https://i.stack.imgur.com/6Vktl.jpg?s=128&g=1","display_name":"iluxa1810","link":"https://ru.stackoverflow.com/users/32793/iluxa1810"},"is_accepted":false,"score":0,"last_activity_date":1522609219,"last_edit_date":1522609219,"creation_date":1522608585,"answer_id":808073,"question_id":805934,"body":"<p>Поиски привели меня на <a href=\"https://wordmvp.com/FAQs/MacrosVBA/GetRowColSpan.htm\" rel=\"nofollow noreferrer\">сайт</a>, где я нашел такое решение для определения объеденных строчек:</p>\n\n<pre><code>int GetRowSpan(Cell cell)\n{\n    cell.Select();\n    return (int)_wordApp.Selection.Information[WdInformation.wdEndOfRangeRowNumber] - (int)_wordApp.Selection.Information[WdInformation.wdStartOfRangeRowNumber] + 1;\n}\n</code></pre>\n\n<p>К сожалению, ничего подобного я не нашел для объеденных колонок...</p>\n\n<p>Написал свое решение, но не думаю, что оно универсальное:</p>\n\n<pre><code>int GetColumnSpan(WordTable table, Cell cell)\n    {\n        var columnIndex = cell.ColumnIndex;\n        var etalonSize = table.Cell(1, columnIndex).Width;\n        if (cell.Width - etalonSize &lt; 0.5)\n        {\n            return 1;\n        }\n        var curWidth = cell.Width;\n        var mergCount = 1;\n        while (curWidth - etalonSize &gt; 0.5)\n        {\n            curWidth -= etalonSize;\n            mergCount++;\n        }\n        return mergCount;\n    }\n</code></pre>\n\n<p>Суть в том, что на вход я подаю эталонную ширину ячейки, а затем сравниваю ее с текущей. Если ширина болье => ячейка объеденена...</p>\n\n<p>Если у кого-то есть мысли лучше, то пишите.</p>\n"}