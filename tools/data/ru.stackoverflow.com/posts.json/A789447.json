{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":1,"last_activity_date":1519415008,"creation_date":1519415008,"answer_id":789447,"question_id":699154,"body":"<p>Для NET 3.5 и более ранних версий можно получить список сборок через свойство <em>Process.Modules</em>: </p>\n\n<pre><code>Process pr=Process.GetProcessesByName(\"devenv\")[0];\nvar x = pr.Modules;//получение списка модулей\n\n/*Для каждой управляемой DLL в списке будет ее Native Image - файл \"*.ni.dll\"*/\n\nforeach (ProcessModule y in x)\n{\n    if (y.ModuleName.EndsWith(\"ni.dll\"))\n    {\n        Console.WriteLine(y.ModuleName.Replace(\".ni.dll\",\".dll\"));\n    }\n}\n</code></pre>\n\n<p>В NET 4.0 и более поздних версиях механизм загрузки сборок был изменен, так что не для всех грузится Native Image через <em>LoadLibrary</em> и, соответственно, не все они появятся в списке модулей. Для получения полного списка сборок можно использовать библиотеку <a href=\"https://github.com/Microsoft/clrmd\" rel=\"nofollow noreferrer\">Microsoft.Diagnostics.Runtime</a>:</p>\n\n<pre><code>public string GetProcessAssemblies(Process pr)\n{\n        int pid = pr.Id;\n\n        DataTarget dt;\n\n        //присоединяемся к процессу\n        using (dt = DataTarget.AttachToProcess(pid, 5000, AttachFlag.Passive))\n        {\n            StringBuilder sb = new StringBuilder(600);\n\n            //получаем загруженные версии CLR\n            foreach (ClrInfo clrVersion in dt.ClrVersions)\n            {\n                string s = clrVersion.TryGetDacLocation();\n                var runtime = dt.CreateRuntime(s);\n\n                sb.AppendLine(\"CLR \" + clrVersion.ToString());\n                sb.AppendLine();\n\n                //получаем список модулей для данной версии CLR\n                foreach (ClrModule module in runtime.EnumerateModules())\n                {\n                    if (module.IsFile)\n                        sb.AppendLine(module.Name);\n                }\n                sb.AppendLine();\n\n            }\n            return sb.ToString();\n        }           \n\n}\n</code></pre>\n\n<p>Источник: <a href=\"https://blogs.msdn.microsoft.com/dsvc/2015/12/16/enumerating-all-modules-in-a-managed-process/\" rel=\"nofollow noreferrer\">Steve Horne - Enumerating all Modules in a Managed Process</a></p>\n"}