{"owner":{"reputation":16068,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":1,"last_activity_date":1533628347,"creation_date":1533628347,"answer_id":865353,"question_id":864742,"body":"<p><code>C:\\WINDOWS\\system32\\config\\systemprofile</code> - это путь к профилю для пользователя SYSTEM. Если вам нужен профиль другого пользователя, запускайте сервис от его имени, или найдите путь для конкретного пользователя (у SYSTEM для этого достаточно прав). Это можно сделать как-то так:</p>\n\n<ol>\n<li><p>Получить токен пользователя через <a href=\"https://msdn.microsoft.com/a6d880a0-0aed-4bdb-89c9-4f667ecb510e\" rel=\"nofollow noreferrer\">LogonUser</a></p></li>\n<li><p>Загрузить его профиль через <a href=\"https://docs.microsoft.com/ru-ru/windows/desktop/api/userenv/nf-userenv-loaduserprofilew\" rel=\"nofollow noreferrer\">LoadUserProfile</a></p></li>\n<li><p>Получить путь к нужной папке с помощью <a href=\"https://docs.microsoft.com/ru-ru/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath\" rel=\"nofollow noreferrer\">SHGetKnownFolderPath</a>, передав ей полученный токен</p></li>\n</ol>\n"}