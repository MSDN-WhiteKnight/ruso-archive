{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":2,"last_activity_date":1554204422,"creation_date":1554204422,"answer_id":964542,"question_id":964230,"body":"<p>Как вариант, использовать WMI. Каждый экземпляр имеет свою службу с именем вида <code>MSSQL$&lt;instance&gt;</code> для именованных экземпляров или <code>MSSQLSERVER</code> для экземпляра по умолчанию (Документировано здесь: <a href=\"https://docs.microsoft.com/ru-ru/sql/database-engine/configure-windows/manage-the-database-engine-services?view=sql-server-2017#using-the-sql-server-service\" rel=\"nofollow noreferrer\">Использование службы SQL Server</a>). Это приводит нас к такому коду для получения имени экземпляра:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Management;\n//Reference: System.Management\n\npublic static IEnumerable&lt;string&gt; GetSqlServers()\n{\n    var mos = new ManagementObjectSearcher(\n        \"SELECT Name FROM Win32_Service WHERE Name LIKE 'MSSQL$%' OR Name='MSSQLSERVER'\");\n    using (mos)\n    {\n        var moc = mos.Get();\n        using (moc)\n        {\n            foreach (ManagementObject mo in moc)\n            {\n                string res = mo.Properties[\"Name\"].Value as string;\n                if (res == null) continue;\n\n                int index = res.IndexOf('$');\n                if (index &lt; 0) yield return \"\";\n                else yield return res.Substring(index + 1);\n            }\n        }\n    }\n}\n\n//...\n\nstring DataSource = \".\\\\\" + GetSqlServers().First();\n</code></pre>\n"}