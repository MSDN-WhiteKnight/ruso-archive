{"owner":{"reputation":16137,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":2,"last_activity_date":1546891103,"creation_date":1546891103,"answer_id":929441,"question_id":929420,"body":"<p>В Windows можно установить иконку для всех файлов определенного расширения, создав ключи в реестре:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Text;\nusing Microsoft.Win32;\nusing System.Runtime.InteropServices;\n\nnamespace ConsoleTest\n{    \n    class Program\n    {\n        const uint SHCNE_ASSOCCHANGED = 0x08000000;\n        const uint SHCNF_IDLIST = 0x0000;\n\n        [DllImport(\"shell32.dll\")]\n        static extern void SHChangeNotify(uint wEventId, uint uFlags, IntPtr dwItem1, IntPtr dwItem2);\n\n        public static void SetIcon(string ext, string iconpath, string typename, string typedescr)\n        {\n            RegistryKey key;\n\n            //связываем расширение с типом\n            key = Registry.ClassesRoot.CreateSubKey(ext);\n            using (key)\n            {\n                key.SetValue(\"\", typename);\n            }\n\n            //задаем параметры для типа\n            key = Registry.ClassesRoot.CreateSubKey(typename);\n            using (key)\n            {\n                key.SetValue(\"\", typedescr);\n                RegistryKey subkey=key.CreateSubKey(\"DefaultIcon\");\n                using (subkey)\n                {\n                    subkey.SetValue(\"\", iconpath);\n                }\n            }\n\n            //обновляем кэш иконок проводника\n            SHChangeNotify(SHCNE_ASSOCCHANGED, SHCNF_IDLIST, IntPtr.Zero, IntPtr.Zero);\n        }\n\n        static void Main(string[] args)\n        {\n            SetIcon(\".item\", \"C:\\\\Program Files (x86)\\\\MyApp\\\\item.ico\",\"binitem\",\"Binary file\");            \n            Console.ReadKey();\n        }\n\n    }\n}\n</code></pre>\n\n<p>Файл иконки должен находиться либо в папке Windows, либо в папке Program Files на том же разделе, что и Windows. Если файл лежит в других папках, может не сработать. Изменить иконки на уровне отдельных файлов можно только путем создания своего расширения для проводника. </p>\n\n<p>Источник: <a href=\"https://docs.microsoft.com/en-us/windows/desktop/shell/how-to-assign-a-custom-icon-to-a-file-type\" rel=\"nofollow noreferrer\">How to Assign a Custom Icon to a File Type</a></p>\n"}