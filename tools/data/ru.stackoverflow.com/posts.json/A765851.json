{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":2,"last_activity_date":1514909580,"creation_date":1514909580,"answer_id":765851,"question_id":471177,"body":"<p>Можно использовать функцию <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb762179%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">SHGetFileInfo</a> с параметром SHGFI_EXETYPE:</p>\n\n<pre><code>public const uint SHGFI_EXETYPE = 0x000002000;\n\n[DllImport(\"shell32.dll\", CharSet = CharSet.Auto)]\npublic static extern int SHGetFileInfo(string pszPath, uint dwFileAttributes, IntPtr psfi, \n        uint cbFileInfo, uint uFlags);\n\npublic static void PrintExeType(string file)\n{            \n        int res = SHGetFileInfo(file, 0, IntPtr.Zero, 0, SHGFI_EXETYPE);\n\n        int lowWord = res &amp; 0xffff;\n        int hiWord = res &gt;&gt; 16;\n\n        if (res != 0)\n        {\n            if (hiWord == 0x0000 &amp;&amp; lowWord == 0x5a4d /*MZ*/) \n            {\n                MessageBox.Show(\"DOS application\");\n            }\n            else if (hiWord == 0x0000 &amp;&amp; lowWord == 0x4550 /*PE*/)\n            {\n                MessageBox.Show(\"Console application\");\n            }\n            else if ((hiWord != 0x0000) &amp;&amp; (lowWord == 0x454E/*NE*/ || lowWord == 0x4550 /*PE*/))\n            {\n                MessageBox.Show(\"GUI application\");\n            }\n            else MessageBox.Show(\"Unknown\");\n        }\n        else MessageBox.Show(\"Not executable\");            \n}\n</code></pre>\n"}