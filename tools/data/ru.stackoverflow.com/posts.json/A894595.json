{"owner":{"reputation":16117,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":1,"last_activity_date":1539835351,"creation_date":1539835351,"answer_id":894595,"question_id":866826,"body":"<p>Используя <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537181(v%3dvs.85)\" rel=\"nofollow noreferrer\">Security Zones API</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;Urlmon.h&gt;\n\n\nint main(int argc, char **argv)\n{\n    IInternetSecurityManager *pSecurityManager = NULL;\n    HRESULT hResult = S_OK;\n\n    CoInitialize(NULL);\n    hResult=CoCreateInstance( CLSID_InternetSecurityManager,  NULL, \n                              CLSCTX_INPROC_SERVER, IID_IInternetSecurityManager,\n                              (void **)&amp;pSecurityManager );\n\n    if (SUCCEEDED(hResult))\n    {\n        hResult=pSecurityManager-&gt;SetZoneMapping(\n          URLZONE_INTRANET, L\"https://example.com\", SZM_CREATE \n          );\n\n        if(SUCCEEDED(hResult)) wprintf(L\"Done!\\n\",(UINT)hResult);\n        else wprintf(L\"SetZoneMapping failed: 0x%x\\n\",(UINT)hResult);\n\n        pSecurityManager-&gt;Release();\n    }\n    else{\n        wprintf(L\"CoCreateInstance failed: 0x%x\\n\",(UINT)hResult);\n    }\n\n\n    getchar();\n    return 0;\n}\n</code></pre>\n"}