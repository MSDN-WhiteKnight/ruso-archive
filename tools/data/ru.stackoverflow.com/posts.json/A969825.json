{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":1,"last_activity_date":1555321361,"creation_date":1555321361,"answer_id":969825,"question_id":969166,"body":"<p>Вот так можно:</p>\n\n<pre><code>using System;\nusing System.Runtime.InteropServices;\n\nnamespace ConsoleApp1\n{\n    class Program\n    {\n        public static void Main(string[] argv)\n        {\n            object sess=null;\n            object search = null;\n            object coll = null;\n\n            try\n            {\n                sess = Activator.CreateInstance(Type.GetTypeFromProgID(\"Microsoft.Update.Session\",\"compname\"));\n                search = (sess as dynamic).CreateUpdateSearcher();\n\n                int n = (search as dynamic).GetTotalHistoryCount();\n                coll = (search as dynamic).QueryHistory(1, n);\n\n                Console.WriteLine(\"Updates\");\n                foreach (dynamic item in coll as dynamic)\n                {\n                    if (item.Operation == 1) Console.WriteLine(item.Title);\n                }\n            }\n            finally\n            {\n                if (sess != null) Marshal.ReleaseComObject(sess);\n                if (search != null) Marshal.ReleaseComObject(search);\n                if (coll != null) Marshal.ReleaseComObject(coll);\n            }\n        }\n    }\n}\n</code></pre>\n"}