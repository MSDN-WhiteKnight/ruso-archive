{"owner":{"reputation":170,"user_id":178957,"user_type":"registered","accept_rate":100,"profile_image":"https://i.stack.imgur.com/EUHBb.jpg?s=128&g=1","display_name":"Sergey_73","link":"https://ru.stackoverflow.com/users/178957/sergey-73"},"is_accepted":false,"score":2,"last_activity_date":1557858448,"creation_date":1557858448,"answer_id":981429,"question_id":981332,"body":"<p>Попробуй мой пример, мне помог скрыть процесс. Даже Viber скрывает, только в трее висит, но раскрыть нельзя. Сейчас несколько программ протестировал, вроде скрывает. Не знаю что у тебя за программа, но попробуй, может поможет. Тестировал на Windows 10 x64.</p>\n\n<pre><code>    [DllImport(\"shell32.dll\", CharSet = CharSet.Auto)]\n    public static extern bool ShellExecuteEx(ref SHELLEXECUTEINFO lpExecInfo);\n\n    [StructLayout(LayoutKind.Sequential)]\n    public struct SHELLEXECUTEINFO\n    {\n        public int cbSize;\n        public uint fMask;\n        public IntPtr hwnd;\n        [MarshalAs(UnmanagedType.LPTStr)]\n        public string lpVerb;\n        [MarshalAs(UnmanagedType.LPTStr)]\n        public string lpFile;\n        [MarshalAs(UnmanagedType.LPTStr)]\n        public string lpParameters;\n        [MarshalAs(UnmanagedType.LPTStr)]\n        public string lpDirectory;\n        public int nShow;\n        public IntPtr hInstApp;\n        public IntPtr lpIDList;\n        [MarshalAs(UnmanagedType.LPTStr)]\n        public string lpClass;\n        public IntPtr hkeyClass;\n        public uint dwHotKey;\n        public IntPtr hIcon;\n        public IntPtr hProcess;\n    }\n\n    public enum ShowCommands : int\n    {\n        SW_HIDE = 0,\n        SW_SHOWNORMAL = 1,\n        SW_NORMAL = 1,\n        SW_SHOWMINIMIZED = 2,\n        SW_SHOWMAXIMIZED = 3,\n        SW_MAXIMIZE = 3,\n        SW_SHOWNOACTIVATE = 4,\n        SW_SHOW = 5,\n        SW_MINIMIZE = 6,\n        SW_SHOWMINNOACTIVE = 7,\n        SW_SHOWNA = 8,\n        SW_RESTORE = 9,\n        SW_SHOWDEFAULT = 10,\n        SW_FORCEMINIMIZE = 11,\n        SW_MAX = 11\n    }\n\n    [Flags]\n    public enum ShellExecuteMaskFlags : uint\n    {\n        SEE_MASK_DEFAULT = 0x00000000,\n        SEE_MASK_CLASSNAME = 0x00000001,\n        SEE_MASK_CLASSKEY = 0x00000003,\n        SEE_MASK_IDLIST = 0x00000004,\n        SEE_MASK_INVOKEIDLIST = 0x0000000c,   // Note SEE_MASK_INVOKEIDLIST(0xC) implies SEE_MASK_IDLIST(0x04) \n        SEE_MASK_HOTKEY = 0x00000020,\n        SEE_MASK_NOCLOSEPROCESS = 0x00000040,\n        SEE_MASK_CONNECTNETDRV = 0x00000080,\n        SEE_MASK_NOASYNC = 0x00000100,\n        SEE_MASK_FLAG_DDEWAIT = SEE_MASK_NOASYNC,\n        SEE_MASK_DOENVSUBST = 0x00000200,\n        SEE_MASK_FLAG_NO_UI = 0x00000400,\n        SEE_MASK_UNICODE = 0x00004000,\n        SEE_MASK_NO_CONSOLE = 0x00008000,\n        SEE_MASK_ASYNCOK = 0x00100000,\n        SEE_MASK_HMONITOR = 0x00200000,\n        SEE_MASK_NOZONECHECKS = 0x00800000,\n        SEE_MASK_NOQUERYCLASSSTORE = 0x01000000,\n        SEE_MASK_WAITFORINPUTIDLE = 0x02000000,\n        SEE_MASK_FLAG_LOG_USAGE = 0x04000000,\n    }\n\n    public Form1()\n    {\n        InitializeComponent();\n        RunProcess();\n    }\n\n    void RunProcess()\n    {\n        bool res = false;\n        string program = @\"C:\\Директория где находится программа для запуска\";\n        SHELLEXECUTEINFO sh = new SHELLEXECUTEINFO();\n        sh.cbSize = Marshal.SizeOf(sh);\n        sh.lpVerb = \"open\";\n        sh.lpParameters = \"\";\n        sh.lpFile = \"Viber.exe\";\n        sh.lpDirectory = program;\n        sh.fMask = (uint)ShellExecuteMaskFlags.SEE_MASK_NOCLOSEPROCESS;\n        sh.nShow = (int)ShowCommands.SW_HIDE;\n        res = ShellExecuteEx(ref sh);\n    }\n</code></pre>\n"}