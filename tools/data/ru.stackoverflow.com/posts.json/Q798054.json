{"tags":["c#","winforms","com-порт"],"owner":{"reputation":141,"user_id":251182,"user_type":"registered","accept_rate":56,"profile_image":"https://lh3.googleusercontent.com/-uOSFomXIuGU/AAAAAAAAAAI/AAAAAAAAABQ/bY7hgA9mZjo/photo.jpg?sz=128","display_name":"George Tuzikov","link":"https://ru.stackoverflow.com/users/251182/george-tuzikov"},"is_answered":true,"view_count":429,"accepted_answer_id":798312,"answer_count":1,"score":1,"last_activity_date":1521126835,"creation_date":1521022660,"last_edit_date":1521114769,"question_id":798054,"link":"https://ru.stackoverflow.com/questions/798054/%d0%92%d1%8b%d0%b2%d0%be%d0%b4-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d0%b8-%d0%be-com-%d0%bf%d0%be%d1%80%d1%82%d0%b5","title":"Вывод информации о COM-порте","body":"<p>Надо написать программу, которая будет выводить в ComboBox список подключенных Com портов. При выборе одного из этих портов в элемент управления TexBox выводятся данные об этом порте. С первой задачей я справился, но вот со второй проблема- не могу получить данные о конкретном порте. Как это можно сделать?<br>\nКод программы:  </p>\n\n<pre><code>using System.IO.Ports;\nusing System.Threading;\nusing System.Windows.Forms;\nusing System.Management;\n\nnamespace COM_Ports_Finder\n{\n  public partial class Main : Form\n  {\n    // Создаем поток\n    Thread Com_Refresher;\n    // Флаг работы потока\n    bool To_Work = true;\n    // Предыдущие порты\n    string[] Last_Ports = new string[0];\n\n    public Main()\n    {\n        // Инициализация\n        InitializeComponent();\n        // Задаем потоку задачу\n        Com_Refresher = new Thread(Refresh_Com_Ports);\n        // Запускаем поток\n        Com_Refresher.Start();\n    }\n\n\n    private void Refresh_Com_Ports()\n    // Функция обновления порта\n    {\n        // Пока надо работать\n        while (To_Work)\n        {\n\n            // Получаем список доступных портов\n            string[] Ports = SerialPort.GetPortNames();\n            // Если порты не совпадают\n            if (!Is_Arrays_Equeals(Ports, Last_Ports))\n            {\n                // Очистить поля\n                Clear_Fields();\n                // Добавить порты в список\n                Add_Ports(Ports);\n                // Изменить размер Last_Ports\n                System.Array.Resize(ref Last_Ports, Ports.Length);\n                // Записать данные в Last_Ports\n                Last_Ports = Ports;\n            }\n            // Останавливаем поток на 100 мс\n            Thread.Sleep(100);\n        }\n    }  \n\n    private void Main_FormClosing(object sender, FormClosingEventArgs e)\n    // Закрытие формы\n    {\n        // Останавливаем поток\n        To_Work = false;\n        // Останавливаем поток\n        Com_Refresher.Abort();\n        // Ждем остановки потока\n        while(Com_Refresher.ThreadState != ThreadState.Aborted);\n    }\n\n    private void Com_Ports_CBox_SelectedIndexChanged(object sender, System.EventArgs e)\n    // Выбор значения в CBox\n    {\n        // Найденные порты\n        ManagementObjectCollection Ports;\n        // Поисковик данных\n        ManagementObjectSearcher Ports_Found;\n        // Находим порты по запросу\n        Ports_Found = new ManagementObjectSearcher(\"Select * from Win32_SerialPort\");\n        // Записываем полученные данные\n        Ports = Ports_Found.Get();\n        // Для всех полученных данных\n        foreach (ManagementObject Port in Ports)\n        {\n            // Выдать информацию\n            Information_TBox.Text  = Port[\"DeviceID\"].ToString() + \"\\r\\n\";\n            Information_TBox.Text += Port[\"PNPDeviceID\"].ToString() + \"\\r\\n\";\n            Information_TBox.Text += Port[\"Name\"].ToString() + \"\\r\\n\";\n            Information_TBox.Text += Port[\"Caption\"].ToString() + \"\\r\\n\";\n            Information_TBox.Text += Port[\"Description\"].ToString() + \"\\r\\n\";\n            Information_TBox.Text += Port[\"ProviderType\"].ToString() + \"\\r\\n\";\n            Information_TBox.Text += Port[\"Status\"].ToString();\n        }\n    }\n\n    private void Clear_Fields()\n    // Функция очистки полей\n    {\n        // В основном потоке\n        Com_Ports_CBox.Invoke((MethodInvoker)delegate ()\n        {\n            // Очищаем CBox\n            Com_Ports_CBox.Items.Clear();\n            // Очищаем TBox\n            Information_TBox.Text = \"\";\n        });\n    }\n\n    private void Add_Ports(string[] Ports)\n    // Функция добавления портов в список\n    {\n        // Для всех портов\n        foreach (string Port in Ports)\n        {\n            // В основном потоке\n            Com_Ports_CBox.Invoke((MethodInvoker)delegate ()\n            {\n                // Добавляем элемент в CBox\n                Com_Ports_CBox.Items.Add(Port);\n            });\n        }\n    }\n\n    private bool Is_Arrays_Equeals(string[] First, string[] Second)\n    // Проверка массивов на идентичность\n    {\n        // Совпадают ли порты\n        bool Is_Equeals = true;\n        // Если порты одинаковых размеров\n        if (First.Length == Second.Length)\n        {\n            // Для всех портов\n            for (int i = 0; i &lt; First.Length; i++)\n            {\n                // Если порты не совпадают\n                if (First[i] != Second[i])\n                {\n                    // Порты не совпадают\n                    Is_Equeals = false;\n                }\n            }\n        }\n        // Если порты не одного размера\n        else\n        {\n            // Порты не совпадают\n            Is_Equeals = false;\n        }\n        // Вернуть ответ\n        return Is_Equeals;\n    }\n  }\n}\n</code></pre>\n\n<p>UPDATE: выполнение команды <code>wmic path Win32_PnPEntity where \"ClassGuid = '{4d36e978-e325-11ce-bfc1-08002be10318}'\" get / value</code><br>\n<a href=\"https://i.stack.imgur.com/gGbol.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gGbol.png\" alt=\"введите сюда описание изображения\"></a></p>\n"}