{"tags":["c#","wpf","windowsinstaller"],"owner":{"reputation":53,"user_id":339447,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/8fa706e7b25ad49ae9d3c934f4f3a715?s=128&d=identicon&r=PG&f=1","display_name":"patrik","link":"https://ru.stackoverflow.com/users/339447/patrik"},"is_answered":true,"view_count":92,"answer_count":1,"score":2,"last_activity_date":1559711660,"creation_date":1559551458,"last_edit_date":1559711660,"question_id":988674,"link":"https://ru.stackoverflow.com/questions/988674/c-wpf-%d0%9e%d1%82%d0%be%d0%b1%d1%80%d0%b0%d0%b6%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bd%d0%b0-%d1%84%d0%be%d1%80%d0%bc%d0%b5-%d1%85%d0%be%d0%b4%d0%b0-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%ba%d0%b8-msi-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d1%89%d0%b8%d0%ba%d0%b0","title":"C# WPF Отображение на форме хода установки msi установщика","body":"<p>Через мою программу запускается msi установщик. Есть ли способ отследить ход установки и вывести его на форму?</p>\n\n<pre><code>public void install_uninstall(string _targetIpAddress)\n{\n    //string _targetIpAddress = (string)PC;\n    string[] directum = { \"1.msi\", \"2.msi\", \"3.msi\" };\n\n    string retVal = \"\";\n\n    ConnectionOptions options = new ConnectionOptions();\n    //options.Username = @\"domain\\username\";\n    //options.Password = \"password\";\n    ManagementScope scope = new ManagementScope((\"\\\\\\\\\" + _targetIpAddress + \"\\\\root\\\\cimv2\"), options);\n    scope.Connect();\n\n\n\n    ManagementObjectSearcher searcher;\n    SelectQuery query;\n    EnumerationOptions enumOptions;\n    ManagementPath p = new ManagementPath(\"Win32_Product\");\n    ManagementClass classInstance = new ManagementClass(scope, p, null);\n    ManagementBaseObject inParams = classInstance.GetMethodParameters(\"Install\");\n    ManagementBaseObject outParams;\n    inParams[\"AllUsers\"] = true;\n    inParams[\"Options\"] = string.Empty;\n\n    if (programs.Contains(\"1\"))\n    {\n        thisTime = DateTime.Now;\n        percent = 100 / 6F;\n\n        Dispatcher.BeginInvoke(new ThreadStart(delegate { text_install.Document.Blocks.Add(new Paragraph(new Run(thisTime + \" Удаление...\"))); ProgressBar.IsIndeterminate = false; PercentText.Visibility = Visibility.Visible; }));\n\n\n    thisTime = DateTime.Now;\n    Dispatcher.BeginInvoke(new ThreadStart(delegate { text_install.Document.Blocks.Add(new Paragraph(new Run(thisTime + \" Установка...\"))); }));\n\n    foreach (var item in dir)\n    {\n        inParams[\"PackageLocation\"] = @\"\\\\\" + _targetIpAddress + @\"\\d$\\Dir\\\" + item;\n        outParams = classInstance.InvokeMethod(\"Install\", inParams, null);\n        retVal = outParams[\"ReturnValue\"].ToString();\n\n        retVal_install(dir, inParams, retVal, item);\n    }\n}\n</code></pre>\n"}