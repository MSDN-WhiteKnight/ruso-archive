{"owner":{"reputation":97,"user_id":291056,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/d0686ffa9225c2710cd3dc1683e9e9dd?s=128&d=identicon&r=PG","display_name":"Aleks Keller","link":"https://ru.stackoverflow.com/users/291056/aleks-keller"},"is_accepted":true,"score":0,"last_activity_date":1548268373,"creation_date":1548268373,"answer_id":935834,"question_id":931706,"body":"<p>Как всё заработало в итоге.</p>\n\n<pre><code>//виртуальный буфер (глобальная переменная)\nprivate RichTextBox _richTextBox = new RichTextBox();\n\n//название файла для сохранения\nstring target = \"Договор №\" + CurrentCredit.Number + \".doc\";\n//грузим шаблон в RichTextBox - контрол сам порешает за все кодировки\n_richTextBox.LoadFile(Storage.AgreementTemplateFile, RichTextBoxStreamType.RichText);\n//магия\nReplace(\"#nomer#\", CurrentCredit.Number.ToString());\n//при сохранении о кодировке опять-таки позаботится RichTextBox\n_richTextBox.SaveFile(target);\n\n//главное - функция Replace:\n\nprivate void Replace(string from, string to)\n{\n    int start = _richTextBox.Find(from, 0, RichTextBoxFinds.None);\n    _richTextBox.Select(start, from.Length);\n    _richTextBox.SelectedText = to;\n}\n</code></pre>\n"}