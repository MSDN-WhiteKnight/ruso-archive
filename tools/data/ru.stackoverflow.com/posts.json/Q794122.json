{"tags":["c#","wpf","ресурсы","assembly"],"owner":{"reputation":410,"user_id":264042,"user_type":"registered","accept_rate":93,"profile_image":"https://www.gravatar.com/avatar/82b53fe6b98d09b1140dc580d96279b2?s=128&d=identicon&r=PG&f=1","display_name":"Arasfon","link":"https://ru.stackoverflow.com/users/264042/arasfon"},"is_answered":true,"view_count":262,"accepted_answer_id":795275,"answer_count":1,"score":1,"last_activity_date":1520519432,"creation_date":1520277455,"last_edit_date":1520446976,"question_id":794122,"link":"https://ru.stackoverflow.com/questions/794122/%d0%a0%d0%b0%d0%b7%d0%b1%d0%be%d1%80-dll-%d0%b8-%d0%b4%d0%be%d0%b1%d0%b0%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b5-%d0%b8%d1%85-%d0%b2-%d0%bf%d1%80%d0%be%d0%b3%d1%80%d0%b0%d0%bc%d0%bc%d1%83","title":"Разбор dll и добавление их в программу","body":"<p>Есть программа, которая должна выполнять очень сложную функцию (прошу помочь в её реализации):</p>\n\n<blockquote>\n  <p>Есть dll. В ней лежит текстовый файл с примерно такой структурой:</p>\n</blockquote>\n\n<pre><code>{\n    MainWindow=\"MainWindow.xaml\"\n    Code=\"MainWindow.xaml.cs\"\n    Pattern=WPFStandart\n}\n</code></pre>\n\n<blockquote>\n  <p>Запарсить я его смогу, но мне нужно как-то использовать окно с логикой, описанное в этой dll, причём dll должна лежать в папке с проектом, название у dll всегда разное (знаю как узнать его), и через Visual Studio в зависимости не добавишь, из-за названия и всегда разного содержимого (разрабы разные, а точнее их команды).</p>\n</blockquote>\n\n<p>Вся информация изначально хранится внутри dll в файле pkginfo.txt, который лежит в корне с проектом (компилируется как внедряемый при сборке ресурс), желательно, чтобы окно открывалось без локального копирования (\"разархивации длл-ки\").</p>\n\n<p><strong>Update</strong>\nЯ нашёл способ с </p>\n\n<pre><code>[DllImport(\"name.dll\")]\npublic static extern void VoidInDll();\n</code></pre>\n\n<p>Но у меня название открываемого DLL задаёт пользователь, а <code>DllImport</code> принимает только константы. \nЖду варианты...</p>\n"}