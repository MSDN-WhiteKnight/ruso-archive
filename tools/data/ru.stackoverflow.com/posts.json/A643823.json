{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":2,"last_activity_date":1520941177,"last_edit_date":1520941177,"creation_date":1490374474,"answer_id":643823,"question_id":643795,"body":"<p>Вызвать диалог открытия файла, конечно, можно в любом приложении</p>\n\n<p>Самый простой способ - <a href=\"https://msdn.microsoft.com/en-us/library/ms646829(v=vs.85).aspx#open_file\" rel=\"nofollow noreferrer\">с помощью GetOpenFileName</a></p>\n\n<pre><code>OPENFILENAME ofn;       // common dialog box structure\nchar szFile[260];       // buffer for file name\nHWND hwnd;              // owner window\nHANDLE hf;              // file handle\n// Initialize OPENFILENAME\nZeroMemory(&amp;ofn, sizeof(ofn));\nofn.lStructSize = sizeof(ofn);\nofn.hwndOwner = hwnd;\nofn.lpstrFile = szFile;\n// Set lpstrFile[0] to '\\0' so that GetOpenFileName does not \n// use the contents of szFile to initialize itself.\nofn.lpstrFile[0] = '\\0';\nofn.nMaxFile = sizeof(szFile);\nofn.lpstrFilter = \"All\\0*.*\\0Text\\0*.TXT\\0\";\nofn.nFilterIndex = 1;\nofn.lpstrFileTitle = NULL;\nofn.nMaxFileTitle = 0;\nofn.lpstrInitialDir = NULL;\nofn.Flags = OFN_PATHMUSTEXIST | OFN_FILEMUSTEXIST;\n// Display the Open dialog box. \nif (GetOpenFileName(&amp;ofn)==TRUE) \n    hf = CreateFile(ofn.lpstrFile, \n                    GENERIC_READ,\n                    0,\n                    (LPSECURITY_ATTRIBUTES) NULL,\n                    OPEN_EXISTING,\n                    FILE_ATTRIBUTE_NORMAL,\n                    (HANDLE) NULL);\n</code></pre>\n\n<p>Не забудьте подключить windows.h, если еще этого не сделали.</p>\n\n<p>COM-интерфейс <a href=\"https://msdn.microsoft.com/en-us/library/bb776913(v=vs.85).aspx\" rel=\"nofollow noreferrer\">IFileDialog</a> предоставляет больше возможностей, но сложнее в использовании.</p>\n"}