{"owner":{"reputation":16068,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":1,"last_activity_date":1525246451,"creation_date":1525246451,"answer_id":822054,"question_id":818605,"body":"<p>По итогам обсуждения в комментариях:</p>\n\n<ol>\n<li><p>Приведенный в вопросе код работает, если обращаться к 32-битному приложению из 32-битного (или к 64-битному из 64-битного).</p></li>\n<li><p>Если нужно обращаться к приложению другой битности, нужно избавиться от типа <em>IntPtr</em> в структуре <em>LVITEM</em> и заменить его на тип, который ожидает целевое приложение: например, <em>Int32</em>, если целевое приложение 32-битное. </p></li>\n</ol>\n\n<p>Дело в том, что размер типа <em>IntPtr</em> зависит от целевой архитектуры выполняющегося приложения; если данные передаются в приложение с другой целевой архитектурой, они будут с его точки зрения некорректны. Поэтому нужно использовать тип с фиксированным размером.</p>\n"}