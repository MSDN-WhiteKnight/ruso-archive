{"owner":{"reputation":16117,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":0,"last_activity_date":1537766485,"creation_date":1537766485,"answer_id":884755,"question_id":884278,"body":"<p>Установите свойство AllowDrop и обработайте события DragEnter и DragDrop:</p>\n\n<pre><code>public Form1()\n{\n    InitializeComponent();\n    dataGridView1.AllowDrop = true;\n    dataGridView1.DragDrop += new System.Windows.Forms.DragEventHandler(this.DataGridView_DragDrop);\n    dataGridView1.DragEnter += new System.Windows.Forms.DragEventHandler(this.DataGridView_DragEnter);\n}\n\nprivate void DataGridView_DragEnter(object sender, DragEventArgs e)\n{\n    e.Effect = DragDropEffects.Copy;\n}\n\nprivate void DataGridView_DragDrop(object sender, DragEventArgs e)\n{\n    object val;\n    string filepath = \"\";\n    bool found = false;\n\n    //получаем список форматов DragAndDrop\n    IDataObject data = e.Data;\n    string[] formats = data.GetFormats();            \n\n    //найдем в форматах данные Проводника\n    foreach (var fmt in formats)\n    {\n        //Проводник передает перетаскиваемый файл в виде форматов FileDrop и/или FileNameW,\n        //данными для которых является строка или массив строк\n\n        if (fmt == \"FileDrop\" || fmt == \"FileNameW\")\n        {\n            val = data.GetData(fmt);\n            if (val == null) continue;\n\n            if (val is string)\n            {\n                filepath = val as string;\n                found = true;\n                break;\n            }\n            else if (val is string[])\n            {\n                string[] array = val as string[];\n                if (array.Length &gt; 0)\n                {\n                    filepath = array[0];\n                    found = true;\n                    break;\n                }\n            }\n        }\n    }\n\n    if (!found) return; //ничего не найдено\n\n    //добавляем в DataGridView\n    DataGridViewCell cell = new DataGridViewTextBoxCell();\n    cell.Value = filepath;\n    DataGridViewRow row = new DataGridViewRow();\n    row.Cells.Add(cell);\n    dataGridView1.Rows.Add(row);\n}\n</code></pre>\n"}