{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":4,"last_activity_date":1519195348,"last_edit_date":1519195348,"creation_date":1519190793,"answer_id":788087,"question_id":787805,"body":"<p>Путь к конфигурации имеет следующий вид:</p>\n\n<p><code>%LOCALAPPDATA%\\(Company name)\\(EXE file name)_(AppDomain ID)\\(Version)\\user.config</code></p>\n\n<p><em>(Company name)</em> - это имя компании, которое берется из атрибута <code>AssemblyCompany</code> в свойствах сборки. </p>\n\n<pre><code>var ass = System.Reflection.Assembly.GetExecutingAssembly();\nvar attr =  ass.GetCustomAttributes( typeof(System.Reflection.AssemblyCompanyAttribute),true);\nif (attr.Length &gt; 0)\n{\n    string company = ((System.Reflection.AssemblyCompanyAttribute)attr[0]).Company;                    \n}\n</code></pre>\n\n<p>Если этот атрибут пустой или состоит из неподходящих символов, вместо него .NET пытается использовать аналогичную строку из <code>FileVersionInfo</code>. Если и она пустая, используется первая (до точки) часть пространства имен, в котором расположен класс <em>Program</em> (<code>assembly.EntryPoint.ReflectedType.Namespace</code>). Полный алгоритм выбора этой строки можно посмотреть в <a href=\"https://referencesource.microsoft.com/#System.Configuration/System/Configuration/ClientConfigPaths.cs,17d647bae0e63e77,references\" rel=\"nofollow noreferrer\">исходнике</a>.</p>\n\n<p>Итоговый путь к конфигу можно получить программно так (добавить ссылку на System.Configuration):</p>\n\n<pre><code>System.Configuration.Configuration config =\n    System.Configuration.ConfigurationManager.OpenExeConfiguration(\n    System.Configuration.ConfigurationUserLevel.PerUserRoamingAndLocal                \n);\nMessageBox.Show(config.FilePath);\n</code></pre>\n"}