{"tags":["c#",".net","com"],"owner":{"reputation":4994,"user_id":206435,"user_type":"registered","accept_rate":78,"profile_image":"https://www.gravatar.com/avatar/aff8ab0e5f74d01facde887535318d53?s=128&d=identicon&r=PG","display_name":"ヒミコ","link":"https://ru.stackoverflow.com/users/206435/%e3%83%92%e3%83%9f%e3%82%b3"},"is_answered":true,"view_count":41,"accepted_answer_id":911167,"answer_count":1,"score":3,"last_activity_date":1543131767,"creation_date":1543112936,"question_id":911136,"link":"https://ru.stackoverflow.com/questions/911136/%d0%9f%d0%be%d1%87%d0%b5%d0%bc%d1%83-%d0%b2%d1%8b%d0%b7%d0%be%d0%b2-%d0%bc%d0%b5%d1%82%d0%be%d0%b4%d0%b0-%d1%83-com-%d0%be%d0%b1%d1%8a%d0%b5%d0%ba%d1%82%d0%b0-%d0%b1%d1%80%d0%be%d1%81%d0%b0%d0%b5%d1%82-%d0%b8%d1%81%d0%ba%d0%bb%d1%8e%d1%87%d0%b5%d0%bd%d0%b8%d0%b5","title":"Почему вызов метода у Com объекта бросает исключение","body":"<p>Как известно, что бы узнать кол-во доступных видео адаптеров через интерфейс <code>DXGI</code>, необходимо вызывать метод <code>EnumAdapters</code> до тех пор, пока данный метод не вернет значение <code>DXGI_ERROR_NOT_FOUND</code>. </p>\n\n<p>Казалось бы, будет перечислять через цикл <code>while</code>:</p>\n\n<pre><code>    static void Main(string[] args)\n    {\n        int result = Manager.CreateDxgiFactory(out IDXGIFactory factory);\n\n        if (result != 0)\n        {\n            Exception erForHr = Marshal.GetExceptionForHR(result);\n            throw erForHr;\n        }\n\n        uint count = 0;\n        while (factory.EnumAdapters(count, out _) == 0)\n        {\n            count++;\n        }\n        ...\n    }\n</code></pre>\n\n<p>Но не тут то было! Как только значение <code>count</code> станет больше чем доступно адаптеров, получаем исключение...</p>\n\n<blockquote>\n  <p>Объект не найден. При вызове IDXGIFactory::EnumAdaptes отсутствует\n  адаптер с указанным порядковым номером. (Исключение из HRESULT:\n  0x887A0002)</p>\n</blockquote>\n\n<p>Почему, и как платформа <code>.NET</code> обнаруживает то что произошло исключение, если в коде самостоятельно нигде не бросается исключение?</p>\n\n<p>Как отключить данный функционал, т.к. надо перечислять пока есть доступные адаптеры?</p>\n\n<p>Или необходимо оборачивать код в <code>try/catch</code> и в блоке <code>catch</code> выходить из цикла?</p>\n"}