{"tags":["c#","windows","directshow"],"owner":{"reputation":1415,"user_id":238013,"user_type":"registered","accept_rate":64,"profile_image":"https://www.gravatar.com/avatar/d4dab84aa4c67525aecd5da391a8e68a?s=128&d=identicon&r=PG&f=1","display_name":"D .Stark","link":"https://ru.stackoverflow.com/users/238013/d-stark"},"is_answered":true,"view_count":267,"accepted_answer_id":724245,"answer_count":1,"score":3,"last_activity_date":1519988561,"creation_date":1500815822,"last_edit_date":1500819194,"question_id":696725,"link":"https://ru.stackoverflow.com/questions/696725/%d0%9f%d0%be%d0%bb%d1%83%d1%87%d0%b5%d0%bd%d0%b8%d0%b5-%d0%bf%d0%be%d0%bb%d0%bd%d0%be%d0%b3%d0%be-%d0%b8%d0%bc%d0%b5%d0%bd%d0%b8-%d1%83%d1%81%d1%82%d1%80%d0%be%d0%b9%d1%81%d1%82%d0%b2%d0%b0-%d0%b0%d1%83%d0%b4%d0%b8%d0%be%d0%b7%d0%b0%d1%85%d0%b2%d0%b0%d1%82%d0%b0","title":"Получение полного имени устройства аудиозахвата","body":"<pre><code>ICreateDevEnum devEnum;\nIEnumMoniker enumMoniker;\nIMoniker[] monikers = new IMoniker[1];\nIPropertyBag propBag;\n\ndevEnum = (ICreateDevEnum)Activator.CreateInstance(Type.GetTypeFromCLSID(CLSID_SystemDeviceEnum));\ndevEnum.CreateClassEnumerator(CLSID_AudioInputDeviceCategory, out enumMoniker, 0);\n\nwhile (enumMoniker.Next(1, monikers, IntPtr.Zero) == 0) {\n\n    object variant;\n    object propBagObj;\n\n    monikers[0].BindToStorage(null, null, ref IPropertyBagGuid, out propBagObj);\n    propBag = (IPropertyBag)propBagObj;\n\n    if (propBag.Read(\"FriendlyName\", out variant, null) == 0)\n        System.Windows.MessageBox.Show(variant.ToString() + \" (\" + variant.ToString().Length + \")\");\n}\n</code></pre>\n\n<p>Под Windows 10 этот код у меня работает прекрасно и выводит полное имя микрофона (44 символа). На Windows 7 имя выводится не полное, а лишь первые 31 символ.</p>\n\n<p>Подскажите, что может быть причиной такого поведения и как это починить (возможно, аналогичный более универсальный код)?</p>\n\n<p>На устройствах, сразу скажу, стоят разные версии DirectX (12 (где всё работает) и 11).</p>\n"}