{"tags":["c#","http","пакет","сниффер"],"owner":{"reputation":374,"user_id":247831,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/a5335b85fcd8bf7fb0624ec4dbfa7602?s=128&d=identicon&r=PG&f=1","display_name":"Александр","link":"https://ru.stackoverflow.com/users/247831/%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b0%d0%bd%d0%b4%d1%80"},"is_answered":true,"view_count":515,"accepted_answer_id":846042,"answer_count":1,"score":1,"last_activity_date":1529835452,"creation_date":1529751747,"question_id":845750,"link":"https://ru.stackoverflow.com/questions/845750/%d0%9f%d0%b5%d1%80%d0%b5%d1%85%d0%b2%d0%b0%d1%82-http-%d1%82%d1%80%d0%b0%d1%84%d0%b8%d0%ba%d0%b0","title":"Перехват http-трафика","body":"<p>Подскажите пожалуйста, как перехватывать http-запросы в c#? <strong>Мне нужно просто знать, на какие сайты переходили и всё.</strong></p>\n\n<hr>\n\n<p>Пробовал с помощью SharpPcap перехватывать пакеты, но я не знаю, что с ними делать дальше. Вот код:</p>\n\n<pre><code>// Когда приходит пакет, вызывается это событие\nprivate static void Program_OnPacketArrival(object sender, CaptureEventArgs e)\n{\n    Packet packet = Packet.ParsePacket(e.Packet.LinkLayerType, e.Packet.Data);\n    TcpPacket tcp = (TcpPacket)packet.Extract(typeof(TcpPacket));\n\n    if (tcp != null)\n    {\n        byte[] data = tcp.PayloadData;\n        string res = Encoding.UTF8.GetString(data);\n        Console.WriteLine(res);\n    }\n}\n</code></pre>\n\n<p>Но этот код печатает GET заголовки, и то только тогда, когда сайт не https. Надеюсь я понятно всё спросил. Спасибо.</p>\n"}