{"tags":["c#","roslyn"],"owner":{"reputation":497,"user_id":278293,"user_type":"registered","accept_rate":78,"profile_image":"https://i.stack.imgur.com/rJv3r.jpg?s=128&g=1","display_name":"Luser","link":"https://ru.stackoverflow.com/users/278293/luser"},"is_answered":true,"view_count":97,"accepted_answer_id":886051,"answer_count":1,"score":1,"last_activity_date":1538152286,"creation_date":1537980710,"last_edit_date":1538147611,"question_id":885927,"link":"https://ru.stackoverflow.com/questions/885927/%d0%94%d1%83%d0%b1%d0%bb%d0%b8%d0%ba%d0%b0%d1%82%d1%8b-%d1%81%d1%81%d1%8b%d0%bb%d0%be%d0%ba-mscorlib-%d0%b2-roslyn-%d0%bf%d1%80%d0%b8-%d0%ba%d0%be%d0%bc%d0%bf%d0%b8%d0%bb%d1%8f%d1%86%d0%b8%d0%b8","title":"Дубликаты ссылок mscorlib в Roslyn при компиляции","body":"<p>Путь к <code>.dll</code> файлам брал от сюда: </p>\n\n<p><code>C:\\Program Files (x86)\\Reference Assemblies\\Microsoft\\Framework\\.NETFramework\\</code></p>\n\n<pre><code>List&lt;string&gt; DLL = new List&lt;string&gt;(); //тут уже лежит список путей к .dll\nusing (var provider = new CSharpCodeProvider())\n{\n   // DLL.ToArray() добавляю ссылки \n   var Params = new CompilerParameters() \n   {\n     //parametrs build\n   };\n   provider.CompileAssemblyFromSource(Params, SourceCode) // compile\n}\n</code></pre>\n\n<p>Но во время компиляции получаю ошибку:</p>\n\n<blockquote>\n  <p>error CS1703: Multiple assemblies with equivalent identity have been\n  imported: \n  'C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\mscorlib.dll'  and \n  'C:\\Program Files (x86)\\Reference\\Assemblies\\Microsoft\\Framework.NETFramework\\v3.5\\Profile\\Client\\mscorlib.dll'.</p>\n  \n  <p>Remove one of the duplicate references.</p>\n</blockquote>\n\n<p>Как исправить?</p>\n\n<hr>\n\n<p>[<strong>Дополнительная информация</strong>]</p>\n\n<p>Сам проект скомпилирован под <code>.Net4.5</code> </p>\n\n<p>(специально для <strong>Roslyn</strong>, под другие версии <em>NetFramework</em> его библиотеки он не ставит)</p>\n\n<p>Если брать такой код:</p>\n\n<pre><code>List&lt;string&gt; DLL = new List&lt;string&gt;() // просто файлы\n{\n   \"mscorlib.dll\", \"System.Data.dll\"\n}\nusing (var provider = new CSharpCodeProvider())\n{\n  var Params = new CompilerParameters(DLL.ToArray())\n  {\n     //parametrs build\n  };\n  provider.CompileAssemblyFromSource(Params, SourceCode) // compile\n}\n</code></pre>\n\n<p>То всё работает, но ссылки из <code>List&lt;string&gt;</code> он добавляет от как бы самого проекта ( под котором он скомпилирован ) P.S: Не из папок!</p>\n\n<p>А мне нужно добавить из нужной мне папки, но если я этого делаю (см 1-ый пост )\nто получаю ошибку о том что нельзя добавить библиотеки <code>.dll</code> из разных папок.\nКак мне получить нужные мне библиотеки и добавить их в сборку я не знаю как.</p>\n\n<hr>\n\n<p>[<strong>Что предпринимал?</strong> ]</p>\n\n<p>Попробовал удалить из того файла который компилируется ссылки (<code>usings</code>).</p>\n\n<p>Попробовал удалить файл <code>packages.config</code></p>\n\n<p>Но всё безрезультатно.</p>\n"}