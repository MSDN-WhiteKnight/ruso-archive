{"tags":["c#",".net","windows","сеть","update"],"owner":{"reputation":73,"user_id":207176,"user_type":"registered","profile_image":"https://graph.facebook.com/831584596985867/picture?type=large","display_name":"Oleg  Bezverhii","link":"https://ru.stackoverflow.com/users/207176/oleg-bezverhii"},"is_answered":true,"view_count":135,"answer_count":2,"score":1,"last_activity_date":1573299727,"creation_date":1555154888,"question_id":969166,"link":"https://ru.stackoverflow.com/questions/969166/%d0%a3%d0%b4%d0%b0%d0%bb%d0%b5%d0%bd%d0%bd%d0%b0%d1%8f-%d0%bf%d1%80%d0%be%d0%b2%d0%b5%d1%80%d0%ba%d0%b0-%d1%83%d1%81%d1%82%d0%b0%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%bd%d1%8b%d1%85-%d0%be%d0%b1%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%b8%d0%b9-windows","title":"Удаленная проверка установленных обновлений Windows","body":"<p>Появилась интересная задача на работе. Имеются сервера КИПиА, которые иногда могут сбоить и так далее. После сбоя проводят развертывание образа и часто бывает, что в данном образе не хватает нужных обновлений. Служба безопасности приезжает на проверки и через \"Панель управления->Программы и компоненты->Установленные обновления\" и сверяет со списком.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ET7rp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ET7rp.jpg\" alt=\"введите сюда описание изображения\"></a>\nПоэтому встала задача о написании приложении, которое по локальной сети бы собирала информацию с серверов о установленных обновлений, в случае отсутствия его в списках выдавала, что такого-то обновления нет. </p>\n\n<p>Сервера находятся в своей подсети, доступ в интернет ограничен, Active Directory не настроен, WSUS не стоит.</p>\n\n<p>Поэтому пару вопросов.</p>\n\n<p>1) Может уже есть готовые аналоги, проверяющие всё это дело?</p>\n\n<p>2) Получение списка обновлений через команду</p>\n\n<pre><code>wmic qfe get\n</code></pre>\n\n<p>выдает не все обновления. \nИспользовал WMI запросы (Win32_QuickFixEngineering: <a href=\"https://github.com/OlegBezverhii/UpdatesList/blob/master/ConsoleUpdate/Program.cs\" rel=\"nofollow noreferrer\">пример на гитхабе</a>) - выдает тоже самое, что и wmic.</p>\n\n<p>Получается, что можно получить весь список только через WUAPI или есть ещё какие-то способы?</p>\n"}