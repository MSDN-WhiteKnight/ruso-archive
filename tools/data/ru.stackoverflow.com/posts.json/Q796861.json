{"tags":["c#",".net"],"owner":{"reputation":22896,"user_id":32793,"user_type":"registered","accept_rate":48,"profile_image":"https://i.stack.imgur.com/6Vktl.jpg?s=128&g=1","display_name":"iluxa1810","link":"https://ru.stackoverflow.com/users/32793/iluxa1810"},"is_answered":false,"view_count":106,"answer_count":1,"score":-5,"last_activity_date":1520933493,"creation_date":1520833862,"last_edit_date":1520933493,"question_id":796861,"link":"https://ru.stackoverflow.com/questions/796861/%d0%9e%d1%82%d0%ba%d1%80%d1%8b%d1%82%d1%8b%d0%b9-oledbconnection-%d0%bd%d0%b5-%d0%b4%d0%b0%d0%b5%d1%82-%d0%b7%d0%b0%d0%b2%d0%b5%d1%80%d1%88%d0%b8%d1%82%d1%81%d1%8f-%d0%bf%d1%80%d0%be%d0%b3%d1%80%d0%b0%d0%bc%d0%bc%d1%83","title":"Открытый OleDbConnection не дает завершится программу","body":"<p>Я понимаю, что хорошим стилем является самому вызвать <code>Dispose</code> в нужном месте.</p>\n\n<p>Однако, есть простое консольное приложение, которое работает с <code>OleDbConnection</code>, делая запросы к БД.</p>\n\n<p>Так вот, под конец работы приложения программа зависает, если не вызвать <code>Dispose</code>, хотя... в этом случае должен отработать финализатор.</p>\n\n<p>Неужели у этого класса забаженный финализатор?</p>\n\n<p><strong>UPD</strong></p>\n\n<p>Стека нет, так как программа останавливается в конце блока Main</p>\n\n<p>Я заметил, что такое происходит если запустить 2 раза подряд программу.</p>\n\n<p>Первый раз нормально отрабатывает, запускаю второй раз и зависает.</p>\n\n<p>Минимальный код:</p>\n\n<pre><code>class Converter\n{\n        private static readonly ILog _log = LogManager.GetLogger(typeof(DbConverter));\n        private OleDbConnection _conn;\n        private DbDictionary _dbDict;\n         public Converter(string pathToDb, string pathToDict)\n        {\n            _conn = DbHelper.GetAccessConnection(pathToDb);\n            _dbDict = new DbDictionary(pathToDict);\n            _conn.Open();\n        }\n\n        void DoWork(){\n        //Какие-то последовательные запросы через Dapper\n        }\n\n\n}\n</code></pre>\n\n<p>Класс DbDictionary по сути, тоже самое, что и Converter, т.е класс с <code>OleDbConnection</code> и одним методом <code>FindValue</code>.</p>\n"}