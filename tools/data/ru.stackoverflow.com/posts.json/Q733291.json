{"tags":["c++","c","аудио","mmdevice"],"owner":{"reputation":2330,"user_id":243717,"user_type":"registered","accept_rate":96,"profile_image":"https://www.gravatar.com/avatar/ad5c6f0e980273f94a0e95c0a804866d?s=128&d=identicon&r=PG&f=1","display_name":"Range","link":"https://ru.stackoverflow.com/users/243717/range"},"is_answered":true,"view_count":241,"accepted_answer_id":736536,"answer_count":1,"score":2,"last_activity_date":1509203347,"creation_date":1508449372,"last_edit_date":1509087918,"question_id":733291,"link":"https://ru.stackoverflow.com/questions/733291/%d0%9f%d0%be%d0%bb%d1%83%d1%87%d0%b8%d1%82%d1%8c-%d1%81%d0%b2%d0%be%d0%b9%d1%81%d1%82%d0%b2%d0%b0-%d0%b7%d0%b2%d1%83%d0%ba%d0%be%d0%b2%d0%be%d0%b3%d0%be-%d1%83%d1%81%d1%82%d1%80%d0%be%d0%b9%d1%81%d1%82%d0%b2%d0%b0-%d1%81-%d0%bf%d0%be%d0%bc%d0%be%d1%89%d1%8c%d1%8e-mmdevice-api","title":"Получить свойства звукового устройства с помощью MMDevice API","body":"<p>Требуется получить определённые свойства звукового устройства(выделю на скриншоте). Я дошёл до свойств, получил количество этих свойств, могу к ним обратиться - но что делать далее не знаю. Подскажите, как получить данные свойства(именно, наименование, количество..)\nКод:</p>\n\n<pre><code>    HRESULT hresult; // для ошибок и проверок\n    const CLSID CLSID_MMDeviceEnumerator = __uuidof(MMDeviceEnumerator);\n    const IID IID_IMMDeviceEnumerator = __uuidof(IMMDeviceEnumerator);\n    CoInitialize(NULL); // инициализируем систему COM\n    hresult = CoCreateInstance( // создаем COM - объект, связанный с устройствами аудио вывода\n        CLSID_MMDeviceEnumerator, NULL,\n        CLSCTX_ALL, IID_IMMDeviceEnumerator,\n        (void**)&amp;enumerator);\n\n    IMMDeviceCollection *pCollection = nullptr; // указатель на коллекцию устройств\n    IMMDevice *pEndpoint = NULL; // указатель на конкретное устройство\n\n    hresult = this-&gt;enumerator-&gt;EnumAudioEndpoints( // получаем список устройств в системе(оно одно у меня, добавлять не думаю, но\n        // если буду - делать проверку устройств(ниже) в цикле, там надо получить количество устройств ещё\n        eRender, DEVICE_STATE_ACTIVE,\n        &amp;pCollection);\n\n    hresult = pCollection-&gt;Item(0, &amp;pEndpoint); // получаем единственное устройство в системе\n    IPropertyStore* propertys; // свойства устройства\n    hresult = pEndpoint-&gt;OpenPropertyStore(STGM_READ, &amp;propertys); // получаем свойства устройства для чтения(запись нам не нужна)\n    DWORD count;  propertys-&gt;GetCount(&amp;count);\n    for (DWORD i(0); i &lt; count; i++)\n    {\n        PROPERTYKEY prop;\n        propertys-&gt;GetAt(i, &amp;prop);\n        // конкретные свойства(какие?) лежат в prop, но как \"расшифровать\" - не понимаю\n    }\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/8TzKd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8TzKd.png\" alt=\"введите сюда описание изображения\"></a></p>\n"}