{"owner":{"reputation":22896,"user_id":32793,"user_type":"registered","accept_rate":48,"profile_image":"https://i.stack.imgur.com/6Vktl.jpg?s=128&g=1","display_name":"iluxa1810","link":"https://ru.stackoverflow.com/users/32793/iluxa1810"},"is_accepted":false,"score":9,"last_activity_date":1513250701,"last_edit_date":1513250701,"creation_date":1513249686,"answer_id":758216,"question_id":758190,"body":"<p>Если вы откроете диспетчер задач, то увидите владельца процесса => следуя этому <a href=\"https://stackoverflow.com/questions/777548/how-do-i-determine-the-owner-of-a-process-in-c\">ответу</a></p>\n\n<p>Можно получить владельца процесса через WMI:</p>\n\n<pre><code>public string GetProcessOwner(int processId)\n{\n    string query = \"Select * From Win32_Process Where ProcessID = \" + processId;\n    ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);\n    ManagementObjectCollection processList = searcher.Get();\n\n    foreach (ManagementObject obj in processList)\n    {\n        string[] argList = new string[] { string.Empty, string.Empty };\n        int returnVal = Convert.ToInt32(obj.InvokeMethod(\"GetOwner\", argList));\n        if (returnVal == 0)\n        {\n            // return DOMAIN\\user\n            return argList[1] + \"\\\\\" + argList[0];\n        }\n    }\n\n    return \"NO OWNER\";\n}\n\npublic string GetProcessOwner(string processName)\n{\n    string query = \"Select * from Win32_Process Where Name = \\\"\" + processName + \"\\\"\";\n    ManagementObjectSearcher searcher = new ManagementObjectSearcher(query);\n    ManagementObjectCollection processList = searcher.Get();\n\n    foreach (ManagementObject obj in processList)\n    {\n        string[] argList = new string[] { string.Empty, string.Empty };\n        int returnVal = Convert.ToInt32(obj.InvokeMethod(\"GetOwner\", argList));\n        if (returnVal == 0)\n        {\n            // return DOMAIN\\user\n            string owner = argList[1] + \"\\\\\" + argList[0];\n            return owner;       \n        }\n    }\n\n    return \"NO OWNER\";\n}\n</code></pre>\n\n<p>Это более лучшее решение, чем явно перечислять системные процессы, которые могут добавлять при установке спец. компонентов=> список составить тяжело.</p>\n\n<p>Как меня поправляют в комментариях, есть еще всякие сервисы, где отсутствует учетка, так же есть некотые системные учетки, например MS SQL работает из специфичной учетки, если я не ошибаюсь.</p>\n"}