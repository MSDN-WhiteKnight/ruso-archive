{"owner":{"reputation":16058,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":false,"score":1,"last_activity_date":1558594454,"creation_date":1558594454,"answer_id":984565,"question_id":982726,"body":"<p>Странные у вас учебные задания. Ошибка возникает из-за того, что тип HMODULE, который определен как указатель на структуру <code>struct {int unused;}</code>, несовместим с типом указателя на функцию. Эту ошибку можно убрать приведением типов, но в данном случае это не поможет заставить код работать, так как он выглядит в целом некорректным. Если предположить, что pIED - это указатель на структуру IMAGE_EXPORT_DIRECTORY, определенную в winnt.h (которая описывает раздел экспорта PE-файла), то адрес функции должен вычисляться так:</p>\n\n<pre><code>MessageBoxPointer = (_MessageBoxA)((char*)user32 + Address[i]); \n</code></pre>\n\n<p>Тип HMODULE нужно привести к указателю на один байт, чтобы адресная арифметика работала как ожидается. Переменная user32 содержит базовый адрес DLL, а Address[i] - относительный адрес функции, поэтому мы их складываем. Ordinal не нужен.</p>\n"}