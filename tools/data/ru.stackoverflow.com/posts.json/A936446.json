{"owner":{"reputation":16137,"user_id":240512,"user_type":"registered","profile_image":"https://i.stack.imgur.com/Ew6lG.png?s=128&g=1","display_name":"MSDN.WhiteKnight","link":"https://ru.stackoverflow.com/users/240512/msdn-whiteknight"},"is_accepted":true,"score":1,"last_activity_date":1548395409,"creation_date":1548395409,"answer_id":936446,"question_id":936230,"body":"<p>Можно использовать сообщение WM_COPYDATA:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Text;\nusing System.Linq;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Runtime.InteropServices;\nusing System.Windows.Interop;\n\nnamespace WpfApplication\n{\n    public partial class MainWindow : Window\n    {\n\n        [DllImport(\"user32.dll\")]\n        public static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, IntPtr wParam, ref COPYDATASTRUCT lParam);\n\n        [StructLayout(LayoutKind.Sequential)]\n        public struct COPYDATASTRUCT\n        {\n            public IntPtr dwData;\n            public int cbData;                        \n            public IntPtr lpData;\n        }\n\n        const uint WM_COPYDATA = 0x004A;        \n\n        //обработчик сообщений для окна\n        private IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)\n        {   \n            if (msg == WM_COPYDATA)\n            {\n                COPYDATASTRUCT data = new COPYDATASTRUCT();\n                data = (COPYDATASTRUCT)Marshal.PtrToStructure(lParam, data.GetType());                \n                MessageBox.Show(\"Received command: \"+Marshal.PtrToStringUni(data.lpData));                 \n            }\n\n            return IntPtr.Zero;\n        }\n\n        public MainWindow()\n        {\n            InitializeComponent(); \n\n            Process this_process = Process.GetCurrentProcess();            \n\n            //найти все процессы с таким же именем\n            Process[] other_processes =\n                Process.GetProcessesByName(this_process.ProcessName).Where(pr =&gt; pr.Id != this_process.Id).ToArray();\n\n            foreach (var pr in other_processes)\n            {\n                pr.WaitForInputIdle(1000); //на случай, если процесс еще не загрузился\n\n                //берем первый процесс с окном\n                IntPtr hWnd = pr.MainWindowHandle;\n                if (hWnd == IntPtr.Zero) continue;\n\n                //отправляем команду\n                string command = \"Hello\";\n                var cds = new COPYDATASTRUCT();\n                cds.dwData = (IntPtr)1;\n                cds.cbData = (command.Length + 1) * 2;\n                cds.lpData = Marshal.StringToHGlobalUni(command);\n                SendMessage(hWnd, WM_COPYDATA, IntPtr.Zero, ref cds);\n                Marshal.FreeHGlobal(cds.lpData);\n\n                //завершаем работу\n                Environment.Exit(0);\n            }\n\n            //если ничего не найдено, продолжаем работу             \n        }\n\n\n        private void Window_Loaded(object sender, RoutedEventArgs e)\n        {           \n            WindowInteropHelper h = new WindowInteropHelper(this);\n            HwndSource source = HwndSource.FromHwnd(h.Handle);\n            source.AddHook(new HwndSourceHook(WndProc));//регистрируем обработчик сообщений            \n        }\n    }\n}\n</code></pre>\n"}