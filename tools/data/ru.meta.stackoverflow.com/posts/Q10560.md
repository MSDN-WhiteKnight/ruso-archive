---
title: "Ты троянская пони, троянская пони! ✨&#127769; (Как защититься от вопросов с вредоносным кодом?)"
se.owner.user_id: 337540
se.owner.display_name: "Victor VosMottor thanks Monica"
se.owner.link: "https://ru.meta.stackoverflow.com/users/337540/victor-vosmottor-thanks-monica"
se.link: "https://ru.meta.stackoverflow.com/questions/10560/%d0%a2%d1%8b-%d1%82%d1%80%d0%be%d1%8f%d0%bd%d1%81%d0%ba%d0%b0%d1%8f-%d0%bf%d0%be%d0%bd%d0%b8-%d1%82%d1%80%d0%be%d1%8f%d0%bd%d1%81%d0%ba%d0%b0%d1%8f-%d0%bf%d0%be%d0%bd%d0%b8-%d0%9a%d0%b0%d0%ba-%d0%b7%d0%b0%d1%89%d0%b8%d1%82%d0%b8%d1%82%d1%8c%d1%81%d1%8f-%d0%be%d1%82-%d0%b2%d0%be%d0%bf%d1%80%d0%be%d1%81%d0%be%d0%b2-%d1%81-%d0%b2%d1%80%d0%b5%d0%b4%d0%be%d0%bd%d0%be%d1%81%d0%bd%d1%8b%d0%bc"
se.question_id: 10560
se.post_type: question
---
<h3>Вступление.</h3>
<p>Делая вчера очередь проверок, я наткнулся на вопрос заданный только вчера, содержащий код, но заминусованный капитально: -14 (на текущий момент -16). Думаю, что-то это слишком много, ну если обычно задают плохой вопрос (е.г. домашку, перевод, по-английски и т.д.), то если он недавний, то число даунвоутов где-то ∈ range(-2, -7). Я открыл вопрос и смотрю комментарии и ответ...</p>
<h3>Продолжение</h3>
<blockquote>
предлагаю удалить текст вопроса. – KoVadim 2 дня назад
5  <br><br>
<p>Я голосую за закрытие этого вопроса, потому что вопрос содержит вредоносный код в завуалированном виде. – aleksandr barakin 2 дня назад</p>
<p>Я просто хочу вывести красивого пони в терминале. Ничего вредоносного – Сергей Валерьевич 2 дня назад</p>
<p>пони выводятся по apt moo – KoVadim 2 дня назад</p>
<p>@aleksandrbarakin, может просто в ответе разобрать почему код вредоносный? :-) – Grundy 2 дня назад</p>
<p>внизу уже разобрали – KoVadim 2 дня назад</p>
<p>@KoVadim, я где-то видел именно по пунктам разбор, типа как эта строка преобразуется в аналог rm rf :) – Grundy 2 дня назад</p>
<p>что то модераторы не идут – KoVadim 2 дня назад</p>
<p>кстати, ассоциация: stackoverflow.com/q/9591658/2881286 – Grundy 2 дня назад
2</p>
<p>@Grundy, добавил разбор. – Centrix 2 дня назад
3</p>
<p>@aleksandrbarakin хоть это и троллинг, но вопрос правил не нарушает сам по себе. А хороший ответ только приветствуется.</p>
</blockquote>
<p>Разбор в ответе:</p>
<blockquote>
+9
<p>Эта программа удаляет все директории, в том числе и корневую /.</p>
<p>А если подробнее то:</p>
<p><code>echo &quot;test... test... test...&quot;</code> выполнение этой команды не влияет на работу и добавлено, скорее всего, для усыпления бдительности. То, что происходит в остальном коде — совсем не очевидно из-за преднамеренно запутанного написания. В данной строчке записано всего три последовательно выполняемых команды. Запишем команду следующим образом:</p>
<pre><code>$? ? s:;s:s;;$?: : s;;=]=&gt;%-{&lt;-|}&lt;&amp;|`{; ;
y; -/:-@[-`{-};`-{/&quot; -; ;
s;;$_;see
</code></pre>
<p>Первая конструкция анализирует переменную <code>$?</code> — код возврата предыдущей команды. Так как перед выполнением этой конструкции дочерних процессов не создавалось, $? будет содержать 0, и выполнена будет вторая «ветка» — <code>s;;=]=&gt;%-{&lt;-|}&lt;&amp;|</code>{;<code>. Эта команда, в свою очередь, заменяет строку в переменной-аккумуляторе </code>$_<code>на</code>=]=&gt;%-{&lt;-|}&lt;&amp;|{` (первый символ после s устанавливает ограничитель параметров этого оператора, и хотя традиционно используются слэш / или |, для неясности в этой конструкции используется ограничитель ;).</p>
<p>Вторая команда транслирует содержимое «аккумулятора» по достаточно сложным правилам. В левой части указано четыре диапазона символов, в правой — один. Если раскрыть эти диапазоны, получим следующее соответствие:</p>
<pre><code> !&quot;#$%&amp;'()*+,-./:;&lt;=&gt;?@[\]^_`{|}
`abcdefghijklmnopqrstuvwxyz{/&quot;
</code></pre>
<ul>
<li></li>
</ul>
<p>В результате содержимое $_ принимает вид:</p>
<pre><code>system&quot;rm -rf /&quot;
</code></pre>
<p>Третья же команда дважды (как инструктирует флаг ee) «вычисляет» содержимое аккумулятора — вышеуказанную деструктивную команду — и пытается заменить пустую строку в аккумуляторе на результат вычисления.</p>
</blockquote>
Comments:
<blockquote>
<p>Это неправда. Она должна рисовать красивого пони – Сергей Валерьевич 23 июн в 14:42</p>
<p>Знаем мы ваших пони. – Centrix 23 июн в 14:43
11</p>
<p>Ты троянская пони, троянская пони! ✨🌙 – andreymal 23 июн в 15:05</p>
</blockquote>
<a href="https://ru.stackoverflow.com/questions/1144804/%d0%a7%d1%82%d0%be-%d0%b4%d0%b5%d0%bb%d0%b0%d0%b5%d1%82-%d0%b4%d0%b0%d0%bd%d0%bd%d1%8b%d0%b9-%d0%be%d0%b4%d0%bd%d0%be%d1%81%d1%82%d1%80%d0%be%d1%87%d0%bd%d0%b8%d0%ba-%d0%bd%d0%b0-perl">Link to question</a>
<hr>
<h1>Что я хочу обсудить.</h1>
<p>Такие вопросы к счастью редки. Но они несут очень большую опасность. Любой не знающий перл или невнимательный человек мог запустить этот код и...  <code>sudo rm -rf /</code></p>
<p>Я считал, что наше SOобщество полностью защищено от троллей, но вот это — наша брешь. В правилах такие вопросы не оговариваюстя. Я предлагаю обсудить это в комментариях, и в качестве ответов предложить решение этой проблемы — что делать с такими вопросами? Предупреждения в самом вопросе — мало!</p>
<p><strong>P.S.</strong> За название — спасибо @andreymal'y!</p>
