{"owner":{"reputation":39,"user_id":343242,"user_type":"registered","profile_image":"https://www.gravatar.com/avatar/c7b256e6e7b582046fea3473bdb888ae?s=128&d=identicon&r=PG&f=1","display_name":"ZheniaFromeverywhere","link":"https://ru.meta.stackoverflow.com/users/343242/zheniafromeverywhere"},"score":0,"last_activity_date":1579555247,"creation_date":1579555247,"post_type":"question","post_id":10039,"link":"https://ru.meta.stackoverflow.com/q/10039","body":"<p>Пытаюсь сохранить в форме установленные значения и не знаю что делать дальше.Как их сохранить,\nчтобі форма прошла валидацию.</p>\n\n<p>В функции message() я передаю в форму два аргумента user - это отправитель, а current_user - получатель.\nОба этих поля ForeignKey.</p>\n\n<p>В forms.py я пытаюсь установить значения по умалчанию в форме перед обработкой. И я не знаю как их сохранить,\nпотому что в форме появляются мои заданные параметры, но когда я заполняю поле сообщения и срабатывает \nфункция обработки to_sent_message вылазит ошибка, что не хватает аргумента current_user. А я не знаю как\nпередать етот аргумент, который я получаю по id в message().</p>\n\n<p>views.py</p>\n\n<pre><code>def message (request, id):\n    \"\"\"функция ведет на другие профиля, которым  авторизированный юзер может отправлять сообщения\"\"\"\n    user = request.user\n\n    current_user = User.objects.get(id=id)\n    user_prof = current_user.profile\n\n    template = 'simpleblog/another_profile.html'\n\n    message_form = MessageForm(user,current_user)\n\n    return render(request, template, { 'message_form': message_form })\n</code></pre>\n\n<p>forms.py</p>\n\n<pre><code>class MessageForm(ModelForm):\n\n    class Meta:\n        model = Message\n        fields = ('message','sender','reciver')\n\n\n    def __init__(self, user,current_user,*args, **kwargs):\n\n        super(MessageForm, self).__init__(*args, **kwargs)\n        self.initial['sender'] = user\n        self.initial['reciver'] = current_user\n</code></pre>\n\n<p>views.py</p>\n\n<pre><code>def to_sent_message(request):\n    \"\"\" функция ведет на обработку формы сообщения\"\"\"\n    user = request.user\n\n    message_form = MessageForm(user,)\n\n    if message_form.is_valid():\n\n        message_form.save()\n        return redirect('just_index_page')\n    else:\n        print('Something went wrong!')\n        return redirect('just_index_page')\n</code></pre>\n"}