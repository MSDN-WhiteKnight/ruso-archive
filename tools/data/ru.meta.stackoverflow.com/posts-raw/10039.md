---
title: "Post 10039"
se.owner.user_id: 343242
se.owner.display_name: "ZheniaFromeverywhere"
se.owner.link: "https://ru.meta.stackoverflow.com/users/343242/zheniafromeverywhere"
se.link: "https://ru.meta.stackoverflow.com/q/10039"
se.post_id: 10039
se.post_type: question
se.score: 0
---
<p>Пытаюсь сохранить в форме установленные значения и не знаю что делать дальше.Как их сохранить,
чтобі форма прошла валидацию.</p>

<p>В функции message() я передаю в форму два аргумента user - это отправитель, а current_user - получатель.
Оба этих поля ForeignKey.</p>

<p>В forms.py я пытаюсь установить значения по умалчанию в форме перед обработкой. И я не знаю как их сохранить,
потому что в форме появляются мои заданные параметры, но когда я заполняю поле сообщения и срабатывает 
функция обработки to_sent_message вылазит ошибка, что не хватает аргумента current_user. А я не знаю как
передать етот аргумент, который я получаю по id в message().</p>

<p>views.py</p>

<pre><code>def message (request, id):
    """функция ведет на другие профиля, которым  авторизированный юзер может отправлять сообщения"""
    user = request.user

    current_user = User.objects.get(id=id)
    user_prof = current_user.profile

    template = 'simpleblog/another_profile.html'

    message_form = MessageForm(user,current_user)

    return render(request, template, { 'message_form': message_form })
</code></pre>

<p>forms.py</p>

<pre><code>class MessageForm(ModelForm):

    class Meta:
        model = Message
        fields = ('message','sender','reciver')


    def __init__(self, user,current_user,*args, **kwargs):

        super(MessageForm, self).__init__(*args, **kwargs)
        self.initial['sender'] = user
        self.initial['reciver'] = current_user
</code></pre>

<p>views.py</p>

<pre><code>def to_sent_message(request):
    """ функция ведет на обработку формы сообщения"""
    user = request.user

    message_form = MessageForm(user,)

    if message_form.is_valid():

        message_form.save()
        return redirect('just_index_page')
    else:
        print('Something went wrong!')
        return redirect('just_index_page')
</code></pre>
