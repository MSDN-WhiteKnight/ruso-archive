---
title: "Post 11917"
se.owner.user_id: 467193
se.owner.display_name: "bot"
se.owner.link: "https://ru.meta.stackoverflow.com/users/467193/bot"
se.link: "https://ru.meta.stackoverflow.com/q/11917"
se.post_id: 11917
se.post_type: question
---
<p>—è —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é —á–∞—Ç –Ω–∞ —Å–æ–∫–µ—Ç–∞—Ö, —É –º–µ–Ω—è –≤—Å—ë –∏–¥—ë—Ç –æ—Ç–ª–∏—á–Ω–æ, –Ω–æ —É –º–µ–Ω—è –ø–æ—è–≤–∏–ª–∞—Å—å –ø—Ä–æ–±–ª–µ–º–∞: –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, —Ç–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–æ–≤–æ–º –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫—Ä–µ–ø–ª—ë–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è —Ç–æ –µ—Å—Ç—å, –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è, –ø–æ—á–µ–º—É —Ç–∞–∫? (NODE.js) –í–æ—Ç –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:</p>
<pre><code>
const express = require('express');
const app = express();
const http = require('http');
const server = http.createServer(app);
const { Server } = require(&quot;socket.io&quot;);
const io = new Server(server);
let numb = 1;
app.get('/', (req, res) =&gt; {
  res.sendFile(__dirname + '/index.html');
});
io.on('connection', (socket) =&gt; {
  alert('a user connected');
    socket.broadcast.emit('hello', &quot;BOT: —É –Ω–∞—Å –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å&quot;);
  socket.on('disconnect', () =&gt; {
        console.log('disconnected user');
    socket.broadcast.emit('goodbye', &quot;BOT: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—à–µ–ª –∏–∑ —á–∞—Ç–∞&quot;);
    });
  socket.on('typing', us =&gt; {
        socket.broadcast.emit('typing', `‚úç${us} –ø–∏—à–µ—Ç...`);
        console.log(&quot;type&quot;);
    });
//–ó–¥–µ—Å—å —Å–æ–±—ã—Ç–∏–µ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è
  socket.on('pin', function (data) {
        io.emit('pin', {
            id: data.id,
            text: data.text
        });
        console.log(`message ${data.id} was pinned with text: &quot;${data.text}&quot;`);
    });
    socket.on('chat message', function (msg) {
    console.log(msg.name + &quot;: &quot; + msg.message);
        io.emit('chat message', {
            message: msg.message,
            name: msg.name,
            ID: msg.ID
        });
  });
});
server.listen(1000, () =&gt; {
  console.log(' &gt;_     ¬∑‚Äî‚Äî‚Äî‚Äîlistening on *:1000‚Äî‚Äî‚Äî‚Äî¬∑');
});
</code></pre>
<p>–ö–æ–¥ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (javascript):
HTML:</p>
<pre><code>&lt;div id=&quot;msgs&quot;&gt;
    &lt;div id=&quot;pinned_msgs&quot;&gt;&lt;!--–∑–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Å–µ –∑–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è--&gt;&lt;/div&gt;
      &lt;ul id=&quot;messages&quot;&gt;
            
            &lt;/ul&gt;
        &lt;/div&gt;
    &lt;form id=&quot;form&quot; action=&quot;&quot;&gt;
            &lt;input type=&quot;text&quot; id=&quot;user&quot; autocomplete=off placeholder=&quot;name...&quot;&gt;&lt;br&gt;
      &lt;input id=&quot;input&quot; autocomplete=&quot;off&quot; placeholder=&quot;message...&quot;/&gt;&lt;button&gt;Send&lt;/button&gt;
            &lt;input type=&quot;submit&quot;&gt;
    &lt;/form&gt;
</code></pre>
<p>JS:</p>
<pre><code>//–ö–æ–≥–¥–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
    socket.on('chat message', function(msg) {
        let tim = new Date();
        let year = tim.getFullYear();
        let day = tim.getDate();
    let month = tim.getMonth();
    let hour = tim.getHours();
        let minute = tim.getMinutes();
    let time = `${day}/${month}/${year} (${hour}:${minute})`;
    var item = document.createElement('li');
        item.id = msg.ID;
        item.style.width = &quot;fit-content&quot;;
    item.innerHTML = &quot;&lt;b&gt;&lt;i&gt;&quot; + msg.name + &quot;&lt;/i&gt;&lt;/b&gt;: &quot; + &quot;&lt;message&gt;&quot; + msg.message + &quot;&lt;/message&gt;&lt;br&gt; &lt;time id='d'&gt;&quot; + time + &quot;&lt;/time&gt;&quot;;
    messages.appendChild(item);
    //window.scrollTo(10, document.body.scrollHeight);

let h = $(&quot;#msgs&quot;).get(0).scrollHeight;
$(&quot;#msgs&quot;).animate({
    scrollTop: h
}, 500);
//–ö–æ–≥–¥–∞ –º—ã —Ñ–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–µ —Ö–æ—Ç–∏–º –∑–∞–∫—Ä–µ–ø–∏—Ç—å
document.querySelector(&quot;#messages&quot;).onclick = (f) =&gt; {
      let Id = &quot;&quot;;
            let tag = f.target;
            if (tag.tagName != &quot;LI&quot;) {
                Id = tag.parentNode.id;
            } else {
                Id = tag.id;
            }
            let parentControl = document.querySelector(`#${Id}`);
//–°–æ–∑–¥–∞—ë–º –º–µ–Ω—é
parentControl.addEventListener('click',function(ev){
    ev.preventDefault();
    new contextualMenu({
      docked:false,
      items:[
        {
                    title:'–£–¥–∞–ª–∏—Ç—å',
                    tip: '',
                    icon:'https://Contextmenu-3.volodya-bot-developer.repl.co/delete.svg',
                    children: [
                        {
                            title: '–£ —Å–µ–±—è',
                            tip:'',
                            icon: 'https://Contextmenu-3.volodya-bot-developer.repl.co/delete.svg',
                            onclick: function(){
                        
                            }
                        },
                        {
                            title: '–£ –≤—Å–µ—Ö',
                            tip:'',
                            icon: 'https://Contextmenu-3.volodya-bot-developer.repl.co/delete.svg',
                            onclick: function(){
                        
                            }
                        }
                    ]
                },
                /*{
                    seperator: true
                },*/
                {
                    title:'–ü—Ä–æ—Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å',
                    tip:'', 
                    icon:'https://Contextmenu-3.volodya-bot-developer.repl.co/add_sm.svg', 
                    children: [
            {
                            title:'üòÇ',
                            tip:'—Å–º–µ—à–Ω–æ',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },
            {
                            title:'üöÄ',
                            tip:'–∫—Ä—É—Ç–æ',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },
            {
                            title:'‚ùå',
                            tip:'–Ω–µ—Ç',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },
                        {
                            title:'üëå',
                            tip:'—Ç–æ—á–Ω–æ',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },
                        {
                            title: 'üî•',
                            tip:'–≤–∞—É',
                            icon:'',
                            onclick: function(){}
                                    }
 ,                      {
                            title: 'üí™',
                            tip:'–Ω–µ–ø–ª–æ—Ö–æ',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },                      {title: 'üò≠',
                         tip:'–ø–µ—á–∞–ª—å–∫–∞',
                         icon:'',
                         onclick: function(){
                             
                         }
                        },                      {
                            title: 'ü•∞',
                            tip: '–ª—é–±–ª—é',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },                      {
                            title: 'ü•≥',
                            tip: '—Å –¥–Ω—ë–º —Ä–æ–∂–¥–µ–Ω–∏—è',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },
                        {
                            title: 'ü§©',
                            tip: '–æ–≥–æ',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },
                        {
                            title: 'üòê',
                            tip: '—É—É–ø—Å',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },
                        {
                            title: 'ü§î',
                            tip: '–Ω–∞–¥–æ –ø–æ–¥—É–º–∞—Ç—å',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },
                        {
                            title: 'üò±',
                            tip: '—É–∂–∞—Å',
                            icon:'',
                            onclick: function(){
                                
                            }
                        },
                         {
                             title: 'ü§¨',
                             tip: '—á—Ç–æ–± —Ç–µ–±—è',
                             icon:'',
                             onclick: function(){
                                
                            }
                         }
                    ]},
          {
                        title:'–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å',
                        tip:'Ctrl+C',
                        icon:'https://Contextmenu-3.volodya-bot-developer.repl.co/copy.svg',
                        onclick: function(){}
                    },
          /*{
                        seperator:true
                    },*/
          {
                        title:'–ó–∞–∫—Ä–µ–ø–∏—Ç—å',
                        tip:'',
                        icon:'https://Contextmenu-3.volodya-bot-developer.repl.co/pin.svg',
                        onclick: function(){
                            let Text = prompt(&quot;–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç-–∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è&quot;, &quot;—Ç–µ–∫—Å—Ç&quot;);
                            if (Text == null) {
                                return;
                            } else {
              socket.emit('pin', {
                                id: Id,
                                text: Text
                            });
                                Id = null;
                                Text = null;
                            socket.on('pin', function (data) {
                  let pin_msg = document.createElement(&quot;a&quot;);
                                pin_msg.href = `#${data.id}`;
                                pin_msg.innerHTML = data.text + &quot;&lt;remove&gt;‚ùå&lt;/remove&gt;&lt;br&gt;&quot;;
                                
                                document.querySelector(&quot;#pinned_msgs&quot;).appendChild(pin_msg);
                                pin_msg = null;
                                let h = $(&quot;#pinned_msgs&quot;).get(0).scrollHeight;
$(&quot;#pinned_msgs&quot;).animate({
    scrollTop: h
}, 500);
                                document.querySelector(&quot;remove&quot;).onclick = (rt) =&gt; {
                                    let mef = rt.target;
                                    let pn = mef.parentNode;
                    //alert(pn);
                                    document.querySelector(&quot;#pinned_msgs&quot;).removeChild(pn);
                                }
                  });
                            }
                        }
                    },
          {
                        title:'–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å',
                        tip:'',
                        icon:'https://Contextmenu-3.volodya-bot-developer.repl.co/cha.svg',
                        children: [
                        {
                            title: '–£ —Å–µ–±—è',
                            tip:'',
                            icon: 'https://Contextmenu-3.volodya-bot-developer.repl.co/cha.svg',
                            onclick: function(){
                            
                }
                        },
                        {
                            title: '–£ –≤—Å–µ—Ö',
                            tip: '',
                            icon: 'https://Contextmenu-3.volodya-bot-developer.repl.co/cha.svg',
                            onclick: function(){
                            
                        }
                        }
                        ]
                    },
                    {
                        title: '–ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å',
                        tip:'',
                        icon: 'https://Contextmenu-3.volodya-bot-developer.repl.co/com.svg',
                        onclick: function(){
                            
                        }
                    }
        ]
            });
        });
        }
});
</code></pre>
<p>–°—Å—ã–ª–∫–∞: <a href="https://Chat-on-socketio.volodya-bot-developer.repl.co" rel="nofollow noreferrer">chat example</a></p>
<p>–í–Ω–∏–º–∞–Ω–∏–µ: —á—Ç–æ–±—ã –≤—ã–∑–≤–∞—Ç—å –º–µ–Ω—é, –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ 1 —Ä–∞–∑ –Ω–∞–∂–∞—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –∞ –ø–æ—Ç–æ–º –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –µ—â—ë —Ä–∞–∑ –Ω–∞ —ç—Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</p>
